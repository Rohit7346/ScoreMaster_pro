<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScoreMaster Pro | Multi-Sport Tournament Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@700;800;900&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-dark: #0a0e17;
            --secondary-dark: #141a2a;
            --card-dark: #1a2238;
            --accent-green: #00ff8b;
            --accent-green-dark: #00cc6f;
            --text-primary: #ffffff;
            --text-secondary: #b0b7cb;
            --text-muted: #6c748a;
            --border-color: #2a3655;
            --success: #00c853;
            --warning: #ff9800;
            --danger: #f44336;
            --shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            --border-radius: 8px;
            --mobile-breakpoint: 768px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--primary-dark);
            color: var(--text-primary);
            line-height: 1.5;
            overflow-x: hidden;
            font-size: 14px;
            height: 100vh;
            overflow: hidden;
        }
        
        h1, h2, h3, h4 {
            font-family: 'Poppins', sans-serif;
            font-weight: 800;
        }
        
        /* Enhanced Splash Screen */
        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary-dark) 0%, #0d1324 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            animation: fadeOut 0.8s ease 2.5s forwards;
        }
        
        .splash-logo {
            font-family: 'Poppins', sans-serif;
            font-weight: 900;
            font-size: 3rem;
            color: var(--accent-green);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            opacity: 0;
            transform: scale(0.9);
            animation: logoReveal 1s ease 0.3s forwards;
        }
        
        .splash-logo i {
            font-size: 4rem;
            animation: trophyFloat 2s ease-in-out infinite;
            color: gold;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }
        
        .splash-tagline {
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 1rem;
            color: var(--text-secondary);
            margin-top: 15px;
            opacity: 0;
            animation: fadeInUp 0.8s ease 1s forwards;
            letter-spacing: 0.5px;
        }
        
        .splash-loader {
            width: 100px;
            height: 3px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin-top: 30px;
            overflow: hidden;
            opacity: 0;
            animation: fadeIn 0.5s ease 1.5s forwards;
        }
        
        .splash-loader-bar {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, var(--accent-green) 0%, #00ccff 100%);
            border-radius: 10px;
            animation: loadingBar 2s ease-in-out 1.5s forwards;
        }
        
        @keyframes logoReveal {
            0% { opacity: 0; transform: scale(0.9) translateY(20px); }
            70% { transform: scale(1.05); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }
        
        @keyframes trophyFloat {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-10px) rotate(5deg); }
            50% { transform: translateY(-5px) rotate(0deg); }
            75% { transform: translateY(-10px) rotate(-5deg); }
        }
        
        @keyframes fadeInUp {
            0% { opacity: 0; transform: translateY(10px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }
        
        @keyframes loadingBar {
            0% { width: 0%; }
            100% { width: 100%; }
        }
        
        @keyframes fadeOut {
            0% { opacity: 1; }
            100% { opacity: 0; visibility: hidden; }
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        /* Header Styles */
        header {
            background-color: var(--secondary-dark);
            border-bottom: 2px solid var(--accent-green);
            padding: 12px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow);
        }
        
        .logo {
            display: flex;
            align-items: center;
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--accent-green);
            font-family: 'Poppins', sans-serif;
        }
        
        .logo i {
            margin-right: 10px;
            font-size: 1.8rem;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-green), #00ccff);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1rem;
        }
        
        /* Main Content Area */
        main {
            padding: 15px 0;
            height: calc(100vh - 180px);
            overflow-y: auto;
            opacity: 0;
            animation: fadeInApp 0.5s ease 3s forwards;
        }
        
        @keyframes fadeInApp {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }
        
        /* Hide scrollbar for main */
        main::-webkit-scrollbar {
            width: 0;
            background: transparent;
        }
        
        .dashboard-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .dashboard-section.active {
            display: block;
        }
        
        /* Navigation - Responsive */
        .main-nav {
            display: flex;
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            margin-bottom: 15px;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }
        
        @media (max-width: 768px) {
            .main-nav {
                flex-wrap: wrap;
            }
            
            .nav-item {
                flex: 1 0 50%;
                min-width: 140px;
                padding: 12px 5px;
                font-size: 0.95rem;
            }
        }
        
        .nav-item {
            flex: 1;
            text-align: center;
            padding: 15px 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
        }
        
        .nav-item:hover {
            background-color: rgba(0, 255, 139, 0.1);
        }
        
        .nav-item.active {
            background-color: rgba(0, 255, 139, 0.15);
            border-bottom: 3px solid var(--accent-green);
            color: var(--accent-green);
        }
        
        /* HORIZONTAL STEP PROGRESS */
        .step-progress {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            position: relative;
        }
        
        .step-progress::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 3px;
            background-color: var(--border-color);
            transform: translateY(-50%);
            z-index: 1;
        }
        
        .step-progress-line {
            position: absolute;
            top: 50%;
            left: 0;
            height: 3px;
            background-color: var(--accent-green);
            transform: translateY(-50%);
            z-index: 2;
            transition: width 0.5s ease;
        }
        
        .step-indicator {
            width: 45px;
            height: 45px;
            background-color: var(--secondary-dark);
            border: 3px solid var(--border-color);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.2rem;
            color: var(--text-secondary);
            position: relative;
            z-index: 3;
            transition: var(--transition);
            cursor: pointer;
            overflow: hidden;
        }
        
        .step-indicator.active {
            background-color: var(--accent-green);
            border-color: var(--accent-green);
            color: var(--primary-dark);
            transform: scale(1.1);
            box-shadow: 0 0 0 5px rgba(0, 255, 139, 0.2);
        }
        
        .step-indicator.completed {
            background-color: var(--accent-green);
            border-color: var(--accent-green);
            color: var(--primary-dark);
        }
        
        .step-label {
            position: absolute;
            top: 55px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
            color: var(--text-secondary);
            transition: var(--transition);
            width: 120px;
            text-align: center;
        }
        
        .step-indicator.active .step-label {
            color: var(--accent-green);
            font-weight: 700;
        }
        
        .step-indicator.completed .step-label {
            color: var(--accent-green);
        }
        
        @media (max-width: 768px) {
            .step-progress {
                margin-bottom: 20px;
            }
            
            .step-indicator {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }
            
            .step-label {
                font-size: 0.7rem;
                width: 90px;
                top: 50px;
            }
        }
        
        /* Sport Selection Dashboard */
        .sport-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        @media (max-width: 768px) {
            .sport-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 12px;
            }
        }
        
        .sport-card {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid var(--border-color);
        }
        
        .sport-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
            border-color: var(--accent-green);
        }
        
        .sport-card.selected {
            border-color: var(--accent-green);
            background-color: rgba(0, 255, 139, 0.05);
        }
        
        .sport-icon {
            font-size: 2.5rem;
            margin-bottom: 12px;
            color: var(--accent-green);
        }
        
        .sport-name {
            font-size: 1.3rem;
            margin-bottom: 0;
            font-family: 'Poppins', sans-serif;
        }
        
        /* Tournament Setup Section */
        .setup-container {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 25px;
            border: 1px solid var(--border-color);
        }
        
        @media (max-width: 768px) {
            .setup-container {
                padding: 15px;
            }
        }
        
        .setup-step {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .setup-step.active {
            display: block;
        }
        
        .step-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }
        
        @media (max-width: 768px) {
            .step-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
        }
        
        .step-number {
            width: 35px;
            height: 35px;
            background-color: var(--accent-green);
            color: var(--primary-dark);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.1rem;
            margin-right: 12px;
            font-family: 'Poppins', sans-serif;
        }
        
        .step-title {
            font-size: 1.3rem;
            font-family: 'Poppins', sans-serif;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 0.95rem;
        }
        
        .form-control {
            width: 100%;
            padding: 10px 12px;
            background-color: var(--secondary-dark);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 0.95rem;
            transition: var(--transition);
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--accent-green);
            box-shadow: 0 0 0 2px rgba(0, 255, 139, 0.2);
        }
        
        .form-control-sm {
            max-width: 130px;
        }
        
        @media (max-width: 768px) {
            .form-control-sm {
                max-width: 100%;
            }
        }
        
        /* Sport-specific controls */
        .sport-specific-controls {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background-color: rgba(0, 255, 139, 0.05);
            border-radius: var(--border-radius);
            border: 1px solid var(--accent-green);
        }
        
        .sport-specific-controls.active {
            display: block;
        }
        
        /* Custom sport controls */
        .custom-sport-controls {
            background-color: rgba(156, 39, 176, 0.05);
            border-color: #9c27b0;
        }
        
        .custom-rules-container {
            margin-top: 15px;
            padding: 15px;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: var(--border-radius);
        }
        
        .rule-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px dashed var(--border-color);
        }
        
        .rule-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .add-rule-btn {
            background-color: #9c27b0;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 10px;
        }
        
        .add-rule-btn:hover {
            background-color: #7b1fa2;
        }
        
        /* Football specific */
        .football-controls .control-btn {
            background-color: rgba(33, 150, 243, 0.1);
        }
        
        .match-duration-input {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .match-duration-input input {
            width: 80px;
        }
        
        .half-input {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        /* Cricket specific */
        .cricket-controls .control-btn {
            background-color: rgba(0, 200, 83, 0.1);
        }
        
        .btn {
            padding: 8px 16px;
            background-color: var(--accent-green);
            color: var(--primary-dark);
            border: none;
            border-radius: 6px;
            font-weight: 700;
            font-size: 0.85rem;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            font-family: 'Poppins', sans-serif;
        }
        
        .btn:hover {
            background-color: var(--accent-green-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 139, 0.3);
        }
        
        .btn-outline {
            background-color: transparent;
            border: 1.5px solid var(--accent-green);
            color: var(--accent-green);
        }
        
        .btn-outline:hover {
            background-color: rgba(0, 255, 139, 0.1);
        }
        
        .btn-small {
            padding: 5px 10px;
            font-size: 0.75rem;
        }
        
        /* Navigation buttons */
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px solid var(--border-color);
        }
        
        @media (max-width: 768px) {
            .navigation-buttons {
                flex-direction: column;
                gap: 8px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
        }
        
        /* Teams Setup */
        .teams-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }
        
        @media (max-width: 768px) {
            .teams-container {
                grid-template-columns: 1fr;
                gap: 12px;
            }
        }
        
        .team-card {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 18px;
            border: 1px solid var(--border-color);
            transition: var(--transition);
        }
        
        .team-card:hover {
            border-color: var(--accent-green);
        }
        
        .team-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .team-name-input {
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 1.2rem;
            font-weight: 700;
            width: 100%;
            padding: 4px;
            font-family: 'Poppins', sans-serif;
        }
        
        .team-name-input:focus {
            outline: none;
            border-bottom: 2px solid var(--accent-green);
        }
        
        .player-list {
            list-style: none;
        }
        
        .player-item {
            padding: 6px 0;
            border-bottom: 1px dashed var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .player-item:last-child {
            border-bottom: none;
        }
        
        .player-name-input {
            background: transparent;
            border: none;
            color: var(--text-primary);
            width: 70%;
            padding: 4px;
            font-size: 0.95rem;
        }
        
        .player-name-input:focus {
            outline: none;
            border-bottom: 1px solid var(--accent-green);
        }
        
        /* Match Setup */
        .match-setup-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-top: 15px;
        }
        
        @media (max-width: 992px) {
            .match-setup-container {
                grid-template-columns: 1fr;
                gap: 15px;
            }
        }
        
        .match-options {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 25px;
            border: 1px solid var(--border-color);
        }
        
        @media (max-width: 768px) {
            .match-options {
                padding: 15px;
            }
        }
        
        .teams-selection {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 15px;
        }
        
        .team-select {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .team-select:hover {
            background-color: rgba(0, 255, 139, 0.05);
        }
        
        .team-select.selected {
            border: 2px solid var(--accent-green);
            background-color: rgba(0, 255, 139, 0.1);
        }
        
        .team-select-icon {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background-color: var(--card-dark);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.1rem;
            color: var(--accent-green);
            font-family: 'Poppins', sans-serif;
        }
        
        /* =========================================== */
        /* CRICKET LIVE SCORING - REDESIGNED */
        /* =========================================== */
        
        /* Main Live Scoring Container */
        .live-scoring-container {
            max-width: 100%;
            margin: 0 auto;
            padding: 0 5px;
        }
        
        /* Tournament Header */
        .tournament-header-compact {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 12px 20px;
            margin-bottom: 15px;
            border: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .tournament-title {
            font-size: 0.95rem;
            color: var(--accent-green);
            font-weight: 700;
            font-family: 'Poppins', sans-serif;
        }
        
        .live-badge {
            background-color: #f44336;
            color: white;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 5px;
            font-family: 'Poppins', sans-serif;
        }
        
        .live-pulse {
            width: 8px;
            height: 8px;
            background-color: white;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        /* Scoreboard Section - Horizontal Layout */
        .scoreboard-section {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid var(--border-color);
        }
        
        .scoreboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .scoreboard-title {
            font-size: 1.1rem;
            color: var(--text-primary);
            font-weight: 700;
            font-family: 'Poppins', sans-serif;
        }
        
        .match-format {
            font-size: 0.8rem;
            color: var(--text-secondary);
            background-color: var(--secondary-dark);
            padding: 4px 10px;
            border-radius: 15px;
        }
        
        /* Teams Score Display - Side by Side */
        .teams-score-horizontal {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 480px) {
            .teams-score-horizontal {
                gap: 15px;
            }
        }
        
        .team-score-card {
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: center;
            border: 1px solid var(--border-color);
            transition: var(--transition);
        }
        
        .team-score-card.batting {
            border-color: var(--accent-green);
            background-color: rgba(0, 255, 139, 0.05);
        }
        
        .team-name-large {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 10px;
            font-family: 'Poppins', sans-serif;
        }
        
        .team-score-large {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--text-primary);
            line-height: 1;
            margin-bottom: 5px;
            font-family: 'Poppins', sans-serif;
        }
        
        .team-wickets-large {
            font-size: 1.8rem;
            color: var(--danger);
            font-weight: 700;
            margin-left: 5px;
            font-family: 'Poppins', sans-serif;
        }
        
        .team-overs-large {
            font-size: 1.2rem;
            color: var(--text-secondary);
            font-weight: 600;
            font-family: 'Poppins', sans-serif;
        }
        
        /* Match Status Section */
        .match-status-section {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            text-align: center;
        }
        
        .match-status-title {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .match-status-value {
            font-size: 1.3rem;
            color: var(--accent-green);
            font-weight: 700;
            font-family: 'Poppins', sans-serif;
        }
        
        /* Player Statistics Section */
        .player-stats-section {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid var(--border-color);
        }
        
        .player-stats-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .player-stats-title {
            font-size: 1.1rem;
            color: var(--text-primary);
            font-weight: 700;
            font-family: 'Poppins', sans-serif;
        }
        
        .stats-tabs {
            display: flex;
            gap: 5px;
        }
        
        .stats-tab {
            padding: 6px 12px;
            background-color: var(--secondary-dark);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 0.8rem;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .stats-tab.active {
            background-color: var(--accent-green);
            color: var(--primary-dark);
            border-color: var(--accent-green);
        }
        
        .stats-tab:hover:not(.active) {
            background-color: rgba(0, 255, 139, 0.1);
            border-color: var(--accent-green);
        }
        
        /* Statistics Tables */
        .stats-table-container {
            overflow-x: auto;
        }
        
        .stats-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .stats-table th {
            background-color: var(--secondary-dark);
            color: var(--text-secondary);
            font-weight: 600;
            text-align: left;
            padding: 12px 15px;
            font-size: 0.85rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .stats-table td {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            font-size: 0.9rem;
        }
        
        .stats-table tr:last-child td {
            border-bottom: none;
        }
        
        .stats-table tr:hover {
            background-color: rgba(0, 255, 139, 0.05);
        }
        
        .player-name-cell {
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .player-stats-value {
            color: var(--accent-green);
            font-weight: 600;
        }
        
        .striker-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background-color: var(--accent-green);
            border-radius: 50%;
            margin-right: 8px;
        }
        
        /* Cricket Scoring Controls */
        .cricket-scoring-controls {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid var(--border-color);
        }
        
        .scoring-controls-title {
            font-size: 1rem;
            color: var(--accent-green);
            font-weight: 700;
            margin-bottom: 15px;
            text-align: center;
            font-family: 'Poppins', sans-serif;
        }
        
        .runs-controls-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        @media (max-width: 480px) {
            .runs-controls-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        .scoring-btn {
            padding: 12px;
            background-color: var(--secondary-dark);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            text-align: center;
            transition: var(--transition);
            font-family: 'Poppins', sans-serif;
        }
        
        .scoring-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .scoring-btn.run-0 {
            border-color: var(--border-color);
        }
        
        .scoring-btn.run-1 {
            border-color: #00c853;
            background-color: rgba(0, 200, 83, 0.1);
            color: #00c853;
        }
        
        .scoring-btn.run-2 {
            border-color: #00c853;
            background-color: rgba(0, 200, 83, 0.15);
            color: #00c853;
        }
        
        .scoring-btn.run-3 {
            border-color: #00c853;
            background-color: rgba(0, 200, 83, 0.2);
            color: #00c853;
        }
        
        .scoring-btn.run-4 {
            border-color: #ffc107;
            background-color: rgba(255, 193, 7, 0.15);
            color: #ffc107;
        }
        
        .scoring-btn.run-6 {
            border-color: #ff5722;
            background-color: rgba(255, 87, 34, 0.15);
            color: #ff5722;
        }
        
        .scoring-btn.wicket {
            border-color: #f44336;
            background-color: rgba(244, 67, 54, 0.15);
            color: #f44336;
        }
        
        .extras-controls-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .extra-btn {
            padding: 10px;
            background-color: var(--secondary-dark);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            text-align: center;
            transition: var(--transition);
        }
        
        .extra-btn.wide {
            border-color: #9c27b0;
            color: #9c27b0;
        }
        
        .extra-btn.noball {
            border-color: #ff9800;
            color: #ff9800;
        }
        
        .extra-btn:hover {
            background-color: rgba(0, 255, 139, 0.1);
            border-color: var(--accent-green);
        }
        
        .action-controls-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }
        
        .action-btn {
            padding: 8px 15px;
            background-color: transparent;
            border: 1.5px solid var(--accent-green);
            border-radius: 20px;
            color: var(--accent-green);
            font-weight: 600;
            font-size: 0.8rem;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            transition: var(--transition);
        }
        
        .action-btn:hover {
            background-color: var(--accent-green);
            color: var(--primary-dark);
        }
        
        .action-btn.primary {
            background-color: var(--accent-green);
            color: var(--primary-dark);
        }
        
        .action-btn.primary:hover {
            background-color: var(--accent-green-dark);
        }
        
        .action-btn.undo {
            border-color: var(--warning);
            color: var(--warning);
        }
        
        .action-btn.undo:hover {
            background-color: var(--warning);
            color: var(--primary-dark);
        }
        
        /* Football scoring */
        .football-scoring-compact .teams-score-horizontal {
            grid-template-columns: 1fr 1fr;
        }
        
        .football-team-score {
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: center;
            border: 1px solid #2196f3;
        }
        
        .football-team-name {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 10px;
            font-family: 'Poppins', sans-serif;
        }
        
        .football-team-goals {
            font-size: 2.5rem;
            font-weight: 900;
            color: white;
            font-family: 'Poppins', sans-serif;
        }
        
        .football-time-display {
            text-align: center;
            margin: 15px 0;
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--accent-green);
            font-family: 'Poppins', sans-serif;
        }
        
        /* Custom sport scoring */
        .custom-scoring-compact .teams-score-horizontal {
            grid-template-columns: 1fr 1fr;
        }
        
        .custom-team-score {
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: center;
            border: 1px solid #9c27b0;
        }
        
        .custom-team-name {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 10px;
            font-family: 'Poppins', sans-serif;
        }
        
        .custom-team-points {
            font-size: 2.5rem;
            font-weight: 900;
            color: white;
            font-family: 'Poppins', sans-serif;
        }
        
        /* Winner Announcement */
        .winner-container {
            text-align: center;
            padding: 40px 25px;
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            border: 2px solid var(--accent-green);
            max-width: 700px;
            margin: 0 auto;
            animation: bounceIn 1s ease;
        }
        
        @media (max-width: 768px) {
            .winner-container {
                padding: 25px 15px;
                margin: 0 10px;
            }
        }
        
        .trophy-icon {
            font-size: 4rem;
            color: gold;
            margin-bottom: 15px;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .winner-name {
            font-size: 2.5rem;
            font-weight: 900;
            margin: 15px 0;
            color: var(--accent-green);
            text-transform: uppercase;
            font-family: 'Poppins', sans-serif;
        }
        
        @media (max-width: 768px) {
            .winner-name {
                font-size: 1.8rem;
            }
        }
        
        /* Player Selection Modal */
        .player-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .player-modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }
        
        .player-modal-content {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 25px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            border: 2px solid var(--accent-green);
        }
        
        .player-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .player-modal-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--accent-green);
            font-family: 'Poppins', sans-serif;
        }
        
        .close-modal {
            background: none;
            border: none;
            color: var(--accent-green);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
        }
        
        .player-list-modal {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
        }
        
        .player-item-modal {
            padding: 12px;
            margin-bottom: 8px;
            background-color: var(--secondary-dark);
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .player-item-modal:hover {
            background-color: rgba(0, 255, 139, 0.1);
            border: 1px solid var(--accent-green);
        }
        
        .player-item-modal.selected {
            background-color: rgba(0, 255, 139, 0.2);
            border: 2px solid var(--accent-green);
        }
        
        .player-info-modal {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .player-stats-modal {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        /* Scorecard Modal */
        .scorecard-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .scorecard-modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }
        
        .scorecard-content {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 25px;
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 2px solid var(--accent-green);
        }
        
        .scorecard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .scorecard-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--accent-green);
            font-family: 'Poppins', sans-serif;
        }
        
        .close-scorecard {
            background: none;
            border: none;
            color: var(--accent-green);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
        }
        
        .scorecard-teams {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 768px) {
            .scorecard-teams {
                grid-template-columns: 1fr;
                gap: 15px;
            }
        }
        
        .scorecard-team {
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            padding: 15px;
        }
        
        .scorecard-team-name {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--accent-green);
            padding-bottom: 5px;
            border-bottom: 1px solid var(--border-color);
            font-family: 'Poppins', sans-serif;
        }
        
        .scorecard-player-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .scorecard-player-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.1);
        }
        
        .scorecard-player-item:last-child {
            border-bottom: none;
        }
        
        .player-name-scorecard {
            font-weight: 600;
        }
        
        .player-stats-scorecard {
            text-align: right;
            font-size: 0.9rem;
        }
        
        .scorecard-section {
            margin-bottom: 15px;
        }
        
        .scorecard-section-title {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 600;
            font-family: 'Poppins', sans-serif;
        }
        
        /* Stats Modal */
        .stats-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .stats-modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }
        
        .stats-content {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 25px;
            max-width: 700px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 2px solid var(--accent-green);
        }
        
        .stats-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .close-stats {
            background: none;
            border: none;
            color: var(--accent-green);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .stat-card {
            background-color: var(--secondary-dark);
            border-radius: 6px;
            padding: 15px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: 900;
            color: var(--accent-green);
            margin: 8px 0;
            font-family: 'Poppins', sans-serif;
        }
        
        .stat-label {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }
        
        /* Custom overs input styling */
        .custom-overs-input {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 8px;
        }
        
        .custom-overs-input input {
            width: 70px;
        }
        
        /* Mobile menu toggle */
        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--accent-green);
            font-size: 1.3rem;
            cursor: pointer;
        }
        
        @media (max-width: 768px) {
            .mobile-menu-toggle {
                display: block;
            }
            
            .main-nav.hidden-on-mobile {
                display: none;
            }
            
            h2 {
                font-size: 1.3rem;
            }
            
            h3 {
                font-size: 1.1rem;
            }
            
            .container {
                padding: 0 12px;
            }
            
            .user-profile span {
                display: none;
            }
        }
        
        /* Step progress container */
        .step-progress-container {
            margin-bottom: 25px;
        }
        
        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-green-dark) 100%);
            color: var(--primary-dark);
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: 600;
            z-index: 1001;
            box-shadow: 0 4px 15px rgba(0, 255, 139, 0.3);
            transition: transform 0.3s ease;
            font-family: 'Poppins', sans-serif;
        }
        
        .notification.show {
            transform: translateX(-50%) translateY(0);
        }
        
        /* Bowler change notification */
        .bowler-change-notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: var(--accent-green);
            padding: 15px 25px;
            border-radius: var(--border-radius);
            font-weight: 700;
            z-index: 1002;
            font-size: 1.1rem;
            font-family: 'Poppins', sans-serif;
            border: 2px solid var(--accent-green);
            opacity: 0;
            animation: fadeInOut 3s ease;
        }
        
        @keyframes fadeInOut {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
        }
        
        footer {
            padding: 15px 0;
            text-align: center;
            background-color: var(--secondary-dark);
            border-top: 1px solid var(--border-color);
            font-size: 0.8rem;
            color: var(--text-muted);
        }
    </style>
</head>
<body>
    <!-- Enhanced Splash Screen -->
    <div id="splash-screen">
        <div class="splash-logo">
            <i class="fas fa-trophy"></i>
            <span>ScoreMaster Pro</span>
        </div>
        <div class="splash-tagline">Professional Multi-Sport Tournament Platform</div>
        <div class="splash-loader">
            <div class="splash-loader-bar"></div>
        </div>
    </div>
    
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-trophy"></i>
                    <span>ScoreMaster Pro</span>
                </div>
                <button class="mobile-menu-toggle" id="mobileMenuToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="user-profile">
                    <span id="tournament-name-display">Multi-Sport Tournament</span>
                    <div class="user-avatar">
                        <i class="fas fa-trophy"></i>
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <nav class="main-nav hidden-on-mobile">
        <div class="nav-item active" data-section="sport-dashboard">
            <i class="fas fa-home"></i> Sport Dashboard
        </div>
        <div class="nav-item" data-section="tournament-setup">
            <i class="fas fa-plus-circle"></i> Create Tournament
        </div>
        <div class="nav-item" data-section="live-scoring">
            <i class="fas fa-broadcast-tower"></i> Live Scoring
        </div>
        <div class="nav-item" data-section="winner-announcement">
            <i class="fas fa-trophy"></i> Winner Announcement
        </div>
    </nav>
    
    <main class="container">
        <!-- Horizontal Step Progress -->
        <div class="step-progress-container">
            <div class="step-progress" id="step-progress">
                <div class="step-indicator active" data-step="1">
                    1
                    <div class="step-label">Select Sport</div>
                </div>
                <div class="step-indicator" data-step="2">
                    2
                    <div class="step-label">Tournament Setup</div>
                </div>
                <div class="step-indicator" data-step="3">
                    3
                    <div class="step-label">Create Teams</div>
                </div>
                <div class="step-indicator" data-step="4">
                    4
                    <div class="step-label">Match Setup</div>
                </div>
                <div class="step-indicator" data-step="5">
                    5
                    <div class="step-label">Live Scoring</div>
                </div>
                <div class="step-progress-line" id="step-progress-line"></div>
            </div>
        </div>
        
        <!-- Sport Selection -->
        <section id="sport-dashboard" class="dashboard-section active">
            <h2>Select Sport</h2>
            <p class="subheading" style="color: var(--text-secondary); margin-bottom: 20px; font-size: 0.95rem;">Choose a sport to start your tournament</p>
            
            <div class="sport-grid">
                <div class="sport-card selected" data-sport="cricket">
                    <div class="sport-icon">
                        <i class="fas fa-baseball-ball"></i>
                    </div>
                    <h3 class="sport-name">Cricket</h3>
                </div>
                
                <div class="sport-card" data-sport="football">
                    <div class="sport-icon">
                        <i class="fas fa-futbol"></i>
                    </div>
                    <h3 class="sport-name">Football</h3>
                </div>

                <div class="sport-card" data-sport="custom">
                    <div class="sport-icon">
                        <i class="fas fa-magic"></i>
                    </div>
                    <h3 class="sport-name">Custom Sport</h3>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn" id="start-tournament-btn">
                    <i class="fas fa-arrow-right"></i> Start <span id="selected-sport-name">Cricket</span> Tournament Setup
                </button>
            </div>
        </section>
        
        <!-- Tournament Setup -->
        <section id="tournament-setup" class="dashboard-section">
            <div class="setup-container">
                <!-- Step 1: Tournament Details -->
                <div class="setup-step active" id="step1">
                    <div class="step-header">
                        <div class="step-number">1</div>
                        <h3 class="step-title" id="setup-title">Cricket Tournament Details</h3>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Tournament Name</label>
                        <input type="text" class="form-control" id="tournament-name" placeholder="e.g., Champions League T20" value="Champions League T20">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Number of Teams</label>
                        <input type="number" class="form-control form-control-sm" id="team-count" min="2" max="16" value="4">
                        <p class="form-hint" style="color: var(--text-muted); margin-top: 5px; font-size: 0.85rem;">Enter number of teams (2-16)</p>
                    </div>
                    
                    <!-- Cricket Specific Controls -->
                    <div class="sport-specific-controls cricket-controls active" id="cricket-controls">
                        <div class="form-group">
                            <label class="form-label">Overs per Innings</label>
                            <div class="custom-overs-input">
                                <select class="form-control form-control-sm" id="overs-count">
                                    <option value="custom">Custom Overs</option>
                                    <option value="2">2 Overs</option>
                                    <option value="3">3 Overs</option>
                                    <option value="5">5 Overs (Quick Match)</option>
                                    <option value="6">6 Overs</option>
                                    <option value="10">10 Overs</option>
                                    <option value="20" selected>20 Overs (T20)</option>
                                    <option value="50">50 Overs (ODI)</option>
                                </select>
                                <input type="number" class="form-control form-control-sm" id="custom-overs-input" min="1" max="100" placeholder="Enter overs" style="display: none;">
                            </div>
                            <p class="form-hint" style="color: var(--text-muted); margin-top: 5px; font-size: 0.85rem;">Select from options or choose "Custom Overs" to enter any number</p>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Players per Team</label>
                            <input type="number" class="form-control form-control-sm" id="players-per-team" min="6" max="15" value="11">
                            <p class="form-hint" style="color: var(--text-muted); margin-top: 5px; font-size: 0.85rem;">Enter players per team (6-15)</p>
                        </div>
                    </div>
                    
                    <!-- Football Specific Controls -->
                    <div class="sport-specific-controls football-controls" id="football-controls">
                        <div class="form-group">
                            <label class="form-label">Match Duration</label>
                            <div class="match-duration-input">
                                <input type="number" class="form-control form-control-sm" id="match-duration" min="20" max="120" value="90">
                                <span>minutes</span>
                            </div>
                            <div class="half-input">
                                <span>Halves:</span>
                                <input type="number" class="form-control form-control-sm" id="halves-duration" min="10" max="60" value="45">
                                <span>minutes each</span>
                            </div>
                            <p class="form-hint" style="color: var(--text-muted); margin-top: 5px; font-size: 0.85rem;">Total match duration in minutes</p>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Players per Team</label>
                            <input type="number" class="form-control form-control-sm" id="football-players-per-team" min="7" max="15" value="11">
                            <p class="form-hint" style="color: var(--text-muted); margin-top: 5px; font-size: 0.85rem;">Enter players per team (7-15)</p>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Extra Time</label>
                            <div class="custom-overs-input">
                                <select class="form-control form-control-sm" id="extra-time">
                                    <option value="0">No Extra Time</option>
                                    <option value="15">15 minutes</option>
                                    <option value="30" selected>30 minutes (15+15)</option>
                                    <option value="45">45 minutes</option>
                                </select>
                            </div>
                            <p class="form-hint" style="color: var(--text-muted); margin-top: 5px; font-size: 0.85rem;">Extra time duration if match is tied</p>
                        </div>
                    </div>
                    
                    <!-- Custom Sport Controls -->
                    <div class="sport-specific-controls custom-sport-controls" id="custom-controls">
                        <div class="form-group">
                            <label class="form-label">Sport Name</label>
                            <input type="text" class="form-control" id="custom-sport-name" placeholder="e.g., Handball, Basketball, etc.">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Players per Team</label>
                            <input type="number" class="form-control form-control-sm" id="custom-players-per-team" min="2" max="20" value="7">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Match Duration (minutes)</label>
                            <input type="number" class="form-control form-control-sm" id="custom-match-duration" min="5" max="120" value="40">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Scoring Rules</label>
                            <div class="custom-rules-container" id="custom-rules-container">
                                <div class="rule-item">
                                    <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                                        <input type="text" class="form-control" placeholder="Rule name (e.g., Goal)" value="Goal">
                                        <input type="number" class="form-control form-control-sm" placeholder="Points" value="1" min="1">
                                    </div>
                                    <textarea class="form-control" placeholder="Rule description" style="font-size: 0.85rem; height: 60px;">Scoring a goal</textarea>
                                </div>
                                <div class="rule-item">
                                    <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                                        <input type="text" class="form-control" placeholder="Rule name (e.g., Foul)" value="Foul">
                                        <input type="number" class="form-control form-control-sm" placeholder="Points" value="0" min="0">
                                    </div>
                                    <textarea class="form-control" placeholder="Rule description" style="font-size: 0.85rem; height: 60px;">Committing a foul</textarea>
                                </div>
                            </div>
                            <button type="button" class="add-rule-btn" id="add-rule-btn">
                                <i class="fas fa-plus"></i> Add Rule
                            </button>
                        </div>
                    </div>
                    
                    <div class="navigation-buttons">
                        <button class="btn-outline" id="back-to-sport">
                            <i class="fas fa-arrow-left"></i> Back to Sport Selection
                        </button>
                        <button class="btn" id="next-to-teams">
                            Next: Create Teams <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 2: Create Teams -->
                <div class="setup-step" id="step2">
                    <div class="step-header">
                        <div class="step-number">2</div>
                        <h3 class="step-title">Create Teams & Players</h3>
                    </div>
                    
                    <div id="teams-container">
                        <!-- Teams will be generated here -->
                    </div>
                    
                    <div class="navigation-buttons">
                        <button class="btn-outline" id="back-to-details">
                            <i class="fas fa-arrow-left"></i> Back to Tournament Details
                        </button>
                        <button class="btn" id="next-to-match-setup">
                            Next: Match Setup <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 3: Match Setup -->
                <div class="setup-step" id="step3">
                    <div class="step-header">
                        <div class="step-number">3</div>
                        <h3 class="step-title">Match Setup</h3>
                    </div>
                    
                    <p style="margin-bottom: 15px; color: var(--text-secondary);">Set up the first match of your tournament</p>
                    
                    <div class="match-setup-container">
                        <div class="match-options">
                            <h4 style="margin-bottom: 12px;">Select Teams</h4>
                            <div class="teams-selection" id="teams-selection">
                                <!-- Teams will be populated here -->
                            </div>
                            
                            <!-- Football specific setup -->
                            <div style="margin-top: 25px; display: none;" id="football-match-setup">
                                <h4 style="margin-bottom: 12px;">Match Settings</h4>
                                <div class="form-group">
                                    <label class="form-label">Pitch Condition</label>
                                    <select class="form-control" id="pitch-condition">
                                        <option value="dry">Dry</option>
                                        <option value="wet">Wet</option>
                                        <option value="artificial">Artificial</option>
                                        <option value="normal" selected>Normal</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Weather</label>
                                    <select class="form-control" id="weather">
                                        <option value="sunny">Sunny</option>
                                        <option value="cloudy">Cloudy</option>
                                        <option value="rainy">Rainy</option>
                                        <option value="clear" selected>Clear</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div style="margin-top: 25px;" id="cricket-match-setup">
                                <h4 style="margin-bottom: 12px;">Toss Winner & Decision</h4>
                                <div class="form-group">
                                    <label class="form-label">Toss Winner</label>
                                    <select class="form-control" id="toss-winner">
                                        <!-- Options will be populated -->
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Toss Decision</label>
                                    <select class="form-control" id="toss-decision">
                                        <option value="bat">Bat First</option>
                                        <option value="bowl">Bowl First</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="match-options">
                            <h4 style="margin-bottom: 12px;">Match Preview</h4>
                            <div id="match-preview" style="padding: 15px; background-color: var(--secondary-dark); border-radius: var(--border-radius);">
                                <p style="text-align: center; margin-bottom: 12px; color: var(--text-secondary);">Match details will appear here</p>
                                <div id="preview-teams" style="display: flex; justify-content: center; gap: 15px; margin-bottom: 15px;">
                                    <div style="text-align: center;">
                                        <div class="team-select-icon" id="preview-team1">T1</div>
                                        <div id="preview-team1-name" style="margin-top: 8px; font-weight: bold; font-size: 0.95rem;">Team 1</div>
                                    </div>
                                    <div style="display: flex; align-items: center; font-weight: bold; color: var(--accent-green); font-size: 1.1rem;">VS</div>
                                    <div style="text-align: center;">
                                        <div class="team-select-icon" id="preview-team2">T2</div>
                                        <div id="preview-team2-name" style="margin-top: 8px; font-weight: bold; font-size: 0.95rem;">Team 2</div>
                                    </div>
                                </div>
                                <div id="preview-details">
                                    <p id="preview-format" style="font-size: 0.9rem;"><strong>Format:</strong> <span id="preview-format-value">20 overs per innings</span></p>
                                    <p id="preview-toss-line" style="font-size: 0.9rem;"><strong>Toss:</strong> <span id="preview-toss">Not decided yet</span></p>
                                </div>
                            </div>
                            
                            <div style="margin-top: 25px; text-align: center;">
                                <button class="btn" id="launch-tournament-btn">
                                    <i class="fas fa-rocket"></i> Launch Tournament & Start Match
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="navigation-buttons">
                        <button class="btn-outline" id="back-to-teams">
                            <i class="fas fa-arrow-left"></i> Back to Teams
                        </button>
                        <button class="btn-outline" id="modify-tournament">
                            <i class="fas fa-edit"></i> Modify Tournament
                        </button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Live Scoring - Redesigned Cricket Layout -->
        <section id="live-scoring" class="dashboard-section">
            <div class="live-scoring-container">
                <!-- Tournament Header -->
                <div class="tournament-header-compact">
                    <div class="tournament-title" id="tournament-title-compact">Champions League T20</div>
                    <div class="live-badge">
                        <span class="live-pulse"></span>
                        <span>LIVE</span>
                    </div>
                </div>
                
                <!-- Cricket Scoring - REDESIGNED -->
                <div id="cricket-scoring-compact" style="display: block;">
                    
                    <!-- 1. TOP SECTION - TEAMS SCOREBOARD SIDE BY SIDE -->
                    <div class="scoreboard-section">
                        <div class="scoreboard-header">
                            <div class="scoreboard-title">CRICKET SCOREBOARD</div>
                            <div class="match-format" id="match-format-display">T20  20 Overs</div>
                        </div>
                        
                        <!-- Teams Side by Side Scoreboard -->
                        <div class="teams-score-horizontal" id="teams-score-horizontal">
                            <!-- Team 1 (Batting) -->
                            <div class="team-score-card batting" id="team1-score-card">
                                <div class="team-name-large" id="team1-name-display">Mumbai Indians</div>
                                <div class="team-score-large">
                                    <span id="team1-runs">145</span>
                                    <span class="team-wickets-large" id="team1-wickets">/3</span>
                                </div>
                                <div class="team-overs-large" id="team1-overs">17.2</div>
                            </div>
                            
                            <!-- Team 2 (Bowling) -->
                            <div class="team-score-card" id="team2-score-card">
                                <div class="team-name-large" id="team2-name-display">Chennai Super Kings</div>
                                <div class="team-score-large">
                                    <span id="team2-runs">0</span>
                                    <span class="team-wickets-large" id="team2-wickets">/0</span>
                                </div>
                                <div class="team-overs-large" id="team2-overs">0.0</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 2. MATCH STATUS SECTION - CENTERED -->
                    <div class="match-status-section">
                        <div class="match-status-title">REQUIREMENT</div>
                        <div class="match-status-value" id="match-status-requirement">
                            Mumbai Indians need 25 runs in 18 balls
                        </div>
                    </div>
                    
                    <!-- 3. PLAYER STATISTICS SECTION -->
                    <div class="player-stats-section">
                        <div class="player-stats-header">
                            <div class="player-stats-title">PLAYER STATISTICS</div>
                            <div class="stats-tabs">
                                <div class="stats-tab active" id="show-batting-tab">Batting</div>
                                <div class="stats-tab" id="show-bowling-tab">Bowling</div>
                            </div>
                        </div>
                        
                        <!-- Batting Statistics Table -->
                        <div class="stats-table-container" id="batting-stats-container">
                            <table class="stats-table">
                                <thead>
                                    <tr>
                                        <th>Batter</th>
                                        <th>R</th>
                                        <th>B</th>
                                        <th>4s</th>
                                        <th>6s</th>
                                        <th>SR</th>
                                    </tr>
                                </thead>
                                <tbody id="batting-stats-body">
                                    <!-- Batting stats will be populated here -->
                                    <tr>
                                        <td class="player-name-cell">
                                            <span class="striker-indicator"></span> Rohit Sharma
                                        </td>
                                        <td>78</td>
                                        <td>45</td>
                                        <td>8</td>
                                        <td>3</td>
                                        <td class="player-stats-value">173.33</td>
                                    </tr>
                                    <tr>
                                        <td class="player-name-cell">
                                            Suryakumar Yadav
                                        </td>
                                        <td>32</td>
                                        <td>28</td>
                                        <td>4</td>
                                        <td>1</td>
                                        <td class="player-stats-value">114.28</td>
                                    </tr>
                                    <tr>
                                        <td class="player-name-cell">
                                            Ishan Kishan
                                        </td>
                                        <td>12</td>
                                        <td>14</td>
                                        <td>1</td>
                                        <td>0</td>
                                        <td class="player-stats-value">85.71</td>
                                    </tr>
                                    <tr>
                                        <td class="player-name-cell">
                                            Tilak Varma
                                        </td>
                                        <td>23</td>
                                        <td>17</td>
                                        <td>2</td>
                                        <td>1</td>
                                        <td class="player-stats-value">135.29</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Bowling Statistics Table (Initially Hidden) -->
                        <div class="stats-table-container" id="bowling-stats-container" style="display: none;">
                            <table class="stats-table">
                                <thead>
                                    <tr>
                                        <th>Bowler</th>
                                        <th>O</th>
                                        <th>R</th>
                                        <th>W</th>
                                        <th>M</th>
                                        <th>Econ</th>
                                    </tr>
                                </thead>
                                <tbody id="bowling-stats-body">
                                    <!-- Bowling stats will be populated here -->
                                    <tr>
                                        <td class="player-name-cell">
                                            Jasprit Bumrah
                                        </td>
                                        <td>3.2</td>
                                        <td>24</td>
                                        <td>2</td>
                                        <td>0</td>
                                        <td class="player-stats-value">7.20</td>
                                    </tr>
                                    <tr>
                                        <td class="player-name-cell">
                                            Jofra Archer
                                        </td>
                                        <td>3.0</td>
                                        <td>31</td>
                                        <td>1</td>
                                        <td>0</td>
                                        <td class="player-stats-value">10.33</td>
                                    </tr>
                                    <tr>
                                        <td class="player-name-cell">
                                            Piyush Chawla
                                        </td>
                                        <td>2.0</td>
                                        <td>18</td>
                                        <td>0</td>
                                        <td>0</td>
                                        <td class="player-stats-value">9.00</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Cricket Scoring Controls -->
                    <div class="cricket-scoring-controls">
                        <div class="scoring-controls-title">SCORING CONTROLS</div>
                        
                        <!-- Runs Controls -->
                        <div class="runs-controls-grid">
                            <div class="scoring-btn run-0" data-runs="0">0</div>
                            <div class="scoring-btn run-1" data-runs="1">1</div>
                            <div class="scoring-btn run-2" data-runs="2">2</div>
                            <div class="scoring-btn run-3" data-runs="3">3</div>
                            <div class="scoring-btn run-4" data-runs="4">4</div>
                            <div class="scoring-btn run-6" data-runs="6">6</div>
                            <div class="scoring-btn wicket" data-wicket="true">W</div>
                            <div class="scoring-btn" id="undo-btn"></div>
                        </div>
                        
                        <!-- Extra Controls -->
                        <div class="extras-controls-row">
                            <div class="extra-btn wide" data-extra="wide">Wide</div>
                            <div class="extra-btn noball" data-extra="noball">No Ball</div>
                            <div class="extra-btn" data-extra="bye">Bye</div>
                        </div>
                        
                        <!-- Action Controls -->
                        <div class="action-controls-row">
                            <button class="action-btn" id="swap-batsmen-btn">
                                <i class="fas fa-random"></i> Swap
                            </button>
                            <button class="action-btn" id="change-striker-btn">
                                <i class="fas fa-user"></i> Striker
                            </button>
                            <button class="action-btn" id="change-non-striker-btn">
                                <i class="fas fa-user-friends"></i> Non-Striker
                            </button>
                            <button class="action-btn" id="new-batsman-btn">
                                <i class="fas fa-user-plus"></i> New Batsman
                            </button>
                            <button class="action-btn" id="change-bowler-btn">
                                <i class="fas fa-baseball-ball"></i> Bowler
                            </button>
                            <button class="action-btn primary" id="end-innings-btn">
                                <i class="fas fa-flag-checkered"></i> End Innings
                            </button>
                            <button class="action-btn" id="scorecard-btn">
                                <i class="fas fa-list-ol"></i> Scorecard
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Football Scoring -->
                <div id="football-scoring-compact" style="display: none;">
                    <!-- Teams Score - Side by Side -->
                    <div class="scoreboard-section">
                        <div class="scoreboard-header">
                            <div class="scoreboard-title">FOOTBALL SCOREBOARD</div>
                            <div class="match-format" id="football-format-display">90 mins  2 Halves</div>
                        </div>
                        
                        <div class="teams-score-horizontal" id="football-teams-score-row">
                            <!-- Football teams will be populated here -->
                        </div>
                        
                        <!-- Time Display -->
                        <div class="football-time-display" id="football-time-display">
                            <div id="current-time">00:00</div>
                            <div style="font-size: 0.8rem; color: var(--text-secondary);">First Half</div>
                        </div>
                    </div>
                    
                    <!-- Football Scoring Controls -->
                    <div class="cricket-scoring-controls">
                        <div class="scoring-controls-title">FOOTBALL SCORING</div>
                        
                        <!-- Goal Controls -->
                        <div class="runs-controls-grid">
                            <div class="scoring-btn run-1" data-team="team1" data-action="goal">
                                <i class="fas fa-futbol"></i> Team 1 Goal
                            </div>
                            <div class="scoring-btn run-1" data-team="team2" data-action="goal">
                                <i class="fas fa-futbol"></i> Team 2 Goal
                            </div>
                            <div class="scoring-btn" style="border-color: #ffc107;" data-action="yellow">
                                <i class="fas fa-square" style="color: yellow;"></i> Yellow
                            </div>
                            <div class="scoring-btn" style="border-color: #f44336;" data-action="red">
                                <i class="fas fa-square" style="color: red;"></i> Red
                            </div>
                        </div>
                        
                        <!-- Time Controls -->
                        <div class="action-controls-row">
                            <button class="action-btn" id="start-timer-btn">
                                <i class="fas fa-play"></i> Start
                            </button>
                            <button class="action-btn" id="pause-timer-btn">
                                <i class="fas fa-pause"></i> Pause
                            </button>
                            <button class="action-btn" id="reset-timer-btn">
                                <i class="fas fa-redo"></i> Reset
                            </button>
                            <button class="action-btn primary" id="end-half-btn">
                                <i class="fas fa-flag"></i> End Half
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Custom Sport Scoring -->
                <div id="custom-scoring-compact" style="display: none;">
                    <!-- Teams Score - Side by Side -->
                    <div class="scoreboard-section">
                        <div class="scoreboard-header">
                            <div class="scoreboard-title" id="custom-sport-title-display">CUSTOM SPORT</div>
                            <div class="match-format" id="custom-format-display">40 mins</div>
                        </div>
                        
                        <div class="teams-score-horizontal" id="custom-teams-score-row">
                            <!-- Custom sport teams will be populated here -->
                        </div>
                    </div>
                    
                    <!-- Custom Scoring Controls -->
                    <div class="cricket-scoring-controls">
                        <div class="scoring-controls-title" id="custom-sport-controls-title">CUSTOM SPORT SCORING</div>
                        
                        <!-- Dynamic scoring controls will be added here -->
                        <div id="custom-scoring-controls">
                            <div style="text-align: center; padding: 20px; color: var(--text-muted);">
                                No scoring rules defined
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Winner Announcement -->
        <section id="winner-announcement" class="dashboard-section">
            <div class="winner-container">
                <div class="trophy-icon">
                    <i class="fas fa-trophy"></i>
                </div>
                
                <h2>MATCH RESULT</h2>
                
                <div class="winner-name" id="match-winner">Team A</div>
                
                <p style="font-size: 1.1rem; margin-bottom: 15px;" id="match-result-summary">Team A won by XX runs</p>
                
                <div style="background-color: var(--secondary-dark); padding: 15px; border-radius: var(--border-radius); margin: 20px 0;">
                    <div style="display: flex; justify-content: space-around; margin-bottom: 12px;">
                        <div style="text-align: center;">
                            <div id="result-team1-name" style="font-weight: bold; margin-bottom: 5px;">Team A</div>
                            <div id="result-team1-score" style="font-size: 1.2rem; color: var(--accent-green);">0/0 (20)</div>
                        </div>
                        <div style="display: flex; align-items: center; font-weight: bold; color: var(--accent-green);">VS</div>
                        <div style="text-align: center;">
                            <div id="result-team2-name" style="font-weight: bold; margin-bottom: 5px;">Team B</div>
                            <div id="result-team2-score" style="font-size: 1.2rem; color: var(--accent-green);">0/0 (20)</div>
                        </div>
                    </div>
                    <div id="result-details" style="font-size: 0.9rem;">
                        <p><strong>Man of the Match:</strong> <span id="man-of-match">-</span></p>
                        <p><strong>Best Bowler:</strong> <span id="best-bowler">-</span></p>
                        <p><strong>Best Batsman:</strong> <span id="best-batsman">-</span></p>
                    </div>
                </div>
                
                <div style="display: flex; justify-content: center; gap: 12px; flex-wrap: wrap;">
                    <button class="btn" id="new-match-btn">
                        <i class="fas fa-plus-circle"></i> Start New Match
                    </button>
                    <button class="btn-outline" id="back-to-dashboard-btn">
                        <i class="fas fa-home"></i> Back to Dashboard
                    </button>
                    <button class="btn" id="scorecard-btn-winner">
                        <i class="fas fa-list-ol"></i> View Scorecard
                    </button>
                </div>
            </div>
        </section>
    </main>
    
    <!-- Player Selection Modal -->
    <div class="player-modal" id="playerModal">
        <div class="player-modal-content">
            <div class="player-modal-header">
                <h3 class="player-modal-title" id="playerModalTitle">Select Player</h3>
                <button class="close-modal" id="closePlayerModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="playerModalDescription">Select a player from the list below:</div>
            
            <div class="player-list-modal" id="playerListModal">
                <!-- Player list will be populated here -->
            </div>
            
            <div style="margin-top: 20px; text-align: center;">
                <button class="btn" id="confirmPlayerSelection">Select Player</button>
                <button class="btn-outline" id="cancelPlayerSelection" style="margin-left: 10px;">Cancel</button>
            </div>
        </div>
    </div>
    
    <!-- Scorecard Modal -->
    <div class="scorecard-modal" id="scorecardModal">
        <div class="scorecard-content">
            <div class="scorecard-header">
                <h3 class="scorecard-title">Match Scorecard</h3>
                <button class="close-scorecard" id="closeScorecard">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="scorecard-teams" id="scorecardTeams">
                <!-- Team scorecards will be populated here -->
            </div>
            
            <div style="margin-top: 20px; text-align: center;">
                <button class="btn" id="printScorecardBtn">
                    <i class="fas fa-print"></i> Print Scorecard
                </button>
            </div>
        </div>
    </div>
    
    <!-- Stats Modal -->
    <div class="stats-modal" id="statsModal">
        <div class="stats-content">
            <div class="stats-header">
                <h3>Match Statistics</h3>
                <button class="close-stats" id="closeStats">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="stats-content">
                <!-- Stats will be populated here -->
            </div>
        </div>
    </div>
    
    <footer>
        <div class="container">
            <p>ScoreMaster Pro &copy; 2023 | Multi-Sport Tournament Scoring Platform</p>
            <p>Design optimized for Android | Professional cricket scoring system</p>
        </div>
    </footer>
    
    <!-- Notification Container -->
    <div class="notification" id="notification" style="display: none;"></div>
    
    <script>
        // Tournament Data Model
        const tournamentData = {
            sport: 'cricket',
            name: 'Champions League T20',
            teams: [],
            sportSpecific: {
                oversPerInnings: 20,
                playersPerTeam: 11,
                // Football specific
                matchDuration: 90,
                halvesDuration: 45,
                extraTime: 30,
                // Custom sport specific
                customSportName: '',
                customMatchDuration: 40,
                customRules: []
            },
            currentMatch: null,
            matches: []
        };
        
        // Current Match State
        let currentMatchState = {
            sport: 'cricket',
            team1: null,
            team2: null,
            innings: 1,
            isMatchStarted: false,
            actionHistory: [],
            singleBatterMode: false,
            currentBatterMode: 'double' // 'single' or 'double'
        };
        
        // Cricket Match State - Enhanced
        let cricketMatchState = {
            battingTeam: null,
            bowlingTeam: null,
            currentOver: 17,
            ballsInOver: 2,
            totalRuns: 145,
            wickets: 3,
            extras: 8,
            overs: [],
            currentOverBalls: [1, 0, 4, 2, 'W'],
            isFirstInningsComplete: false,
            target: 0,
            legalBallsThisOver: 5,
            
            striker: null,
            nonStriker: null,
            currentBowler: null,
            previousBowler: null,
            
            battingTeamPlayers: [],
            bowlingTeamPlayers: [],
            availableBatsmen: [],
            availableBowlers: [],
            usedBowlersThisOver: [],
            
            playerStats: {},
            wicketsFallen: [],
            
            // Team statistics
            team1Stats: {
                runs: 145,
                wickets: 3,
                overs: 17.2,
                extras: 8,
                runRate: 8.37
            },
            team2Stats: {
                runs: 0,
                wickets: 0,
                overs: 0,
                extras: 0,
                runRate: 0
            }
        };
        
        // Football Match State
        let footballMatchState = {
            team1Score: 0,
            team2Score: 0,
            team1YellowCards: 0,
            team2YellowCards: 0,
            team1RedCards: 0,
            team2RedCards: 0,
            team1Corners: 0,
            team2Corners: 0,
            team1Fouls: 0,
            team2Fouls: 0,
            currentTime: 0,
            currentHalf: 1,
            isTimerRunning: false,
            timerInterval: null,
            
            playerStats: {},
            goalScorers: [],
            cardEvents: []
        };
        
        // Custom Sport Match State
        let customSportMatchState = {
            team1Score: 0,
            team2Score: 0,
            team1Stats: {},
            team2Stats: {},
            currentTime: 0,
            isTimerRunning: false,
            timerInterval: null,
            
            playerStats: {},
            events: []
        };
        
        // Player selection modal state
        let playerSelectionState = {
            type: '',
            callback: null
        };
        
        // Store previous step for navigation
        let previousSteps = [];
        let currentStep = 1;
        
        // Initialize the application
        function initApp() {
            // Show main app after splash screen
            setTimeout(() => {
                document.getElementById('splash-screen').style.display = 'none';
                setupEventListeners();
                updateTournamentFromForm();
                generateTeams();
                setupMobileMenu();
                setupNavigation();
                setupTeamSelectionEvents();
                updateStepProgress();
                initializeDemoData();
                showNotification('ScoreMaster Pro loaded successfully!');
            }, 3000);
        }
        
        // Initialize demo data
        function initializeDemoData() {
            // Create demo teams with real player names
            const team1 = {
                id: 1,
                name: 'Mumbai Indians',
                players: [
                    { id: 1, name: 'Rohit Sharma', role: 'Batsman' },
                    { id: 2, name: 'Suryakumar Yadav', role: 'Batsman' },
                    { id: 3, name: 'Ishan Kishan', role: 'Batsman' },
                    { id: 4, name: 'Tilak Varma', role: 'Batsman' },
                    { id: 5, name: 'Tim David', role: 'All-rounder' },
                    { id: 6, name: 'Hardik Pandya', role: 'All-rounder' },
                    { id: 7, name: 'Jasprit Bumrah', role: 'Bowler' },
                    { id: 8, name: 'Jofra Archer', role: 'Bowler' },
                    { id: 9, name: 'Piyush Chawla', role: 'Bowler' },
                    { id: 10, name: 'Jason Behrendorff', role: 'Bowler' },
                    { id: 11, name: 'Kumar Kartikeya', role: 'Bowler' }
                ]
            };
            
            const team2 = {
                id: 2,
                name: 'Chennai Super Kings',
                players: [
                    { id: 12, name: 'MS Dhoni', role: 'Batsman' },
                    { id: 13, name: 'Ruturaj Gaikwad', role: 'Batsman' },
                    { id: 14, name: 'Devon Conway', role: 'Batsman' },
                    { id: 15, name: 'Ajinkya Rahane', role: 'Batsman' },
                    { id: 16, name: 'Shivam Dube', role: 'All-rounder' },
                    { id: 17, name: 'Ravindra Jadeja', role: 'All-rounder' },
                    { id: 18, name: 'Moeen Ali', role: 'All-rounder' },
                    { id: 19, name: 'Deepak Chahar', role: 'Bowler' },
                    { id: 20, name: 'Matheesha Pathirana', role: 'Bowler' },
                    { id: 21, name: 'Maheesh Theekshana', role: 'Bowler' },
                    { id: 22, name: 'Tushar Deshpande', role: 'Bowler' }
                ]
            };
            
            tournamentData.teams = [team1, team2];
            tournamentData.currentMatch = {
                team1: team1,
                team2: team2,
                tossWinner: team1,
                tossDecision: 'bat'
            };
            
            // Initialize cricket state with demo data
            cricketMatchState.battingTeam = team1;
            cricketMatchState.bowlingTeam = team2;
            cricketMatchState.striker = team1.players[0];
            cricketMatchState.nonStriker = team1.players[1];
            cricketMatchState.currentBowler = team2.players[7];
            cricketMatchState.previousBowler = null;
            cricketMatchState.usedBowlersThisOver = [team2.players[7].id];
            
            // Initialize player stats with demo data
            cricketMatchState.playerStats = {
                1: { runs: 78, balls: 45, fours: 8, sixes: 3, isOut: false },
                2: { runs: 32, balls: 28, fours: 4, sixes: 1, isOut: false },
                3: { runs: 12, balls: 14, fours: 1, sixes: 0, isOut: true },
                4: { runs: 23, balls: 17, fours: 2, sixes: 1, isOut: false },
                7: { wickets: 2, runsConceded: 24, ballsBowled: 20, overs: 3.2, maidens: 0, wides: 1, noBalls: 0 },
                8: { wickets: 1, runsConceded: 31, ballsBowled: 18, overs: 3.0, maidens: 0, wides: 2, noBalls: 0 },
                9: { wickets: 0, runsConceded: 18, ballsBowled: 12, overs: 2.0, maidens: 0, wides: 0, noBalls: 0 }
            };
            
            // Update team stats
            updateTeamStats();
            
            // Update live scoring display
            updateCompactLiveScoring();
            
            // Setup tabs
            setupStatsTabs();
        }
        
        // Update step progress visualization
        function updateStepProgress() {
            const stepIndicators = document.querySelectorAll('.step-indicator');
            const progressLine = document.getElementById('step-progress-line');
            
            // Update step indicators
            stepIndicators.forEach(indicator => {
                const step = parseInt(indicator.getAttribute('data-step'));
                indicator.classList.remove('active', 'completed');
                
                if (step < currentStep) {
                    indicator.classList.add('completed');
                } else if (step === currentStep) {
                    indicator.classList.add('active');
                }
            });
            
            // Update progress line width
            if (progressLine) {
                const totalSteps = stepIndicators.length;
                const progressPercent = ((currentStep - 1) / (totalSteps - 1)) * 100;
                progressLine.style.width = `${progressPercent}%`;
                progressLine.style.transition = 'width 0.5s ease';
            }
        }
        
        // Set up all event listeners
        function setupEventListeners() {
            // Sport selection
            document.querySelectorAll('.sport-card').forEach(card => {
                card.addEventListener('click', function() {
                    document.querySelectorAll('.sport-card').forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    tournamentData.sport = this.getAttribute('data-sport');
                    updateSportUI();
                });
            });
            
            // Navigation buttons
            document.getElementById('start-tournament-btn').addEventListener('click', () => goToStep(2));
            document.getElementById('back-to-sport').addEventListener('click', () => goToStep(1));
            document.getElementById('next-to-teams').addEventListener('click', () => {
                updateTournamentFromForm();
                generateTeams();
                goToStep(3);
            });
            document.getElementById('back-to-details').addEventListener('click', () => goToStep(2));
            document.getElementById('next-to-match-setup').addEventListener('click', () => {
                if (validateTeams()) {
                    setupMatchConfiguration();
                    goToStep(4);
                }
            });
            document.getElementById('back-to-teams').addEventListener('click', () => goToStep(3));
            document.getElementById('modify-tournament').addEventListener('click', () => goToStep(2));
            document.getElementById('launch-tournament-btn').addEventListener('click', () => {
                if (setupMatch()) {
                    goToStep(5);
                    startMatch();
                }
            });
            
            // Step indicator click events
            document.querySelectorAll('.step-indicator').forEach(indicator => {
                indicator.addEventListener('click', function() {
                    const step = parseInt(this.getAttribute('data-step'));
                    if (step <= currentStep || step === 5) {
                        goToStep(step);
                    }
                });
            });
            
            // Stats tabs
            setupStatsTabs();
            
            // Runs buttons
            document.querySelectorAll('.scoring-btn[data-runs]').forEach(button => {
                button.addEventListener('click', function() {
                    if (!currentMatchState.isMatchStarted || tournamentData.sport !== 'cricket') {
                        alert("Please start the match first!");
                        return;
                    }
                    
                    const runs = parseInt(this.getAttribute('data-runs'));
                    addCricketRun(runs);
                    updateAfterBall();
                });
            });
            
            // Wicket button
            document.querySelector('.scoring-btn[data-wicket]').addEventListener('click', function() {
                if (!currentMatchState.isMatchStarted || tournamentData.sport !== 'cricket') {
                    alert("Please start the match first!");
                    return;
                }
                
                addCricketWicket();
                updateAfterBall();
            });
            
            // Extra buttons
            document.querySelectorAll('.extra-btn').forEach(button => {
                button.addEventListener('click', function() {
                    if (!currentMatchState.isMatchStarted || tournamentData.sport !== 'cricket') {
                        alert("Please start the match first!");
                        return;
                    }
                    
                    const extra = this.getAttribute('data-extra');
                    
                    // Store action for undo
                    const action = {
                        type: 'cricket',
                        timestamp: new Date().getTime(),
                        cricketState: JSON.parse(JSON.stringify(cricketMatchState)),
                        matchState: JSON.parse(JSON.stringify(currentMatchState))
                    };
                    
                    if (extra === 'wide') {
                        addCricketExtra('wide', 1);
                    } else if (extra === 'noball') {
                        addCricketExtra('noball', 1);
                    } else if (extra === 'bye') {
                        addCricketExtra('bye', 1);
                    }
                    
                    // Update player stats after ball
                    updatePlayerStatsAfterBall();
                    
                    // Add to history
                    currentMatchState.actionHistory.push(action);
                    updateCompactLiveScoring();
                });
            });
            
            // Undo button
            document.getElementById('undo-btn').addEventListener('click', undoLastCricketAction);
            
            // Player management buttons
            document.getElementById('change-striker-btn').addEventListener('click', () => openPlayerSelectionModal('striker'));
            document.getElementById('change-non-striker-btn').addEventListener('click', () => openPlayerSelectionModal('nonStriker'));
            document.getElementById('change-bowler-btn').addEventListener('click', () => openPlayerSelectionModal('bowler'));
            document.getElementById('new-batsman-btn').addEventListener('click', () => openPlayerSelectionModal('newBatsman'));
            document.getElementById('swap-batsmen-btn').addEventListener('click', swapBatsmen);
            
            // End innings button
            document.getElementById('end-innings-btn').addEventListener('click', function() {
                if (tournamentData.sport === 'cricket') {
                    if (currentMatchState.innings === 1) {
                        endFirstInnings();
                    } else {
                        endMatch();
                    }
                } else if (tournamentData.sport === 'football') {
                    endFootballMatch();
                } else if (tournamentData.sport === 'custom') {
                    endCustomSportMatch();
                }
            });
            
            // Scorecard buttons
            document.getElementById('scorecard-btn').addEventListener('click', showScorecardModal);
            document.getElementById('scorecard-btn-winner').addEventListener('click', showScorecardModal);
            
            // Player modal
            document.getElementById('closePlayerModal').addEventListener('click', () => {
                document.getElementById('playerModal').classList.remove('active');
            });
            document.getElementById('cancelPlayerSelection').addEventListener('click', () => {
                document.getElementById('playerModal').classList.remove('active');
            });
            document.getElementById('confirmPlayerSelection').addEventListener('click', confirmPlayerSelection);
            
            // Scorecard modal
            document.getElementById('closeScorecard').addEventListener('click', () => {
                document.getElementById('scorecardModal').classList.remove('active');
            });
            
            // Print scorecard
            document.getElementById('printScorecardBtn').addEventListener('click', printScorecard);
            
            // Overs count selection
            const oversCountSelect = document.getElementById('overs-count');
            const customOversInput = document.getElementById('custom-overs-input');
            
            if (oversCountSelect) {
                oversCountSelect.addEventListener('change', function() {
                    if (this.value === 'custom') {
                        customOversInput.style.display = 'block';
                        customOversInput.focus();
                    } else {
                        customOversInput.style.display = 'none';
                        tournamentData.sportSpecific.oversPerInnings = parseInt(this.value);
                    }
                });
            }
            
            if (customOversInput) {
                customOversInput.addEventListener('input', function() {
                    const value = parseInt(this.value);
                    if (value > 0 && value <= 100) {
                        tournamentData.sportSpecific.oversPerInnings = value;
                    }
                });
            }
            
            // Add rule button for custom sport
            document.getElementById('add-rule-btn').addEventListener('click', addCustomRule);
            
            // Football scoring controls
            setupFootballScoringControls();
            
            // Toss selection change
            document.getElementById('toss-winner').addEventListener('change', updateMatchPreview);
            document.getElementById('toss-decision').addEventListener('change', updateMatchPreview);
            
            // Tournament form changes
            document.getElementById('team-count').addEventListener('change', updateTournamentFromForm);
            document.getElementById('tournament-name').addEventListener('input', updateTournamentFromForm);
            
            // New match button
            document.getElementById('new-match-btn').addEventListener('click', function() {
                resetMatchState();
                goToStep(4);
            });
            
            // Back to dashboard button
            document.getElementById('back-to-dashboard-btn').addEventListener('click', function() {
                goToStep(1);
            });
            
            // Close modals when clicking outside
            document.getElementById('playerModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
            
            document.getElementById('scorecardModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
            
            // Stats buttons
            document.getElementById('closeStats').addEventListener('click', function() {
                document.getElementById('statsModal').classList.remove('active');
            });
        }
        
        // Setup stats tabs
        function setupStatsTabs() {
            const battingTab = document.getElementById('show-batting-tab');
            const bowlingTab = document.getElementById('show-bowling-tab');
            
            if (battingTab && bowlingTab) {
                battingTab.addEventListener('click', function() {
                    this.classList.add('active');
                    bowlingTab.classList.remove('active');
                    document.getElementById('batting-stats-container').style.display = 'block';
                    document.getElementById('bowling-stats-container').style.display = 'none';
                });
                
                bowlingTab.addEventListener('click', function() {
                    this.classList.add('active');
                    battingTab.classList.remove('active');
                    document.getElementById('bowling-stats-container').style.display = 'block';
                    document.getElementById('batting-stats-container').style.display = 'none';
                });
            }
        }
        
        // Add custom rule for custom sport
        function addCustomRule() {
            const rulesContainer = document.getElementById('custom-rules-container');
            const ruleItem = document.createElement('div');
            ruleItem.className = 'rule-item';
            ruleItem.innerHTML = `
                <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                    <input type="text" class="form-control" placeholder="Rule name (e.g., Goal)">
                    <input type="number" class="form-control form-control-sm" placeholder="Points" value="1" min="0">
                </div>
                <textarea class="form-control" placeholder="Rule description" style="font-size: 0.85rem; height: 60px;"></textarea>
                <button type="button" class="btn-small btn-outline" style="margin-top: 5px; font-size: 0.75rem;" onclick="this.closest('.rule-item').remove()">
                    <i class="fas fa-trash"></i> Remove Rule
                </button>
            `;
            rulesContainer.appendChild(ruleItem);
        }
        
        // Set up football scoring controls
        function setupFootballScoringControls() {
            document.querySelectorAll('.scoring-btn[data-action="goal"]').forEach(button => {
                button.addEventListener('click', function() {
                    if (!currentMatchState.isMatchStarted || tournamentData.sport !== 'football') {
                        alert("Please start the match first!");
                        return;
                    }
                    
                    const team = this.getAttribute('data-team');
                    
                    if (team === 'team1') {
                        footballMatchState.team1Score++;
                        showNotification(`Goal for ${currentMatchState.team1.name}!`, 'success');
                    } else {
                        footballMatchState.team2Score++;
                        showNotification(`Goal for ${currentMatchState.team2.name}!`, 'success');
                    }
                    updateFootballScoring();
                });
            });
            
            document.querySelectorAll('.scoring-btn[data-action="yellow"]').forEach(button => {
                button.addEventListener('click', function() {
                    if (!currentMatchState.isMatchStarted || tournamentData.sport !== 'football') {
                        alert("Please start the match first!");
                        return;
                    }
                    
                    // This is simplified - in real app, you'd select which team/player
                    footballMatchState.team1YellowCards++;
                    showNotification("Yellow card issued", 'warning');
                });
            });
            
            document.querySelectorAll('.scoring-btn[data-action="red"]').forEach(button => {
                button.addEventListener('click', function() {
                    if (!currentMatchState.isMatchStarted || tournamentData.sport !== 'football') {
                        alert("Please start the match first!");
                        return;
                    }
                    
                    // This is simplified - in real app, you'd select which team/player
                    footballMatchState.team1RedCards++;
                    showNotification("Red card issued", 'error');
                });
            });
        }
        
        // Start football timer
        function startFootballTimer() {
            if (!footballMatchState.isTimerRunning) {
                footballMatchState.isTimerRunning = true;
                footballMatchState.timerInterval = setInterval(() => {
                    footballMatchState.currentTime++;
                    updateFootballTimeDisplay();
                }, 1000);
            }
        }
        
        // Pause football timer
        function pauseFootballTimer() {
            if (footballMatchState.isTimerRunning) {
                clearInterval(footballMatchState.timerInterval);
                footballMatchState.isTimerRunning = false;
            }
        }
        
        // Reset football timer
        function resetFootballTimer() {
            pauseFootballTimer();
            footballMatchState.currentTime = 0;
            updateFootballTimeDisplay();
        }
        
        // End football half
        function endFootballHalf() {
            if (footballMatchState.currentHalf === 1) {
                footballMatchState.currentHalf = 2;
                footballMatchState.currentTime = 0;
                showNotification("First half ended. Starting second half.", 'info');
            } else {
                endFootballMatch();
            }
            updateFootballScoring();
        }
        
        // Update football time display
        function updateFootballTimeDisplay() {
            const minutes = Math.floor(footballMatchState.currentTime / 60);
            const seconds = footballMatchState.currentTime % 60;
            const timeDisplay = document.getElementById('current-time');
            if (timeDisplay) {
                timeDisplay.textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            // Update half indicator
            const halfIndicator = document.querySelector('#football-time-display div:nth-child(2)');
            if (halfIndicator) {
                halfIndicator.textContent = footballMatchState.currentHalf === 1 ? 'First Half' : 'Second Half';
            }
        }
        
        // Update football scoring display
        function updateFootballScoring() {
            const teamsRow = document.getElementById('football-teams-score-row');
            if (!teamsRow || !currentMatchState.team1 || !currentMatchState.team2) return;
            
            teamsRow.innerHTML = '';
            
            // Team 1
            const team1Div = document.createElement('div');
            team1Div.className = 'football-team-score';
            team1Div.innerHTML = `
                <div class="football-team-name">${currentMatchState.team1.name}</div>
                <div class="football-team-goals">${footballMatchState.team1Score}</div>
            `;
            
            // Team 2
            const team2Div = document.createElement('div');
            team2Div.className = 'football-team-score';
            team2Div.innerHTML = `
                <div class="football-team-name">${currentMatchState.team2.name}</div>
                <div class="football-team-goals">${footballMatchState.team2Score}</div>
            `;
            
            teamsRow.appendChild(team1Div);
            teamsRow.appendChild(team2Div);
        }
        
        // End football match
        function endFootballMatch() {
            pauseFootballTimer();
            
            let winner = null;
            let resultSummary = '';
            
            if (footballMatchState.team1Score > footballMatchState.team2Score) {
                winner = currentMatchState.team1;
                resultSummary = `${winner.name} won ${footballMatchState.team1Score}-${footballMatchState.team2Score}`;
            } else if (footballMatchState.team2Score > footballMatchState.team1Score) {
                winner = currentMatchState.team2;
                resultSummary = `${winner.name} won ${footballMatchState.team2Score}-${footballMatchState.team1Score}`;
            } else {
                resultSummary = `Match drawn ${footballMatchState.team1Score}-${footballMatchState.team2Score}`;
            }
            
            document.getElementById('match-winner').textContent = winner ? winner.name : 'Draw';
            document.getElementById('match-result-summary').textContent = resultSummary;
            
            // Set result details
            document.getElementById('result-team1-name').textContent = currentMatchState.team1.name;
            document.getElementById('result-team2-name').textContent = currentMatchState.team2.name;
            
            document.getElementById('result-team1-score').textContent = `${footballMatchState.team1Score}`;
            document.getElementById('result-team2-score').textContent = `${footballMatchState.team2Score}`;
            
            showSection('winner-announcement');
            document.querySelector('.nav-item[data-section="winner-announcement"]').classList.add('active');
        }
        
        // Set up team selection clicks
        function setupTeamSelectionEvents() {
            document.getElementById('teams-selection').addEventListener('click', function(e) {
                const teamSelect = e.target.closest('.team-select');
                if (!teamSelect) return;

                const selectedTeams = document.querySelectorAll('.team-select.selected');
                const isSelected = teamSelect.classList.contains('selected');

                if (isSelected) {
                    teamSelect.classList.remove('selected');
                } else {
                    if (selectedTeams.length < 2) {
                        teamSelect.classList.add('selected');
                    } else {
                        alert('You can only select two teams for the match.');
                    }
                }
                
                updateMatchPreview();
                
                const currentSelected = document.querySelectorAll('.team-select.selected');
                const tossWinnerSelect = document.getElementById('toss-winner');
                tossWinnerSelect.innerHTML = '';
                
                if (currentSelected.length > 0) {
                    currentSelected.forEach(teamElement => {
                        const teamId = parseInt(teamElement.getAttribute('data-team-id'));
                        const team = tournamentData.teams.find(t => t.id === teamId);
                        
                        const option = document.createElement('option');
                        option.value = team.id;
                        option.textContent = team.name;
                        tossWinnerSelect.appendChild(option);
                    });
                    
                    updateMatchPreview();
                }
            });
        }
        
        // Set up mobile menu toggle
        function setupMobileMenu() {
            const mobileMenuToggle = document.getElementById('mobileMenuToggle');
            const mainNav = document.querySelector('.main-nav');
            
            if (mobileMenuToggle && mainNav) {
                mobileMenuToggle.addEventListener('click', function() {
                    mainNav.classList.toggle('hidden-on-mobile');
                });
                
                document.addEventListener('click', function(e) {
                    if (window.innerWidth <= 768 && 
                        !e.target.closest('.main-nav') && 
                        !e.target.closest('#mobileMenuToggle') &&
                        !mainNav.classList.contains('hidden-on-mobile')) {
                        mainNav.classList.add('hidden-on-mobile');
                    }
                });
                
                if (window.innerWidth > 768) {
                    mainNav.classList.remove('hidden-on-mobile');
                }
                
                window.addEventListener('resize', function() {
                    if (window.innerWidth > 768) {
                        mainNav.classList.remove('hidden-on-mobile');
                    }
                });
            }
        }
        
        // Set up navigation between sections
        function setupNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            
            navItems.forEach(item => {
                item.addEventListener('click', function() {
                    const sectionId = this.getAttribute('data-section');
                    
                    navItems.forEach(nav => nav.classList.remove('active'));
                    this.classList.add('active');
                    
                    showSection(sectionId);
                    
                    if (sectionId === 'sport-dashboard') {
                        goToStep(1);
                    } else if (sectionId === 'tournament-setup') {
                        goToStep(2);
                    } else if (sectionId === 'live-scoring') {
                        if (currentMatchState.isMatchStarted) {
                            goToStep(5);
                        } else {
                            alert("Please set up and start a match first!");
                            document.querySelector('.nav-item[data-section="tournament-setup"]').click();
                        }
                    } else if (sectionId === 'winner-announcement') {
                        showSection('winner-announcement');
                    }
                });
            });
        }
        
        // Update UI based on selected sport
        function updateSportUI() {
            const sportName = tournamentData.sport.charAt(0).toUpperCase() + tournamentData.sport.slice(1);
            document.getElementById('selected-sport-name').textContent = sportName;
            document.getElementById('setup-title').textContent = `${sportName} Tournament Details`;
            
            // Show/hide sport specific controls
            document.querySelectorAll('.sport-specific-controls').forEach(control => {
                control.classList.remove('active');
            });
            
            if (tournamentData.sport === 'cricket') {
                document.getElementById('cricket-controls').classList.add('active');
            } else if (tournamentData.sport === 'football') {
                document.getElementById('football-controls').classList.add('active');
            } else if (tournamentData.sport === 'custom') {
                document.getElementById('custom-controls').classList.add('active');
            }
        }
        
        // Navigate between steps
        function goToStep(stepNumber) {
            if (stepNumber !== currentStep) {
                previousSteps.push(currentStep);
                currentStep = stepNumber;
            }
            
            updateStepProgress();
            
            if (stepNumber === 1) {
                showSection('sport-dashboard');
            } else if (stepNumber >= 2 && stepNumber <= 4) {
                showSection('tournament-setup');
                
                document.querySelectorAll('.setup-step').forEach(step => {
                    step.classList.remove('active');
                });
                
                if (stepNumber === 2) {
                    document.getElementById('step1').classList.add('active');
                } else if (stepNumber === 3) {
                    document.getElementById('step2').classList.add('active');
                } else if (stepNumber === 4) {
                    document.getElementById('step3').classList.add('active');
                }
            } else if (stepNumber === 5) {
                showSection('live-scoring');
            }
            
            updateNavigation();
        }
        
        // Update navigation
        function updateNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.classList.remove('active');
            });
            
            if (currentStep === 1) {
                document.querySelector('.nav-item[data-section="sport-dashboard"]').classList.add('active');
            } else if (currentStep >= 2 && currentStep <= 4) {
                document.querySelector('.nav-item[data-section="tournament-setup"]').classList.add('active');
            } else if (currentStep === 5) {
                document.querySelector('.nav-item[data-section="live-scoring"]').classList.add('active');
            }
        }
        
        // Show a specific section
        function showSection(sectionId) {
            const dashboardSections = document.querySelectorAll('.dashboard-section');
            dashboardSections.forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
            
            const mainNav = document.querySelector('.main-nav');
            if (window.innerWidth <= 768 && mainNav) {
                mainNav.classList.add('hidden-on-mobile');
            }
            
            if (sectionId === 'sport-dashboard') {
                currentStep = 1;
            } else if (sectionId === 'tournament-setup') {
                currentStep = 2;
            } else if (sectionId === 'live-scoring') {
                currentStep = 5;
                updateCompactLiveScoring();
            }
            
            updateNavigation();
            updateStepProgress();
        }
        
        // Update tournament data from form
        function updateTournamentFromForm() {
            tournamentData.name = document.getElementById('tournament-name').value || 'Champions League T20';
            document.getElementById('tournament-name-display').textContent = tournamentData.name;
            
            // Cricket specific settings
            if (tournamentData.sport === 'cricket') {
                const oversCountSelect = document.getElementById('overs-count');
                const customOversInput = document.getElementById('custom-overs-input');
                const playersPerTeam = document.getElementById('players-per-team');
                
                if (oversCountSelect.value === 'custom' && customOversInput.value) {
                    tournamentData.sportSpecific.oversPerInnings = parseInt(customOversInput.value) || 20;
                } else if (oversCountSelect.value !== 'custom') {
                    tournamentData.sportSpecific.oversPerInnings = parseInt(oversCountSelect.value) || 20;
                }
                
                tournamentData.sportSpecific.playersPerTeam = parseInt(playersPerTeam.value) || 11;
            }
            // Football specific settings
            else if (tournamentData.sport === 'football') {
                tournamentData.sportSpecific.matchDuration = parseInt(document.getElementById('match-duration').value) || 90;
                tournamentData.sportSpecific.halvesDuration = parseInt(document.getElementById('halves-duration').value) || 45;
                tournamentData.sportSpecific.extraTime = parseInt(document.getElementById('extra-time').value) || 30;
                tournamentData.sportSpecific.playersPerTeam = parseInt(document.getElementById('football-players-per-team').value) || 11;
            }
            // Custom sport settings
            else if (tournamentData.sport === 'custom') {
                tournamentData.sportSpecific.customSportName = document.getElementById('custom-sport-name').value || 'Custom Sport';
                tournamentData.sportSpecific.customMatchDuration = parseInt(document.getElementById('custom-match-duration').value) || 40;
                tournamentData.sportSpecific.playersPerTeam = parseInt(document.getElementById('custom-players-per-team').value) || 7;
                
                // Get custom rules
                tournamentData.sportSpecific.customRules = [];
                document.querySelectorAll('#custom-rules-container .rule-item').forEach(item => {
                    const nameInput = item.querySelector('input[type="text"]');
                    const pointsInput = item.querySelector('input[type="number"]');
                    const descriptionInput = item.querySelector('textarea');
                    
                    if (nameInput && pointsInput && descriptionInput) {
                        tournamentData.sportSpecific.customRules.push({
                            name: nameInput.value,
                            points: parseInt(pointsInput.value) || 0,
                            description: descriptionInput.value
                        });
                    }
                });
            }
        }
        
        // Generate teams based on form data
        function generateTeams() {
            const teamCount = parseInt(document.getElementById('team-count').value) || 4;
            const teamsContainer = document.getElementById('teams-container');
            teamsContainer.innerHTML = '';
            
            const teamNameSuggestions = getTeamNameSuggestions();
            let playersPerTeam;
            
            if (tournamentData.sport === 'cricket') {
                playersPerTeam = tournamentData.sportSpecific.playersPerTeam || 11;
            } else if (tournamentData.sport === 'football') {
                playersPerTeam = tournamentData.sportSpecific.playersPerTeam || 11;
            } else if (tournamentData.sport === 'custom') {
                playersPerTeam = tournamentData.sportSpecific.playersPerTeam || 7;
            }
            
            for (let i = 0; i < teamCount; i++) {
                const teamCard = document.createElement('div');
                teamCard.className = 'team-card';
                teamCard.innerHTML = `
                    <div class="team-header">
                        <input type="text" class="team-name-input" value="${teamNameSuggestions[i] || `Team ${i+1}`}" data-team-index="${i}">
                        <div style="color: var(--accent-green);">T${i+1}</div>
                    </div>
                    <ul class="player-list" id="players-team-${i}">
                        <!-- Players will be generated here -->
                    </ul>
                `;
                teamsContainer.appendChild(teamCard);
                
                const playersList = document.getElementById(`players-team-${i}`);
                for (let j = 0; j < playersPerTeam; j++) {
                    const playerItem = document.createElement('li');
                    playerItem.className = 'player-item';
                    playerItem.innerHTML = `
                        <input type="text" class="player-name-input" placeholder="Player ${j+1}" value="Player ${j+1}">
                        <span style="color: var(--text-muted); font-size: 0.85rem;">#${j+1}</span>
                    `;
                    playersList.appendChild(playerItem);
                }
            }
            
            updateTeamsFromUI();
        }
        
        // Get team name suggestions
        function getTeamNameSuggestions() {
            if (tournamentData.sport === 'cricket') {
                return [
                    "Mumbai Indians", "Chennai Super Kings", "Royal Challengers", 
                    "Kolkata Knight Riders", "Delhi Capitals", "Rajasthan Royals",
                    "Sunrisers Hyderabad", "Punjab Kings", "Gujarat Titans",
                    "Lucknow Super Giants"
                ];
            } else if (tournamentData.sport === 'football') {
                return [
                    "Real Madrid", "Barcelona", "Manchester United", 
                    "Liverpool", "Bayern Munich", "Paris Saint-Germain",
                    "Juventus", "AC Milan", "Chelsea", "Arsenal"
                ];
            } else {
                return [
                    "Team Alpha", "Team Beta", "Team Gamma", "Team Delta",
                    "Team Echo", "Team Foxtrot", "Team Golf", "Team Hotel"
                ];
            }
        }
        
        // Update teams data from UI
        function updateTeamsFromUI() {
            tournamentData.teams = [];
            const teamInputs = document.querySelectorAll('.team-name-input');
            
            teamInputs.forEach((input, index) => {
                const team = {
                    id: index + 1,
                    name: input.value || `Team ${index + 1}`,
                    players: []
                };
                
                const playerInputs = document.querySelectorAll(`#players-team-${index} .player-name-input`);
                playerInputs.forEach((playerInput, playerIndex) => {
                    team.players.push({
                        id: playerIndex + 1,
                        name: playerInput.value || `Player ${playerIndex + 1}`,
                        isOut: false,
                        runs: 0,
                        balls: 0,
                        fours: 0,
                        sixes: 0
                    });
                });
                
                tournamentData.teams.push(team);
            });
        }
        
        // Validate teams have names
        function validateTeams() {
            updateTeamsFromUI();
            
            for (const team of tournamentData.teams) {
                if (!team.name.trim()) {
                    alert(`Please enter a name for ${team.name}`);
                    return false;
                }
                
                for (const player of team.players) {
                    if (!player.name.trim()) {
                        alert(`Please enter names for all players in ${team.name}`);
                        return false;
                    }
                }
            }
            
            return true;
        }
        
        // Set up match configuration UI
        function setupMatchConfiguration() {
            updateTeamsFromUI();
            
            const teamsSelection = document.getElementById('teams-selection');
            const tossWinnerSelect = document.getElementById('toss-winner');
            teamsSelection.innerHTML = '';
            tossWinnerSelect.innerHTML = '';
            
            // Show/hide sport-specific setup
            if (tournamentData.sport === 'football') {
                document.getElementById('football-match-setup').style.display = 'block';
                document.getElementById('cricket-match-setup').style.display = 'none';
            } else {
                document.getElementById('football-match-setup').style.display = 'none';
                document.getElementById('cricket-match-setup').style.display = 'block';
            }
            
            tournamentData.teams.forEach((team, index) => {
                const teamSelect = document.createElement('div');
                teamSelect.className = 'team-select';
                teamSelect.setAttribute('data-team-id', team.id);
                teamSelect.innerHTML = `
                    <div class="team-select-icon">T${team.id}</div>
                    <div>
                        <div style="font-weight: bold;">${team.name}</div>
                        <div style="font-size: 0.85rem; color: var(--text-muted);">${team.players.length} players</div>
                    </div>
                `;
                
                teamsSelection.appendChild(teamSelect);
                
                const option = document.createElement('option');
                option.value = team.id;
                option.textContent = team.name;
                tossWinnerSelect.appendChild(option);
            });
            
            if (tournamentData.teams.length >= 2) {
                setTimeout(() => {
                    const teamSelects = document.querySelectorAll('.team-select');
                    if (teamSelects.length >= 2) {
                        teamSelects[0].classList.add('selected');
                        teamSelects[1].classList.add('selected');
                        tossWinnerSelect.innerHTML = '';
                        [...document.querySelectorAll('.team-select.selected')].forEach(teamElement => {
                             const teamId = parseInt(teamElement.getAttribute('data-team-id'));
                             const team = tournamentData.teams.find(t => t.id === teamId);
                             const option = document.createElement('option');
                             option.value = team.id;
                             option.textContent = team.name;
                             tossWinnerSelect.appendChild(option);
                        });
                        updateMatchPreview();
                    }
                }, 100);
            }
        }
        
        // Update match preview based on selections
        function updateMatchPreview() {
            const selectedTeams = document.querySelectorAll('.team-select.selected');
            
            if (selectedTeams.length !== 2) {
                document.getElementById('preview-team1').textContent = 'T?';
                document.getElementById('preview-team1-name').textContent = 'Team 1';
                document.getElementById('preview-team2').textContent = 'T?';
                document.getElementById('preview-team2-name').textContent = 'Team 2';
                document.getElementById('preview-toss').textContent = 'Select 2 teams and decide toss';
                return;
            }
            
            const team1Id = parseInt(selectedTeams[0].getAttribute('data-team-id'));
            const team2Id = parseInt(selectedTeams[1].getAttribute('data-team-id'));
            
            const team1 = tournamentData.teams.find(t => t.id === team1Id);
            const team2 = tournamentData.teams.find(t => t.id === team2Id);
            
            if (!team1 || !team2) return;
            
            document.getElementById('preview-team1').textContent = `T${team1.id}`;
            document.getElementById('preview-team1-name').textContent = team1.name;
            document.getElementById('preview-team2').textContent = `T${team2.id}`;
            document.getElementById('preview-team2-name').textContent = team2.name;
            
            let formatText = '';
            if (tournamentData.sport === 'cricket') {
                formatText = `${tournamentData.sportSpecific.oversPerInnings} overs per innings`;
                
                const tossWinnerSelect = document.getElementById('toss-winner');
                const tossWinnerId = parseInt(tossWinnerSelect.value);
                const tossDecision = document.getElementById('toss-decision').value;
                const tossWinner = tournamentData.teams.find(t => t.id === tossWinnerId);
                
                if (tossWinner) {
                    const tossText = `${tossWinner.name} won toss and chose to ${tossDecision === 'bat' ? 'bat first' : 'bowl first'}`;
                    document.getElementById('preview-toss').textContent = tossText;
                } else {
                    document.getElementById('preview-toss').textContent = 'Select toss winner';
                }
            } else if (tournamentData.sport === 'football') {
                formatText = `${tournamentData.sportSpecific.matchDuration} minutes (${tournamentData.sportSpecific.halvesDuration}+${tournamentData.sportSpecific.halvesDuration})`;
                document.getElementById('preview-toss').textContent = 'Football match';
            } else if (tournamentData.sport === 'custom') {
                formatText = `${tournamentData.sportSpecific.customMatchDuration} minutes`;
                document.getElementById('preview-toss').textContent = `${tournamentData.sportSpecific.customSportName} match`;
            }
            
            document.getElementById('preview-format-value').textContent = formatText;
        }
        
        // Set up the match based on selections
        function setupMatch() {
            const selectedTeams = document.querySelectorAll('.team-select.selected');
            
            if (selectedTeams.length !== 2) {
                alert('Please select two teams for the match');
                return false;
            }
            
            const team1Id = parseInt(selectedTeams[0].getAttribute('data-team-id'));
            const team2Id = parseInt(selectedTeams[1].getAttribute('data-team-id'));
            
            const team1 = tournamentData.teams.find(t => t.id === team1Id);
            const team2 = tournamentData.teams.find(t => t.id === team2Id);
            
            if (!team1 || !team2) {
                alert('Selected teams not found');
                return false;
            }
            
            currentMatchState.team1 = team1;
            currentMatchState.team2 = team2;
            currentMatchState.innings = 1;
            currentMatchState.isMatchStarted = true;
            currentMatchState.actionHistory = [];
            currentMatchState.singleBatterMode = false;
            currentMatchState.currentBatterMode = 'double';
            
            // Set up based on sport
            if (tournamentData.sport === 'cricket') {
                setupCricketMatch(team1, team2);
            } else if (tournamentData.sport === 'football') {
                setupFootballMatch(team1, team2);
            } else if (tournamentData.sport === 'custom') {
                setupCustomSportMatch(team1, team2);
            }
            
            return true;
        }
        
        // Set up cricket match
        function setupCricketMatch(team1, team2) {
            const tossWinnerId = parseInt(document.getElementById('toss-winner').value);
            const tossDecision = document.getElementById('toss-decision').value;
            
            let battingTeam, bowlingTeam;
            
            if (tossDecision === 'bat') {
                battingTeam = tournamentData.teams.find(t => t.id === tossWinnerId);
                bowlingTeam = battingTeam.id === team1.id ? team2 : team1;
            } else {
                bowlingTeam = tournamentData.teams.find(t => t.id === tossWinnerId);
                battingTeam = bowlingTeam.id === team1.id ? team2 : team1;
            }
            
            cricketMatchState = {
                battingTeam: battingTeam,
                bowlingTeam: bowlingTeam,
                currentOver: 0,
                ballsInOver: 0,
                totalRuns: 0,
                wickets: 0,
                extras: 0,
                overs: [],
                currentOverBalls: [],
                isFirstInningsComplete: false,
                target: 0,
                legalBallsThisOver: 0,
                
                striker: null,
                nonStriker: null,
                currentBowler: null,
                previousBowler: null,
                
                battingTeamPlayers: [...battingTeam.players],
                bowlingTeamPlayers: [...bowlingTeam.players],
                availableBatsmen: [...battingTeam.players],
                availableBowlers: [...bowlingTeam.players],
                usedBowlersThisOver: [],
                
                playerStats: {},
                wicketsFallen: [],
                
                team1Stats: {
                    runs: 0,
                    wickets: 0,
                    overs: 0,
                    extras: 0,
                    runRate: 0
                },
                team2Stats: {
                    runs: 0,
                    wickets: 0,
                    overs: 0,
                    extras: 0,
                    runRate: 0
                }
            };
            
            // Initialize player stats
            initializePlayerStats();
            
            // Set initial striker and non-striker
            if (cricketMatchState.availableBatsmen.length >= 2) {
                cricketMatchState.striker = cricketMatchState.availableBatsmen[0];
                cricketMatchState.nonStriker = cricketMatchState.availableBatsmen[1];
                
                // Remove from available batsmen
                cricketMatchState.availableBatsmen = cricketMatchState.availableBatsmen.filter(
                    p => p.id !== cricketMatchState.striker.id && p.id !== cricketMatchState.nonStriker.id
                );
            }
            
            // Set initial bowler
            if (cricketMatchState.availableBowlers.length > 0) {
                cricketMatchState.currentBowler = cricketMatchState.availableBowlers[0];
                cricketMatchState.usedBowlersThisOver.push(cricketMatchState.currentBowler.id);
            }
            
            // Initialize team stats
            updateTeamStats();
        }
        
        // Set up football match
        function setupFootballMatch(team1, team2) {
            footballMatchState = {
                team1Score: 0,
                team2Score: 0,
                team1YellowCards: 0,
                team2YellowCards: 0,
                team1RedCards: 0,
                team2RedCards: 0,
                team1Corners: 0,
                team2Corners: 0,
                team1Fouls: 0,
                team2Fouls: 0,
                currentTime: 0,
                currentHalf: 1,
                isTimerRunning: false,
                timerInterval: null,
                
                playerStats: {},
                goalScorers: [],
                cardEvents: []
            };
        }
        
        // Set up custom sport match
        function setupCustomSportMatch(team1, team2) {
            customSportMatchState = {
                team1Score: 0,
                team2Score: 0,
                team1Stats: {},
                team2Stats: {},
                currentTime: 0,
                isTimerRunning: false,
                timerInterval: null,
                
                playerStats: {},
                events: []
            };
            
            // Setup custom scoring controls
            setupCustomScoringControls();
        }
        
        // Setup custom scoring controls
        function setupCustomScoringControls() {
            const customControls = document.getElementById('custom-scoring-controls');
            if (!customControls) return;
            
            customControls.innerHTML = '';
            
            if (tournamentData.sportSpecific.customRules && tournamentData.sportSpecific.customRules.length > 0) {
                const controlsGrid = document.createElement('div');
                controlsGrid.className = 'runs-controls-grid';
                
                tournamentData.sportSpecific.customRules.forEach(rule => {
                    const ruleBtn = document.createElement('div');
                    ruleBtn.className = 'scoring-btn run-1';
                    ruleBtn.innerHTML = `${rule.name} (+${rule.points})`;
                    ruleBtn.title = rule.description;
                    ruleBtn.addEventListener('click', function() {
                        // Add points to team 1
                        customSportMatchState.team1Score += rule.points;
                        updateCustomSportScoring();
                        showNotification(`${rule.name} for ${currentMatchState.team1.name}`, 'success');
                    });
                    
                    const ruleBtn2 = document.createElement('div');
                    ruleBtn2.className = 'scoring-btn run-1';
                    ruleBtn2.innerHTML = `${rule.name} (+${rule.points})`;
                    ruleBtn2.title = rule.description;
                    ruleBtn2.addEventListener('click', function() {
                        // Add points to team 2
                        customSportMatchState.team2Score += rule.points;
                        updateCustomSportScoring();
                        showNotification(`${rule.name} for ${currentMatchState.team2.name}`, 'success');
                    });
                    
                    controlsGrid.appendChild(ruleBtn);
                    controlsGrid.appendChild(ruleBtn2);
                });
                
                customControls.appendChild(controlsGrid);
            } else {
                customControls.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--text-muted);">No scoring rules defined</div>';
            }
        }
        
        // Update custom sport scoring display
        function updateCustomSportScoring() {
            const teamsRow = document.getElementById('custom-teams-score-row');
            if (!teamsRow || !currentMatchState.team1 || !currentMatchState.team2) return;
            
            teamsRow.innerHTML = '';
            
            // Team 1
            const team1Div = document.createElement('div');
            team1Div.className = 'custom-team-score';
            team1Div.innerHTML = `
                <div class="custom-team-name">${currentMatchState.team1.name}</div>
                <div class="custom-team-points">${customSportMatchState.team1Score}</div>
            `;
            
            // Team 2
            const team2Div = document.createElement('div');
            team2Div.className = 'custom-team-score';
            team2Div.innerHTML = `
                <div class="custom-team-name">${currentMatchState.team2.name}</div>
                <div class="custom-team-points">${customSportMatchState.team2Score}</div>
            `;
            
            teamsRow.appendChild(team1Div);
            teamsRow.appendChild(team2Div);
        }
        
        // End custom sport match
        function endCustomSportMatch() {
            let winner = null;
            let resultSummary = '';
            
            if (customSportMatchState.team1Score > customSportMatchState.team2Score) {
                winner = currentMatchState.team1;
                resultSummary = `${winner.name} won ${customSportMatchState.team1Score}-${customSportMatchState.team2Score}`;
            } else if (customSportMatchState.team2Score > customSportMatchState.team1Score) {
                winner = currentMatchState.team2;
                resultSummary = `${winner.name} won ${customSportMatchState.team2Score}-${customSportMatchState.team1Score}`;
            } else {
                resultSummary = `Match drawn ${customSportMatchState.team1Score}-${customSportMatchState.team2Score}`;
            }
            
            document.getElementById('match-winner').textContent = winner ? winner.name : 'Draw';
            document.getElementById('match-result-summary').textContent = resultSummary;
            
            // Set result details
            document.getElementById('result-team1-name').textContent = currentMatchState.team1.name;
            document.getElementById('result-team2-name').textContent = currentMatchState.team2.name;
            
            document.getElementById('result-team1-score').textContent = `${customSportMatchState.team1Score}`;
            document.getElementById('result-team2-score').textContent = `${customSportMatchState.team2Score}`;
            
            showSection('winner-announcement');
            document.querySelector('.nav-item[data-section="winner-announcement"]').classList.add('active');
        }
        
        // Initialize player stats
        function initializePlayerStats() {
            cricketMatchState.playerStats = {};
            
            // Initialize batting team players
            cricketMatchState.battingTeam.players.forEach(player => {
                cricketMatchState.playerStats[player.id] = {
                    playerId: player.id,
                    name: player.name,
                    teamId: cricketMatchState.battingTeam.id,
                    runs: 0,
                    balls: 0,
                    fours: 0,
                    sixes: 0,
                    isOut: false,
                    howOut: null,
                    bowler: null
                };
            });
            
            // Initialize bowling team players
            cricketMatchState.bowlingTeam.players.forEach(player => {
                cricketMatchState.playerStats[player.id] = {
                    ...cricketMatchState.playerStats[player.id],
                    playerId: player.id,
                    name: player.name,
                    teamId: cricketMatchState.bowlingTeam.id,
                    overs: 0,
                    ballsBowled: 0,
                    runsConceded: 0,
                    wickets: 0,
                    maidens: 0,
                    wides: 0,
                    noBalls: 0
                };
            });
        }
        
        // Start the match
        function startMatch() {
            // Update tournament name
            document.getElementById('tournament-title-compact').textContent = tournamentData.name;
            document.getElementById('match-format-display').textContent = 
                `${tournamentData.sportSpecific.oversPerInnings} Overs  T20`;
            
            // Show correct scoring interface based on sport
            document.getElementById('cricket-scoring-compact').style.display = tournamentData.sport === 'cricket' ? 'block' : 'none';
            document.getElementById('football-scoring-compact').style.display = tournamentData.sport === 'football' ? 'block' : 'none';
            document.getElementById('custom-scoring-compact').style.display = tournamentData.sport === 'custom' ? 'block' : 'none';
            
            // Update sport title
            if (tournamentData.sport === 'custom') {
                document.getElementById('custom-sport-title-display').textContent = tournamentData.sportSpecific.customSportName.toUpperCase();
                document.getElementById('custom-format-display').textContent = `${tournamentData.sportSpecific.customMatchDuration} mins`;
                document.getElementById('custom-sport-controls-title').textContent = `${tournamentData.sportSpecific.customSportName.toUpperCase()} SCORING`;
            }
            
            // Update compact live scoring display
            updateCompactLiveScoring();
            
            // Initialize based on sport
            if (tournamentData.sport === 'cricket') {
                showNotification("Match started! " + cricketMatchState.battingTeam.name + " is batting first.", 'success');
            } else if (tournamentData.sport === 'football') {
                updateFootballScoring();
                showNotification("Football match started! " + currentMatchState.team1.name + " vs " + currentMatchState.team2.name, 'success');
            } else if (tournamentData.sport === 'custom') {
                updateCustomSportScoring();
                showNotification(`${tournamentData.sportSpecific.customSportName} match started!`, 'success');
            }
        }
        
        // Update compact live scoring display - REDESIGNED
        function updateCompactLiveScoring() {
            if (tournamentData.sport === 'cricket') {
                if (!cricketMatchState.battingTeam || !cricketMatchState.bowlingTeam) return;
                
                // Update team names
                document.getElementById('team1-name-display').textContent = currentMatchState.team1?.name || 'Team 1';
                document.getElementById('team2-name-display').textContent = currentMatchState.team2?.name || 'Team 2';
                
                // Calculate which team is batting
                const isTeam1Batting = cricketMatchState.battingTeam?.id === currentMatchState.team1?.id;
                
                // Update batting team indicator
                document.getElementById('team1-score-card').classList.toggle('batting', isTeam1Batting);
                document.getElementById('team2-score-card').classList.toggle('batting', !isTeam1Batting);
                
                // Update scores based on which team is batting
                if (isTeam1Batting) {
                    // Team 1 batting
                    document.getElementById('team1-runs').textContent = cricketMatchState.totalRuns;
                    document.getElementById('team1-wickets').textContent = `/${cricketMatchState.wickets}`;
                    document.getElementById('team1-overs').textContent = `${cricketMatchState.currentOver}.${cricketMatchState.ballsInOver}`;
                    
                    // Team 2 bowling - show target in second innings
                    if (currentMatchState.innings === 2) {
                        document.getElementById('team2-runs').textContent = cricketMatchState.target - 1;
                        document.getElementById('team2-wickets').textContent = '/0';
                        document.getElementById('team2-overs').textContent = `${tournamentData.sportSpecific.oversPerInnings}.0`;
                    } else {
                        document.getElementById('team2-runs').textContent = '0';
                        document.getElementById('team2-wickets').textContent = '/0';
                        document.getElementById('team2-overs').textContent = '0.0';
                    }
                } else {
                    // Team 2 batting
                    document.getElementById('team2-runs').textContent = cricketMatchState.totalRuns;
                    document.getElementById('team2-wickets').textContent = `/${cricketMatchState.wickets}`;
                    document.getElementById('team2-overs').textContent = `${cricketMatchState.currentOver}.${cricketMatchState.ballsInOver}`;
                    
                    // Team 1 bowling - show target in second innings
                    if (currentMatchState.innings === 2) {
                        document.getElementById('team1-runs').textContent = cricketMatchState.target - 1;
                        document.getElementById('team1-wickets').textContent = '/0';
                        document.getElementById('team1-overs').textContent = `${tournamentData.sportSpecific.oversPerInnings}.0`;
                    } else {
                        document.getElementById('team1-runs').textContent = '0';
                        document.getElementById('team1-wickets').textContent = '/0';
                        document.getElementById('team1-overs').textContent = '0.0';
                    }
                }
                
                // Update match status
                updateMatchStatus();
                
                // Update player statistics tables
                updateBattingStatsTable();
                updateBowlingStatsTable();
            }
        }
        
        // Update match status display
        function updateMatchStatus() {
            const statusElement = document.getElementById('match-status-requirement');
            if (!statusElement) return;
            
            if (currentMatchState.innings === 1) {
                // First innings
                const oversLeft = tournamentData.sportSpecific.oversPerInnings - 
                    (cricketMatchState.currentOver + cricketMatchState.ballsInOver / 6);
                const wicketsLeft = 10 - cricketMatchState.wickets;
                
                statusElement.innerHTML = `${cricketMatchState.battingTeam.name}  ${cricketMatchState.totalRuns}/${cricketMatchState.wickets} in ${cricketMatchState.currentOver}.${cricketMatchState.ballsInOver} overs  ${oversLeft.toFixed(1)} overs, ${wicketsLeft} wickets remaining`;
            } else if (currentMatchState.innings === 2 && cricketMatchState.target > 0) {
                // Second innings
                const runsNeeded = cricketMatchState.target - cricketMatchState.totalRuns;
                const ballsLeft = (tournamentData.sportSpecific.oversPerInnings * 6) - 
                    ((cricketMatchState.currentOver * 6) + cricketMatchState.ballsInOver);
                const oversLeft = (ballsLeft / 6).toFixed(1);
                
                if (runsNeeded <= 0) {
                    statusElement.innerHTML = `${cricketMatchState.battingTeam.name} WON!`;
                } else if (cricketMatchState.wickets >= 10) {
                    statusElement.innerHTML = `${cricketMatchState.bowlingTeam.name} WON!`;
                } else {
                    statusElement.innerHTML = `${cricketMatchState.battingTeam.name} need ${runsNeeded} runs in ${oversLeft} overs (${ballsLeft} balls)`;
                }
            }
        }
        
        // Update batting statistics table
        function updateBattingStatsTable() {
            const battingBody = document.getElementById('batting-stats-body');
            if (!battingBody) return;
            
            battingBody.innerHTML = '';
            
            // Get batting team players with stats
            if (cricketMatchState.battingTeam) {
                const battingTeamId = cricketMatchState.battingTeam.id;
                const battingPlayers = Object.values(cricketMatchState.playerStats)
                    .filter(p => p.teamId === battingTeamId && (p.runs > 0 || p.balls > 0 || p.isOut));
                
                // Sort by runs (descending)
                battingPlayers.sort((a, b) => b.runs - a.runs);
                
                battingPlayers.forEach(player => {
                    const tr = document.createElement('tr');
                    
                    // Check if this player is the striker or non-striker
                    const isStriker = cricketMatchState.striker && cricketMatchState.striker.id === player.playerId;
                    const isNonStriker = cricketMatchState.nonStriker && cricketMatchState.nonStriker.id === player.playerId;
                    
                    let playerNameHtml = player.name;
                    if (isStriker) {
                        playerNameHtml = `<span class="striker-indicator"></span> ${player.name}*`;
                    } else if (!player.isOut && (isNonStriker || player.balls > 0)) {
                        playerNameHtml = `${player.name}*`;
                    }
                    
                    const strikeRate = player.balls > 0 ? ((player.runs / player.balls) * 100).toFixed(2) : '0.00';
                    
                    tr.innerHTML = `
                        <td class="player-name-cell">${playerNameHtml}</td>
                        <td>${player.runs}</td>
                        <td>${player.balls}</td>
                        <td>${player.fours || 0}</td>
                        <td>${player.sixes || 0}</td>
                        <td class="player-stats-value">${strikeRate}</td>
                    `;
                    
                    battingBody.appendChild(tr);
                });
            }
        }
        
        // Update bowling statistics table
        function updateBowlingStatsTable() {
            const bowlingBody = document.getElementById('bowling-stats-body');
            if (!bowlingBody) return;
            
            bowlingBody.innerHTML = '';
            
            // Get bowling team players with stats
            if (cricketMatchState.bowlingTeam) {
                const bowlingTeamId = cricketMatchState.bowlingTeam.id;
                const bowlingPlayers = Object.values(cricketMatchState.playerStats)
                    .filter(p => p.teamId === bowlingTeamId && (p.ballsBowled > 0 || p.wickets > 0));
                
                // Sort by wickets (descending)
                bowlingPlayers.sort((a, b) => b.wickets - a.wickets);
                
                bowlingPlayers.forEach(player => {
                    const tr = document.createElement('tr');
                    
                    // Calculate overs
                    const overs = player.ballsBowled ? 
                        (Math.floor(player.ballsBowled / 6) + (player.ballsBowled % 6) / 10).toFixed(1) : '0.0';
                    
                    // Calculate economy
                    const oversValue = player.ballsBowled ? player.ballsBowled / 6 : 0;
                    const economy = oversValue > 0 ? (player.runsConceded / oversValue).toFixed(2) : '0.00';
                    
                    tr.innerHTML = `
                        <td class="player-name-cell">${player.name}</td>
                        <td>${overs}</td>
                        <td>${player.runsConceded || 0}</td>
                        <td>${player.wickets || 0}</td>
                        <td>${player.maidens || 0}</td>
                        <td class="player-stats-value">${economy}</td>
                    `;
                    
                    bowlingBody.appendChild(tr);
                });
            }
        }
        
        // Update team statistics
        function updateTeamStats() {
            // Calculate run rates
            const battingOvers = cricketMatchState.currentOver + (cricketMatchState.ballsInOver / 6);
            cricketMatchState.team1Stats.runs = cricketMatchState.battingTeam.id === currentMatchState.team1?.id ? 
                cricketMatchState.totalRuns : 
                (currentMatchState.innings === 2 && cricketMatchState.target > 0 ? cricketMatchState.target - 1 : 0);
            
            cricketMatchState.team1Stats.wickets = cricketMatchState.battingTeam.id === currentMatchState.team1?.id ? 
                cricketMatchState.wickets : 0;
            
            cricketMatchState.team1Stats.overs = cricketMatchState.battingTeam.id === currentMatchState.team1?.id ? 
                battingOvers : 
                (currentMatchState.innings === 2 ? tournamentData.sportSpecific.oversPerInnings : 0);
            
            cricketMatchState.team1Stats.runRate = cricketMatchState.team1Stats.overs > 0 ? 
                (cricketMatchState.team1Stats.runs / cricketMatchState.team1Stats.overs).toFixed(2) : '0.00';
            
            cricketMatchState.team2Stats.runs = cricketMatchState.battingTeam.id === currentMatchState.team2?.id ? 
                cricketMatchState.totalRuns : 
                (currentMatchState.innings === 2 && cricketMatchState.target > 0 ? cricketMatchState.target - 1 : 0);
            
            cricketMatchState.team2Stats.wickets = cricketMatchState.battingTeam.id === currentMatchState.team2?.id ? 
                cricketMatchState.wickets : 0;
            
            cricketMatchState.team2Stats.overs = cricketMatchState.battingTeam.id === currentMatchState.team2?.id ? 
                battingOvers : 
                (currentMatchState.innings === 2 ? tournamentData.sportSpecific.oversPerInnings : 0);
            
            cricketMatchState.team2Stats.runRate = cricketMatchState.team2Stats.overs > 0 ? 
                (cricketMatchState.team2Stats.runs / cricketMatchState.team2Stats.overs).toFixed(2) : '0.00';
        }
        
        // CRICKET FUNCTIONS
        
        // Add runs in cricket
        function addCricketRun(runs) {
            // Store action for undo
            const action = {
                type: 'cricket',
                timestamp: new Date().getTime(),
                cricketState: JSON.parse(JSON.stringify(cricketMatchState)),
                matchState: JSON.parse(JSON.stringify(currentMatchState))
            };
            
            cricketMatchState.totalRuns += runs;
            cricketMatchState.legalBallsThisOver++;
            
            cricketMatchState.currentOverBalls.push(runs);
            
            cricketMatchState.ballsInOver = cricketMatchState.legalBallsThisOver;
            
            // Update striker's stats
            if (cricketMatchState.striker) {
                const playerStat = cricketMatchState.playerStats[cricketMatchState.striker.id];
                if (playerStat) {
                    playerStat.runs += runs;
                    playerStat.balls++;
                    
                    if (runs === 4) {
                        playerStat.fours = (playerStat.fours || 0) + 1;
                    } else if (runs === 6) {
                        playerStat.sixes = (playerStat.sixes || 0) + 1;
                    }
                }
            }
            
            // Update bowler's stats
            if (cricketMatchState.currentBowler) {
                const bowlerStat = cricketMatchState.playerStats[cricketMatchState.currentBowler.id];
                if (bowlerStat) {
                    bowlerStat.ballsBowled = (bowlerStat.ballsBowled || 0) + 1;
                    bowlerStat.runsConceded = (bowlerStat.runsConceded || 0) + runs;
                    
                    if (bowlerStat.ballsBowled % 6 === 0) {
                        bowlerStat.overs = (bowlerStat.overs || 0) + 1;
                    }
                }
            }
            
            // Check if over is complete
            if (cricketMatchState.legalBallsThisOver >= 6) {
                endOver();
            } else {
                // Handle strike change for odd runs
                if (runs % 2 !== 0) {
                    swapBatsmen();
                }
            }
            
            // Add to history
            currentMatchState.actionHistory.push(action);
        }
        
        // Add wicket in cricket
        function addCricketWicket() {
            // Store action for undo
            const action = {
                type: 'cricket',
                timestamp: new Date().getTime(),
                cricketState: JSON.parse(JSON.stringify(cricketMatchState)),
                matchState: JSON.parse(JSON.stringify(currentMatchState))
            };
            
            cricketMatchState.wickets += 1;
            cricketMatchState.legalBallsThisOver++;
            
            cricketMatchState.currentOverBalls.push('W');
            
            cricketMatchState.ballsInOver = cricketMatchState.legalBallsThisOver;
            
            // Mark current striker as out
            if (cricketMatchState.striker) {
                const playerStat = cricketMatchState.playerStats[cricketMatchState.striker.id];
                if (playerStat) {
                    playerStat.isOut = true;
                    playerStat.howOut = 'b';
                    playerStat.bowler = cricketMatchState.currentBowler ? cricketMatchState.currentBowler.name : null;
                }
                
                // Add to available batsmen list (will be used for new batsman)
                if (cricketMatchState.availableBatsmen) {
                    // Already removed from available batsmen when they came in
                }
            }
            
            // Update bowler's stats
            if (cricketMatchState.currentBowler) {
                const bowlerStat = cricketMatchState.playerStats[cricketMatchState.currentBowler.id];
                if (bowlerStat) {
                    bowlerStat.ballsBowled = (bowlerStat.ballsBowled || 0) + 1;
                    bowlerStat.wickets = (bowlerStat.wickets || 0) + 1;
                    
                    if (bowlerStat.ballsBowled % 6 === 0) {
                        bowlerStat.overs = (bowlerStat.overs || 0) + 1;
                    }
                }
            }
            
            cricketMatchState.wicketsFallen.push({
                player: cricketMatchState.striker,
                score: cricketMatchState.totalRuns,
                over: cricketMatchState.currentOver + (cricketMatchState.ballsInOver / 6)
            });
            
            // Check if over is complete
            if (cricketMatchState.legalBallsThisOver >= 6) {
                endOver();
            }
            
            // Automatically open player selection for new batsman
            setTimeout(() => {
                openPlayerSelectionModal('newBatsman');
            }, 500);
            
            // Add to history
            currentMatchState.actionHistory.push(action);
        }
        
        // End over - Automatically change bowler
        function endOver() {
            cricketMatchState.overs.push([...cricketMatchState.currentOverBalls]);
            cricketMatchState.currentOver++;
            cricketMatchState.currentOverBalls = [];
            cricketMatchState.legalBallsThisOver = 0;
            cricketMatchState.ballsInOver = 0;
            cricketMatchState.usedBowlersThisOver = [];
            
            // Swap batsmen at the end of over
            swapBatsmen();
            
            // Store previous bowler
            cricketMatchState.previousBowler = cricketMatchState.currentBowler;
            
            // Automatically open bowler selection modal
            setTimeout(() => {
                openPlayerSelectionModal('bowler');
                showBowlerChangeNotification();
            }, 500);
        }
        
        // Show bowler change notification
        function showBowlerChangeNotification() {
            const notification = document.createElement('div');
            notification.className = 'bowler-change-notification';
            notification.textContent = 'Over Complete! Select Next Bowler';
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        // Add extra in cricket
        function addCricketExtra(extraType, extraRuns = 0) {
            let runs = 0;
            let symbol = '';
            let isLegalBall = false;
            
            switch(extraType) {
                case 'wide':
                    symbol = 'Wd';
                    runs = 1;
                    break;
                case 'noball':
                    symbol = 'Nb';
                    runs = 1 + extraRuns;
                    break;
                case 'bye':
                    symbol = 'B';
                    runs = extraRuns || 1;
                    isLegalBall = true;
                    break;
                case 'legbye':
                    symbol = 'Lb';
                    runs = extraRuns || 1;
                    isLegalBall = true;
                    break;
            }
            
            cricketMatchState.extras += runs;
            cricketMatchState.totalRuns += runs;
            
            if (isLegalBall) {
                cricketMatchState.legalBallsThisOver++;
            }
            
            cricketMatchState.currentOverBalls.push(symbol);
            
            if (isLegalBall) {
                cricketMatchState.ballsInOver = cricketMatchState.legalBallsThisOver;
                
                if (cricketMatchState.legalBallsThisOver >= 6) {
                    endOver();
                }
            }
            
            // Update bowler's stats for extras
            if (cricketMatchState.currentBowler) {
                const bowlerStat = cricketMatchState.playerStats[cricketMatchState.currentBowler.id];
                if (bowlerStat) {
                    bowlerStat.runsConceded = (bowlerStat.runsConceded || 0) + runs;
                    
                    if (extraType === 'wide') {
                        bowlerStat.wides = (bowlerStat.wides || 0) + 1;
                    } else if (extraType === 'noball') {
                        bowlerStat.noBalls = (bowlerStat.noBalls || 0) + 1;
                    }
                }
            }
        }
        
        // Update after a ball is bowled
        function updateAfterBall() {
            // Update team stats
            updateTeamStats();
            
            // Update compact live scoring display
            updateCompactLiveScoring();
            
            // Check if innings is complete
            if (cricketMatchState.wickets >= 10 || 
                (currentMatchState.innings === 1 && cricketMatchState.currentOver >= tournamentData.sportSpecific.oversPerInnings) ||
                (currentMatchState.innings === 2 && cricketMatchState.totalRuns >= cricketMatchState.target)) {
                if (currentMatchState.innings === 1) {
                    endFirstInnings();
                } else {
                    endMatch();
                }
            }
        }
        
        // Update player stats after each ball (legacy function, now integrated directly)
        function updatePlayerStatsAfterBall() {
            // This is now handled in addCricketRun and addCricketWicket
        }
        
        // Swap batsmen
        function swapBatsmen() {
            if (cricketMatchState.striker && cricketMatchState.nonStriker) {
                const temp = cricketMatchState.striker;
                cricketMatchState.striker = cricketMatchState.nonStriker;
                cricketMatchState.nonStriker = temp;
                
                updateCompactLiveScoring();
                showNotification('Batsmen swapped');
            }
        }
        
        // Open player selection modal - Enhanced for bowler selection
        function openPlayerSelectionModal(type) {
            playerSelectionState.type = type;
            
            let title = '';
            let description = '';
            let players = [];
            
            switch(type) {
                case 'striker':
                    title = 'Select New Striker';
                    description = 'Select a player to be the new striker:';
                    players = cricketMatchState.availableBatsmen?.filter(p => 
                        p.id !== cricketMatchState.nonStriker?.id && 
                        !cricketMatchState.playerStats[p.id]?.isOut
                    ) || [];
                    break;
                    
                case 'nonStriker':
                    title = 'Select New Non-Striker';
                    description = 'Select a player to be the new non-striker:';
                    players = cricketMatchState.availableBatsmen?.filter(p => 
                        p.id !== cricketMatchState.striker?.id && 
                        !cricketMatchState.playerStats[p.id]?.isOut
                    ) || [];
                    break;
                    
                case 'bowler':
                    title = 'Select Next Bowler';
                    description = 'Select a player to bowl the next over:';
                    // Filter out bowlers already used in this over
                    players = cricketMatchState.availableBowlers?.filter(p => 
                        !cricketMatchState.usedBowlersThisOver?.includes(p.id)
                    ) || [];
                    break;
                    
                case 'newBatsman':
                    title = 'Select New Batsman';
                    description = 'Select a player to replace the dismissed batsman:';
                    players = cricketMatchState.availableBatsmen?.filter(p => 
                        !cricketMatchState.playerStats[p.id]?.isOut
                    ) || [];
                    break;
            }
            
            if (players.length === 0) {
                if (type === 'bowler') {
                    // If no new bowlers available, allow reusing bowlers
                    players = cricketMatchState.availableBowlers || [];
                    description = 'All bowlers have been used. Select a bowler to continue:';
                } else {
                    showNotification('No available players for this position', 'warning');
                    return;
                }
            }
            
            document.getElementById('playerModalTitle').textContent = title;
            document.getElementById('playerModalDescription').textContent = description;
            
            const playerListModal = document.getElementById('playerListModal');
            playerListModal.innerHTML = '';
            
            players.forEach(player => {
                const playerStat = cricketMatchState.playerStats[player.id];
                const playerItem = document.createElement('div');
                playerItem.className = 'player-item-modal';
                playerItem.dataset.playerId = player.id;
                
                let statsText = '';
                if (playerStat) {
                    if (type === 'bowler') {
                        const overs = playerStat.ballsBowled ? 
                            (Math.floor(playerStat.ballsBowled / 6) + (playerStat.ballsBowled % 6) / 10).toFixed(1) : '0.0';
                        const economy = playerStat.ballsBowled ? 
                            ((playerStat.runsConceded || 0) / (playerStat.ballsBowled / 6)).toFixed(2) : '0.00';
                        statsText = `${overs}-${playerStat.wickets || 0}-${playerStat.runsConceded || 0} (${economy})`;
                    } else {
                        statsText = `${playerStat.runs || 0} runs, ${playerStat.balls || 0} balls`;
                    }
                }
                
                playerItem.innerHTML = `
                    <div class="player-info-modal">
                        <div style="font-weight: 600;">${player.name}</div>
                        <div style="font-size: 0.75rem; color: var(--text-muted);">${player.role || ''}</div>
                    </div>
                    <div class="player-stats-modal">${statsText}</div>
                `;
                
                playerItem.addEventListener('click', function() {
                    document.querySelectorAll('.player-item-modal').forEach(item => {
                        item.classList.remove('selected');
                    });
                    this.classList.add('selected');
                });
                
                playerListModal.appendChild(playerItem);
            });
            
            // Select first player by default
            if (players.length > 0) {
                const firstItem = playerListModal.querySelector('.player-item-modal');
                if (firstItem) {
                    firstItem.classList.add('selected');
                }
            }
            
            document.getElementById('playerModal').classList.add('active');
        }
        
        // Confirm player selection - Enhanced for bowler tracking
        function confirmPlayerSelection() {
            const selectedPlayerItem = document.querySelector('.player-item-modal.selected');
            if (!selectedPlayerItem) {
                showNotification('Please select a player', 'warning');
                return;
            }
            
            const playerId = parseInt(selectedPlayerItem.dataset.playerId);
            let player = null;
            
            // Search in both teams
            if (cricketMatchState.battingTeamPlayers) {
                player = cricketMatchState.battingTeamPlayers.find(p => p.id === playerId);
            }
            if (!player && cricketMatchState.bowlingTeamPlayers) {
                player = cricketMatchState.bowlingTeamPlayers.find(p => p.id === playerId);
            }
            
            if (!player) {
                showNotification('Player not found', 'error');
                return;
            }
            
            switch(playerSelectionState.type) {
                case 'striker':
                    cricketMatchState.striker = player;
                    break;
                    
                case 'nonStriker':
                    cricketMatchState.nonStriker = player;
                    break;
                    
                case 'bowler':
                    cricketMatchState.currentBowler = player;
                    // Add to used bowlers for this over
                    if (!cricketMatchState.usedBowlersThisOver) {
                        cricketMatchState.usedBowlersThisOver = [];
                    }
                    if (!cricketMatchState.usedBowlersThisOver.includes(player.id)) {
                        cricketMatchState.usedBowlersThisOver.push(player.id);
                    }
                    showNotification(`${player.name} will bowl the next over`, 'success');
                    break;
                    
                case 'newBatsman':
                    cricketMatchState.striker = player;
                    // Remove from available batsmen
                    if (cricketMatchState.availableBatsmen) {
                        cricketMatchState.availableBatsmen = cricketMatchState.availableBatsmen.filter(
                            p => p.id !== player.id
                        );
                    }
                    break;
            }
            
            updateCompactLiveScoring();
            document.getElementById('playerModal').classList.remove('active');
            showNotification(`Player ${player.name} selected`, 'success');
        }
        
        // Undo last cricket action
        function undoLastCricketAction() {
            if (currentMatchState.actionHistory.length === 0) {
                showNotification('No actions to undo', 'warning');
                return;
            }
            
            const lastAction = currentMatchState.actionHistory.pop();
            
            if (lastAction.type === 'cricket') {
                cricketMatchState = lastAction.cricketState;
                currentMatchState.isMatchStarted = lastAction.matchState.isMatchStarted;
                currentMatchState.innings = lastAction.matchState.innings;
                
                updateCompactLiveScoring();
                
                showNotification('Undid last action', 'success');
            } else {
                showNotification('Cannot undo this action', 'warning');
            }
        }
        
        // End first innings
        function endFirstInnings() {
            cricketMatchState.isFirstInningsComplete = true;
            cricketMatchState.target = cricketMatchState.totalRuns + 1;
            
            const temp = cricketMatchState.battingTeam;
            cricketMatchState.battingTeam = cricketMatchState.bowlingTeam;
            cricketMatchState.bowlingTeam = temp;
            
            currentMatchState.innings = 2;
            cricketMatchState.currentOver = 0;
            cricketMatchState.ballsInOver = 0;
            cricketMatchState.totalRuns = 0;
            cricketMatchState.wickets = 0;
            cricketMatchState.extras = 0;
            cricketMatchState.overs = [];
            cricketMatchState.currentOverBalls = [];
            cricketMatchState.legalBallsThisOver = 0;
            cricketMatchState.usedBowlersThisOver = [];
            currentMatchState.actionHistory = [];
            
            // Reset player stats for new innings
            initializePlayerStats();
            
            // Set new batting team players
            cricketMatchState.battingTeamPlayers = [...cricketMatchState.battingTeam.players];
            cricketMatchState.bowlingTeamPlayers = [...cricketMatchState.bowlingTeam.players];
            cricketMatchState.availableBatsmen = [...cricketMatchState.battingTeamPlayers];
            cricketMatchState.availableBowlers = [...cricketMatchState.bowlingTeamPlayers];
            
            // Set initial striker and non-striker for second innings
            if (cricketMatchState.availableBatsmen && cricketMatchState.availableBatsmen.length >= 2) {
                cricketMatchState.striker = cricketMatchState.availableBatsmen[0];
                cricketMatchState.nonStriker = cricketMatchState.availableBatsmen[1];
                
                cricketMatchState.availableBatsmen = cricketMatchState.availableBatsmen.filter(
                    p => p.id !== cricketMatchState.striker.id && p.id !== cricketMatchState.nonStriker.id
                );
            }
            
            // Set initial bowler for second innings
            if (cricketMatchState.availableBowlers && cricketMatchState.availableBowlers.length > 0) {
                cricketMatchState.currentBowler = cricketMatchState.availableBowlers[0];
                cricketMatchState.usedBowlersThisOver = [cricketMatchState.currentBowler.id];
            }
            
            // Reset previous bowler
            cricketMatchState.previousBowler = null;
            
            // Update team stats
            updateTeamStats();
            
            // Update compact live scoring display
            updateCompactLiveScoring();
            
            showNotification(`First innings complete! ${cricketMatchState.battingTeam.name} needs ${cricketMatchState.target} runs to win.`, 'success');
        }
        
        // Show scorecard modal
        function showScorecardModal() {
            const scorecardTeams = document.getElementById('scorecardTeams');
            if (!scorecardTeams) return;
            
            scorecardTeams.innerHTML = '';
            
            if (tournamentData.sport === 'cricket') {
                // Get batting and bowling stats
                const battingStats = [];
                const bowlingStats = [];
                
                // Collect stats
                Object.values(cricketMatchState.playerStats || {}).forEach(player => {
                    if (player.runs > 0 || player.balls > 0) {
                        battingStats.push(player);
                    }
                    if (player.wickets > 0 || player.ballsBowled > 0) {
                        bowlingStats.push(player);
                    }
                });
                
                // Team 1 scorecard
                if (currentMatchState.team1) {
                    const team1Card = document.createElement('div');
                    team1Card.className = 'scorecard-team';
                    
                    let team1HTML = `<div class="scorecard-team-name">${currentMatchState.team1.name}</div>`;
                    
                    // Add batting section for Team 1
                    const team1Batting = battingStats.filter(p => p.teamId === currentMatchState.team1.id);
                    if (team1Batting.length > 0) {
                        team1HTML += `<div class="scorecard-section"><div class="scorecard-section-title">Batting</div>`;
                        team1Batting.forEach(player => {
                            const outStatus = player.isOut ? '' : '*';
                            team1HTML += `
                                <div class="scorecard-player-item">
                                    <div class="player-name-scorecard">${player.name}</div>
                                    <div class="player-stats-scorecard">
                                        ${player.runs}${outStatus} (${player.balls}) 
                                        ${player.fours > 0 ? `${player.fours}x4 ` : ''}
                                        ${player.sixes > 0 ? `${player.sixes}x6` : ''}
                                    </div>
                                </div>
                            `;
                        });
                        team1HTML += `</div>`;
                    }
                    
                    // Add bowling section for Team 1
                    const team1Bowling = bowlingStats.filter(p => p.teamId === currentMatchState.team1.id);
                    if (team1Bowling.length > 0) {
                        team1HTML += `<div class="scorecard-section"><div class="scorecard-section-title">Bowling</div>`;
                        team1Bowling.forEach(player => {
                            const overs = player.ballsBowled ? 
                                (Math.floor(player.ballsBowled / 6) + (player.ballsBowled % 6) / 10).toFixed(1) : '0.0';
                            team1HTML += `
                                <div class="scorecard-player-item">
                                    <div class="player-name-scorecard">${player.name}</div>
                                    <div class="player-stats-scorecard">
                                        ${player.wickets || 0}/${player.runsConceded || 0} (${overs})
                                    </div>
                                </div>
                            `;
                        });
                        team1HTML += `</div>`;
                    }
                    
                    team1Card.innerHTML = team1HTML;
                    scorecardTeams.appendChild(team1Card);
                }
                
                // Team 2 scorecard
                if (currentMatchState.team2) {
                    const team2Card = document.createElement('div');
                    team2Card.className = 'scorecard-team';
                    
                    let team2HTML = `<div class="scorecard-team-name">${currentMatchState.team2.name}</div>`;
                    
                    // Add batting section for Team 2
                    const team2Batting = battingStats.filter(p => p.teamId === currentMatchState.team2.id);
                    if (team2Batting.length > 0) {
                        team2HTML += `<div class="scorecard-section"><div class="scorecard-section-title">Batting</div>`;
                        team2Batting.forEach(player => {
                            const outStatus = player.isOut ? '' : '*';
                            team2HTML += `
                                <div class="scorecard-player-item">
                                    <div class="player-name-scorecard">${player.name}</div>
                                    <div class="player-stats-scorecard">
                                        ${player.runs}${outStatus} (${player.balls})
                                        ${player.fours > 0 ? `${player.fours}x4 ` : ''}
                                        ${player.sixes > 0 ? `${player.sixes}x6` : ''}
                                    </div>
                                </div>
                            `;
                        });
                        team2HTML += `</div>`;
                    }
                    
                    // Add bowling section for Team 2
                    const team2Bowling = bowlingStats.filter(p => p.teamId === currentMatchState.team2.id);
                    if (team2Bowling.length > 0) {
                        team2HTML += `<div class="scorecard-section"><div class="scorecard-section-title">Bowling</div>`;
                        team2Bowling.forEach(player => {
                            const overs = player.ballsBowled ? 
                                (Math.floor(player.ballsBowled / 6) + (player.ballsBowled % 6) / 10).toFixed(1) : '0.0';
                            team2HTML += `
                                <div class="scorecard-player-item">
                                    <div class="player-name-scorecard">${player.name}</div>
                                    <div class="player-stats-scorecard">
                                        ${player.wickets || 0}/${player.runsConceded || 0} (${overs})
                                    </div>
                                </div>
                            `;
                        });
                        team2HTML += `</div>`;
                    }
                    
                    team2Card.innerHTML = team2HTML;
                    scorecardTeams.appendChild(team2Card);
                }
            }
            
            document.getElementById('scorecardModal').classList.add('active');
        }
        
        // Print scorecard
        function printScorecard() {
            const printWindow = window.open('', '_blank');
            const team1Name = currentMatchState.team1?.name || 'Team 1';
            const team2Name = currentMatchState.team2?.name || 'Team 2';
            
            printWindow.document.write(`
                <html>
                <head>
                    <title>Scorecard - ${tournamentData.name}</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 20px; }
                        h1 { color: #333; }
                        .scorecard { margin-bottom: 30px; }
                        .team-name { font-weight: bold; font-size: 18px; margin-bottom: 10px; }
                        .player-row { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px solid #eee; }
                        .player-name { font-weight: bold; }
                    </style>
                </head>
                <body>
                    <h1>${tournamentData.name} - Scorecard</h1>
                    <div class="scorecard">
                        <div class="team-name">${team1Name}</div>
                        ${Array.from(document.querySelectorAll('#scorecardTeams .scorecard-team:first-child .scorecard-player-item')).map(item => item.outerHTML).join('')}
                    </div>
                    <div class="scorecard">
                        <div class="team-name">${team2Name}</div>
                        ${Array.from(document.querySelectorAll('#scorecardTeams .scorecard-team:last-child .scorecard-player-item')).map(item => item.outerHTML).join('')}
                    </div>
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }
        
        // Show notification
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.display = 'block';
            
            // Set color based on type
            if (type === 'success') {
                notification.style.background = 'linear-gradient(135deg, var(--success) 0%, #00e676 100%)';
            } else if (type === 'warning') {
                notification.style.background = 'linear-gradient(135deg, var(--warning) 0%, #ffb74d 100%)';
            } else if (type === 'error') {
                notification.style.background = 'linear-gradient(135deg, var(--danger) 0%, #ef5350 100%)';
            } else {
                notification.style.background = 'linear-gradient(135deg, var(--accent-green) 0%, var(--accent-green-dark) 100%)';
            }
            
            notification.classList.add('show');
            
            // Hide after duration
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    notification.style.display = 'none';
                }, 300);
            }, 3000);
        }
        
        // End match and declare winner
        function endMatch() {
            let winner = null;
            let resultSummary = '';
            
            const isTeam1Batting = cricketMatchState.battingTeam?.id === currentMatchState.team1?.id;
            
            const score1 = isTeam1Batting ? 
                cricketMatchState.totalRuns : (cricketMatchState.target > 0 ? cricketMatchState.target - 1 : 0);
            const score2 = !isTeam1Batting ? 
                cricketMatchState.totalRuns : (cricketMatchState.target > 0 ? cricketMatchState.target - 1 : 0);
            
            const wickets1 = isTeam1Batting ? cricketMatchState.wickets : 0;
            const wickets2 = !isTeam1Batting ? cricketMatchState.wickets : 0;
            
            if (currentMatchState.innings === 2) {
                if (cricketMatchState.totalRuns >= cricketMatchState.target) {
                    winner = cricketMatchState.battingTeam;
                    const wicketsLeft = 10 - cricketMatchState.wickets;
                    resultSummary = `${winner.name} won by ${wicketsLeft} wickets`;
                } else if (cricketMatchState.wickets >= 10 || cricketMatchState.currentOver >= tournamentData.sportSpecific.oversPerInnings) {
                    winner = cricketMatchState.bowlingTeam;
                    const runsDiff = cricketMatchState.target - cricketMatchState.totalRuns - 1;
                    resultSummary = `${winner.name} won by ${runsDiff} runs`;
                }
            }
            
            if (winner) {
                document.getElementById('match-winner').textContent = winner.name;
                document.getElementById('match-result-summary').textContent = resultSummary;
                
                // Set result details
                document.getElementById('result-team1-name').textContent = currentMatchState.team1?.name || 'Team 1';
                document.getElementById('result-team2-name').textContent = currentMatchState.team2?.name || 'Team 2';
                
                document.getElementById('result-team1-score').textContent = 
                    `${score1}/${wickets1}`;
                document.getElementById('result-team2-score').textContent = 
                    `${score2}/${wickets2}`;
                
                // Find top performers
                let topScorer = null;
                let topBowler = null;
                let maxRuns = -1;
                let maxWickets = -1;
                
                Object.values(cricketMatchState.playerStats || {}).forEach(player => {
                    if (player.runs > maxRuns) {
                        maxRuns = player.runs;
                        topScorer = player;
                    }
                    if (player.wickets > maxWickets) {
                        maxWickets = player.wickets;
                        topBowler = player;
                    }
                });
                
                document.getElementById('man-of-match').textContent = topScorer ? topScorer.name : '-';
                document.getElementById('best-batsman').textContent = topScorer ? topScorer.name : '-';
                document.getElementById('best-bowler').textContent = topBowler ? topBowler.name : '-';
                
                showSection('winner-announcement');
                document.querySelector('.nav-item[data-section="winner-announcement"]').classList.add('active');
            } else {
                showNotification("Match is still in progress", 'warning');
            }
        }
        
        // Reset match state for a new match
        function resetMatchState() {
            currentMatchState = {
                sport: tournamentData.sport,
                team1: null,
                team2: null,
                innings: 1,
                isMatchStarted: false,
                actionHistory: [],
                singleBatterMode: false,
                currentBatterMode: 'double',
                isTimerRunning: false,
                currentTime: 0,
                currentHalf: 1
            };
            
            cricketMatchState = {
                battingTeam: null,
                bowlingTeam: null,
                currentOver: 0,
                ballsInOver: 0,
                totalRuns: 0,
                wickets: 0,
                extras: 0,
                overs: [],
                currentOverBalls: [],
                isFirstInningsComplete: false,
                target: 0,
                legalBallsThisOver: 0,
                
                striker: null,
                nonStriker: null,
                currentBowler: null,
                previousBowler: null,
                
                battingTeamPlayers: [],
                bowlingTeamPlayers: [],
                availableBatsmen: [],
                availableBowlers: [],
                usedBowlersThisOver: [],
                
                playerStats: {},
                wicketsFallen: [],
                
                team1Stats: {
                    runs: 0,
                    wickets: 0,
                    overs: 0,
                    extras: 0,
                    runRate: 0
                },
                team2Stats: {
                    runs: 0,
                    wickets: 0,
                    overs: 0,
                    extras: 0,
                    runRate: 0
                }
            };
            
            footballMatchState = {
                team1Score: 0,
                team2Score: 0,
                team1YellowCards: 0,
                team2YellowCards: 0,
                team1RedCards: 0,
                team2RedCards: 0,
                team1Corners: 0,
                team2Corners: 0,
                team1Fouls: 0,
                team2Fouls: 0,
                currentTime: 0,
                currentHalf: 1,
                isTimerRunning: false,
                timerInterval: null,
                
                playerStats: {},
                goalScorers: [],
                cardEvents: []
            };
            
            customSportMatchState = {
                team1Score: 0,
                team2Score: 0,
                team1Stats: {},
                team2Stats: {},
                currentTime: 0,
                isTimerRunning: false,
                timerInterval: null,
                
                playerStats: {},
                events: []
            };
            
            setupMatchConfiguration();
        }
        
        // Initialize the app when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            initApp();
        });
    </script>
</body>
</html>
