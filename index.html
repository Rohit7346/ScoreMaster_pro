<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScoreMaster Pro | Multi-Sport Tournament Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800;900&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-dark: #0a0e17;
            --secondary-dark: #141a2a;
            --card-dark: #1a2238;
            --accent-green: #00ff8b;
            --accent-green-dark: #00cc6f;
            --text-primary: #ffffff;
            --text-secondary: #b0b7cb;
            --text-muted: #6c748a;
            --border-color: #2a3655;
            --success: #00c853;
            --warning: #ff9800;
            --danger: #f44336;
            --shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            --border-radius: 10px;
            --mobile-breakpoint: 768px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--primary-dark);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        h1, h2, h3, h4 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 800;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header Styles - Responsive */
        header {
            background-color: var(--secondary-dark);
            border-bottom: 2px solid var(--accent-green);
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow);
        }
        
        .logo {
            display: flex;
            align-items: center;
            font-size: 1.8rem;
            font-weight: 900;
            color: var(--accent-green);
        }
        
        .logo i {
            margin-right: 10px;
            font-size: 2rem;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-green), #00ccff);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        /* Main Content Area */
        main {
            padding: 30px 0;
            min-height: calc(100vh - 140px);
        }
        
        .dashboard-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .dashboard-section.active {
            display: block;
        }
        
        /* Navigation - Responsive */
        .main-nav {
            display: flex;
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }
        
        @media (max-width: 768px) {
            .main-nav {
                flex-wrap: wrap;
            }
            
            .nav-item {
                flex: 1 0 50%;
                min-width: 140px;
                padding: 15px 5px;
                font-size: 1rem;
            }
        }
        
        .nav-item {
            flex: 1;
            text-align: center;
            padding: 18px 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1.1rem;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
        }
        
        .nav-item:hover {
            background-color: rgba(0, 255, 139, 0.1);
        }
        
        .nav-item.active {
            background-color: rgba(0, 255, 139, 0.15);
            border-bottom: 3px solid var(--accent-green);
            color: var(--accent-green);
        }
        
        /* Sport Selection Dashboard - Responsive */
        .sport-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        
        /* HIDDEN: Remove descriptions from sport cards */
        .sport-card .sport-desc {
            display: none;
        }
        
        @media (max-width: 768px) {
            .sport-grid {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
                gap: 15px;
            }
        }
        
        .sport-card {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }
        
        .sport-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow);
            border-color: var(--accent-green);
        }
        
        .sport-card.selected {
            border-color: var(--accent-green);
            background-color: rgba(0, 255, 139, 0.05);
        }
        
        .sport-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--accent-green);
        }
        
        .sport-name {
            font-size: 1.5rem;
            margin-bottom: 0;
        }
        
        /* Tournament Setup Section */
        .setup-container {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 30px;
            border: 1px solid var(--border-color);
        }
        
        @media (max-width: 768px) {
            .setup-container {
                padding: 20px;
            }
        }
        
        .setup-step {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .setup-step.active {
            display: block;
        }
        
        .step-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        @media (max-width: 768px) {
            .step-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        }
        
        .step-number {
            width: 40px;
            height: 40px;
            background-color: var(--accent-green);
            color: var(--primary-dark);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.2rem;
            margin-right: 15px;
        }
        
        .step-title {
            font-size: 1.5rem;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-secondary);
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            background-color: var(--secondary-dark);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--accent-green);
            box-shadow: 0 0 0 2px rgba(0, 255, 139, 0.2);
        }
        
        .form-control-sm {
            max-width: 150px;
        }
        
        @media (max-width: 768px) {
            .form-control-sm {
                max-width: 100%;
            }
        }
        
        /* Sport-specific controls */
        .sport-specific-controls {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background-color: rgba(0, 255, 139, 0.05);
            border-radius: var(--border-radius);
            border: 1px solid var(--accent-green);
        }
        
        .sport-specific-controls.active {
            display: block;
        }
        
        /* Cricket specific */
        .cricket-controls .control-btn {
            background-color: rgba(0, 200, 83, 0.1);
        }
        
        /* Football specific */
        .football-controls .control-btn {
            background-color: rgba(33, 150, 243, 0.1);
        }

        /* Custom specific */
        .custom-controls .control-btn {
            background-color: rgba(255, 152, 0, 0.1);
        }
        
        .btn {
            padding: 12px 30px;
            background-color: var(--accent-green);
            color: var(--primary-dark);
            border: none;
            border-radius: 8px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn:hover {
            background-color: var(--accent-green-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 139, 0.3);
        }
        
        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--accent-green);
            color: var(--accent-green);
        }
        
        .btn-outline:hover {
            background-color: rgba(0, 255, 139, 0.1);
        }
        
        .btn-small {
            padding: 8px 15px;
            font-size: 0.9rem;
        }
        
        /* Navigation buttons */
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
        
        @media (max-width: 768px) {
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
        }
        
        /* Teams Setup - Responsive */
        .teams-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        
        @media (max-width: 768px) {
            .teams-container {
                grid-template-columns: 1fr;
                gap: 15px;
            }
        }
        
        .team-card {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 20px;
            border: 1px solid var(--border-color);
            transition: var(--transition);
        }
        
        .team-card:hover {
            border-color: var(--accent-green);
        }
        
        .team-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .team-name-input {
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 1.3rem;
            font-weight: 700;
            width: 100%;
            padding: 5px;
        }
        
        .team-name-input:focus {
            outline: none;
            border-bottom: 2px solid var(--accent-green);
        }
        
        .player-list {
            list-style: none;
        }
        
        .player-item {
            padding: 8px 0;
            border-bottom: 1px dashed var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .player-item:last-child {
            border-bottom: none;
        }
        
        .player-name-input {
            background: transparent;
            border: none;
            color: var(--text-primary);
            width: 70%;
            padding: 5px;
        }
        
        .player-name-input:focus {
            outline: none;
            border-bottom: 1px solid var(--accent-green);
        }
        
        /* Match Setup - Responsive */
        .match-setup-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 20px;
        }
        
        @media (max-width: 992px) {
            .match-setup-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        }
        
        .match-options {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 30px;
            border: 1px solid var(--border-color);
        }
        
        @media (max-width: 768px) {
            .match-options {
                padding: 15px;
            }
        }
        
        .teams-selection {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 20px;
        }
        
        .team-select {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .team-select:hover {
            background-color: rgba(0, 255, 139, 0.05);
        }
        
        .team-select.selected {
            border: 2px solid var(--accent-green);
            background-color: rgba(0, 255, 139, 0.1);
        }
        
        .team-select-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--card-dark);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            color: var(--accent-green);
        }
        
        /* Live Match Interface - Premium Google/IPL Style */
        
        /* Premium Match Header - Google/IPL Style */
        .premium-match-header {
            background: linear-gradient(135deg, #1a2238 0%, #0a0e17 100%);
            border-radius: 16px;
            padding: 25px 30px;
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .premium-match-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-green), #00ccff);
        }
        
        .match-info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .tournament-name {
            font-size: 1.1rem;
            color: var(--accent-green);
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .tournament-name i {
            font-size: 1.2rem;
        }
        
        .match-status-badge {
            background: linear-gradient(135deg, var(--accent-green), #00ccff);
            color: var(--primary-dark);
            padding: 8px 20px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 12px rgba(0, 255, 139, 0.2);
        }
        
        .live-pulse {
            width: 10px;
            height: 10px;
            background-color: #ff0000;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }
        
        .match-venue {
            color: var(--text-secondary);
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .teams-score-display {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 30px;
            align-items: center;
            padding: 25px 0;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        @media (max-width: 768px) {
            .teams-score-display {
                grid-template-columns: 1fr;
                gap: 20px;
                text-align: center;
            }
            
            .vs-separator {
                display: none;
            }
        }
        
        .team-score-card {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .team-header-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        @media (max-width: 768px) {
            .team-header-info {
                justify-content: center;
            }
        }
        
        .team-logo-large {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.5rem;
            color: white;
            border: 3px solid var(--accent-green);
            box-shadow: 0 0 20px rgba(0, 255, 139, 0.3);
        }
        
        .team-name-large {
            font-size: 1.8rem;
            font-weight: 800;
            color: white;
        }
        
        .team-innings-status {
            display: inline-block;
            padding: 4px 12px;
            background-color: rgba(0, 255, 139, 0.1);
            color: var(--accent-green);
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .score-display-large {
            font-size: 3.5rem;
            font-weight: 900;
            color: white;
            line-height: 1;
        }
        
        .score-details {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }
        
        .vs-separator {
            text-align: center;
            font-size: 2rem;
            font-weight: 900;
            color: var(--accent-green);
            position: relative;
        }
        
        .vs-separator::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--accent-green), transparent);
            transform: translateY(-50%);
        }
        
        .vs-text {
            background-color: var(--primary-dark);
            padding: 0 20px;
            position: relative;
            z-index: 1;
        }
        
        .match-stats-row {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .match-stat {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .stat-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: white;
        }
        
        .stat-value.highlight {
            color: var(--accent-green);
        }
        
        .required-run-rate {
            background-color: rgba(0, 255, 139, 0.1);
            padding: 10px 20px;
            border-radius: 8px;
            border-left: 4px solid var(--accent-green);
        }
        
        /* Player Tracking Section - Premium */
        .players-tracking-section {
            margin-top: 30px;
            margin-bottom: 30px;
        }
        
        .players-tracking-section h3 {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--accent-green);
        }
        
        .players-tracking-section h3 i {
            font-size: 1.3rem;
        }
        
        .players-tabs {
            display: flex;
            background-color: var(--secondary-dark);
            border-radius: 10px 10px 0 0;
            overflow: hidden;
            border-bottom: 2px solid var(--border-color);
        }
        
        .player-tab {
            flex: 1;
            padding: 15px 20px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
        }
        
        .player-tab:hover {
            background-color: rgba(0, 255, 139, 0.05);
        }
        
        .player-tab.active {
            background-color: rgba(0, 255, 139, 0.1);
            border-bottom: 3px solid var(--accent-green);
            color: var(--accent-green);
        }
        
        .players-content {
            background-color: var(--card-dark);
            border-radius: 0 0 10px 10px;
            padding: 25px;
            border: 1px solid var(--border-color);
            border-top: none;
        }
        
        .players-content.active {
            display: block;
        }
        
        .batsmen-list, .bowlers-list {
            display: grid;
            gap: 15px;
        }
        
        .player-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr 1fr;
            padding: 12px 15px;
            background-color: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            align-items: center;
            transition: var(--transition);
        }
        
        .player-row:hover {
            background-color: rgba(0, 255, 139, 0.05);
            transform: translateX(5px);
        }
        
        .player-row.header {
            background-color: rgba(0, 255, 139, 0.1);
            font-weight: 700;
            color: var(--accent-green);
        }
        
        .player-row.header:hover {
            transform: none;
            background-color: rgba(0, 255, 139, 0.1);
        }
        
        @media (max-width: 992px) {
            .player-row {
                grid-template-columns: 1fr 1fr;
                gap: 10px;
            }
            
            .player-row .player-stat {
                display: flex;
                justify-content: space-between;
            }
            
            .player-row .player-stat::before {
                content: attr(data-label);
                color: var(--text-secondary);
                font-size: 0.9rem;
            }
        }
        
        .player-name {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }
        
        .player-status {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--success);
        }
        
        .player-status.out {
            background-color: var(--danger);
        }
        
        .player-status.not-out {
            background-color: var(--accent-green);
        }
        
        /* Scorecard Section - Premium */
        .premium-scorecard {
            background-color: var(--card-dark);
            border-radius: 16px;
            padding: 30px;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
        }
        
        .scorecard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .scorecard-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .scorecard-title h3 {
            font-size: 1.5rem;
            color: white;
        }
        
        .scorecard-title .team-badge {
            padding: 5px 12px;
            background-color: rgba(0, 255, 139, 0.1);
            color: var(--accent-green);
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .current-over-display {
            background-color: rgba(0, 255, 139, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 25px;
            border: 1px solid var(--accent-green);
        }
        
        .current-over-title {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .balls-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .ball {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.1rem;
        }
        
        .ball.dot { 
            background-color: var(--border-color); 
            color: var(--text-secondary);
        }
        
        .ball.run-1 { 
            background-color: rgba(0, 200, 83, 0.3); 
            color: #00c853;
            border: 2px solid #00c853;
        }
        
        .ball.run-2 { 
            background-color: rgba(0, 200, 83, 0.5); 
            color: #00c853;
            border: 2px solid #00c853;
        }
        
        .ball.run-3 { 
            background-color: rgba(0, 200, 83, 0.7); 
            color: #00c853;
            border: 2px solid #00c853;
        }
        
        .ball.run-4 { 
            background-color: rgba(255, 193, 7, 0.3); 
            color: #ffc107;
            border: 2px solid #ffc107;
        }
        
        .ball.run-6 { 
            background-color: rgba(255, 87, 34, 0.3); 
            color: #ff5722;
            border: 2px solid #ff5722;
        }
        
        .ball.wicket { 
            background-color: rgba(244, 67, 54, 0.3); 
            color: #f44336;
            border: 2px solid #f44336;
        }
        
        .ball.wide { 
            background-color: rgba(156, 39, 176, 0.3); 
            color: #9c27b0;
            border: 2px solid #9c27b0;
        }
        
        .ball.noball { 
            background-color: rgba(255, 152, 0, 0.3); 
            color: #ff9800;
            border: 2px solid #ff9800;
        }
        
        .ball.bye { 
            background-color: rgba(63, 81, 181, 0.3); 
            color: #3f51b5;
            border: 2px solid #3f51b5;
        }
        
        .ball.legbye { 
            background-color: rgba(233, 30, 99, 0.3); 
            color: #e91e63;
            border: 2px solid #e91e63;
        }
        
        .overs-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
            gap: 12px;
            margin-top: 20px;
        }
        
        .over-card {
            background-color: var(--secondary-dark);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: var(--transition);
            border: 1px solid transparent;
        }
        
        .over-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-green);
            box-shadow: 0 5px 15px rgba(0, 255, 139, 0.2);
        }
        
        .over-card.current {
            background-color: rgba(0, 255, 139, 0.1);
            border-color: var(--accent-green);
        }
        
        .over-number {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }
        
        .over-runs {
            font-size: 1.5rem;
            font-weight: 800;
            color: white;
        }
        
        .wickets-display {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        .wicket-indicator {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            position: relative;
        }
        
        .wicket-indicator.taken {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
            box-shadow: 0 0 15px rgba(244, 67, 54, 0.3);
        }
        
        .wicket-indicator.remaining {
            background-color: var(--secondary-dark);
            border: 3px solid var(--border-color);
            color: var(--text-muted);
        }
        
        /* Player Performance Highlights */
        .performance-highlights {
            margin-top: 40px;
            margin-bottom: 30px;
        }
        
        .highlights-title {
            text-align: center;
            margin-bottom: 30px;
            color: var(--accent-green);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .highlights-title h3 {
            font-size: 1.8rem;
        }
        
        .highlights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
        }
        
        @media (max-width: 768px) {
            .highlights-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .highlight-card {
            background: linear-gradient(135deg, var(--card-dark), #141a2a);
            border-radius: 16px;
            padding: 25px;
            border: 1px solid var(--border-color);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }
        
        .highlight-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
            border-color: var(--accent-green);
        }
        
        .highlight-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-green), #00ccff);
        }
        
        .highlight-icon {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: var(--accent-green);
        }
        
        .highlight-player-name {
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 10px;
            color: white;
        }
        
        .highlight-team {
            color: var(--text-secondary);
            font-size: 1rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .highlight-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .highlight-stat {
            text-align: center;
        }
        
        .highlight-stat-value {
            font-size: 2rem;
            font-weight: 900;
            color: var(--accent-green);
            line-height: 1;
        }
        
        .highlight-stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }
        
        /* Scoring Controls - Premium */
        .premium-scoring-controls {
            background: linear-gradient(135deg, var(--card-dark), #141a2a);
            border-radius: 16px;
            padding: 30px;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
        }
        
        .controls-title {
            text-align: center;
            margin-bottom: 25px;
            color: var(--accent-green);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            font-size: 1.5rem;
        }
        
        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        
        @media (max-width: 768px) {
            .controls-grid {
                grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
                gap: 10px;
            }
        }
        
        .control-btn-premium {
            padding: 18px 10px;
            background: linear-gradient(135deg, var(--secondary-dark), #0a0e17);
            border: 2px solid var(--border-color);
            border-radius: 10px;
            color: var(--text-primary);
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        .control-btn-premium:hover {
            transform: translateY(-5px);
            border-color: var(--accent-green);
            box-shadow: 0 10px 20px rgba(0, 255, 139, 0.2);
            background: linear-gradient(135deg, rgba(0, 255, 139, 0.1), #0a0e17);
        }
        
        .control-btn-premium .btn-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }
        
        .control-btn-premium.runs-4 {
            border-color: #ffc107;
        }
        
        .control-btn-premium.runs-6 {
            border-color: #ff5722;
        }
        
        .control-btn-premium.wicket {
            border-color: #f44336;
        }
        
        .live-scoring-actions {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 30px;
            padding-top: 25px;
            border-top: 1px solid var(--border-color);
        }
        
        @media (max-width: 768px) {
            .live-scoring-actions {
                flex-direction: column;
                gap: 10px;
            }
            
            .live-scoring-actions button {
                width: 100%;
                margin: 0 !important;
            }
        }
        
        /* Winner Announcement */
        .winner-container {
            text-align: center;
            padding: 50px 30px;
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            border: 2px solid var(--accent-green);
            max-width: 800px;
            margin: 0 auto;
            animation: bounceIn 1s ease;
        }
        
        @media (max-width: 768px) {
            .winner-container {
                padding: 30px 20px;
                margin: 0 10px;
            }
        }
        
        .trophy-icon {
            font-size: 5rem;
            color: gold;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }
        
        @media (max-width: 768px) {
            .trophy-icon {
                font-size: 3.5rem;
            }
        }
        
        .winner-name {
            font-size: 3rem;
            font-weight: 900;
            margin: 20px 0;
            color: var(--accent-green);
            text-transform: uppercase;
        }
        
        @media (max-width: 768px) {
            .winner-name {
                font-size: 2rem;
            }
        }
        
        /* Stats Modal */
        .stats-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .stats-modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }
        
        .stats-content {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 30px;
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 2px solid var(--accent-green);
        }
        
        .stats-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .close-stats {
            background: none;
            border: none;
            color: var(--accent-green);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .stat-card {
            background-color: var(--secondary-dark);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 900;
            color: var(--accent-green);
            margin: 10px 0;
        }
        
        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        /* Progress Bar - Responsive */
        .step-progress {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            position: relative;
        }
        
        @media (max-width: 768px) {
            .step-progress {
                margin-bottom: 20px;
            }
        }
        
        .step-progress:before {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            width: 100%;
            height: 4px;
            background-color: var(--border-color);
            z-index: 1;
        }
        
        .step-progress:after {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            width: var(--progress-width, 0%);
            height: 4px;
            background-color: var(--accent-green);
            z-index: 2;
            transition: width 0.5s ease;
        }
        
        .step-indicator {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background-color: var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--text-muted);
            z-index: 3;
            position: relative;
        }
        
        @media (max-width: 768px) {
            .step-indicator {
                width: 30px;
                height: 30px;
                font-size: 0.9rem;
            }
        }
        
        .step-indicator.active {
            background-color: var(--accent-green);
            color: var(--primary-dark);
        }
        
        .step-label {
            position: absolute;
            top: 40px;
            width: 100px;
            text-align: center;
            left: -32px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        @media (max-width: 768px) {
            .step-label {
                font-size: 0.7rem;
                width: 70px;
                left: -20px;
            }
        }
        
        /* Footer */
        footer {
            background-color: var(--secondary-dark);
            padding: 20px 0;
            text-align: center;
            border-top: 1px solid var(--border-color);
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        @keyframes bounceIn {
            0% { transform: scale(0.5); opacity: 0; }
            70% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); }
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }
        
        /* Mobile-specific styles */
        @media (max-width: 768px) {
            h2 {
                font-size: 1.5rem;
            }
            
            h3 {
                font-size: 1.3rem;
            }
            
            .container {
                padding: 0 15px;
            }
            
            .user-profile span {
                display: none;
            }
            
            .btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
            
            .score-display-large {
                font-size: 2.5rem;
            }
            
            .team-name-large {
                font-size: 1.5rem;
            }
            
            .premium-match-header {
                padding: 20px 15px;
            }
            
            .premium-scorecard {
                padding: 20px 15px;
            }
        }
        
        /* Custom overs input styling */
        .custom-overs-input {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .custom-overs-input input {
            width: 80px;
        }
        
        /* Mobile menu toggle for small screens */
        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--accent-green);
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        @media (max-width: 768px) {
            .mobile-menu-toggle {
                display: block;
            }
            
            .main-nav.hidden-on-mobile {
                display: none;
            }
        }
        
        /* Ball-by-ball display */
        .ball-display {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-trophy"></i>
                    <span>ScoreMaster Pro</span>
                </div>
                <button class="mobile-menu-toggle" id="mobileMenuToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="user-profile">
                    <span id="tournament-name-display">Multi-Sport Tournament</span>
                    <div class="user-avatar">
                        <i class="fas fa-trophy"></i>
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <nav class="main-nav hidden-on-mobile">
        <div class="nav-item active" data-section="sport-dashboard">
            <i class="fas fa-home"></i> Sport Dashboard
        </div>
        <div class="nav-item" data-section="tournament-setup">
            <i class="fas fa-plus-circle"></i> Create Tournament
        </div>
        <div class="nav-item" data-section="live-scoring">
            <i class="fas fa-broadcast-tower"></i> Live Scoring
        </div>
        <div class="nav-item" data-section="winner-announcement">
            <i class="fas fa-trophy"></i> Winner Announcement
        </div>
    </nav>
    
    <main class="container">
        <div class="step-progress" id="step-progress">
            <div class="step-indicator active" data-step="1">
                1
                <div class="step-label">Select Sport</div>
            </div>
            <div class="step-indicator" data-step="2">
                2
                <div class="step-label">Tournament Setup</div>
            </div>
            <div class="step-indicator" data-step="3">
                3
                <div class="step-label">Create Teams</div>
            </div>
            <div class="step-indicator" data-step="4">
                4
                <div class="step-label">Match Setup</div>
            </div>
            <div class="step-indicator" data-step="5">
                5
                <div class="step-label">Live Scoring</div>
            </div>
        </div>
        
        <section id="sport-dashboard" class="dashboard-section active">
            <h2>Select Sport</h2>
            <p class="subheading">Choose a sport to start your tournament</p>
            
            <div class="sport-grid">
                <div class="sport-card selected" data-sport="cricket">
                    <div class="sport-icon">
                        <i class="fas fa-baseball-ball"></i>
                    </div>
                    <h3 class="sport-name">Cricket</h3>
                </div>
                
                <div class="sport-card" data-sport="football">
                    <div class="sport-icon">
                        <i class="fas fa-futbol"></i>
                    </div>
                    <h3 class="sport-name">Football</h3>
                </div>

                <div class="sport-card" data-sport="custom">
                    <div class="sport-icon">
                        <i class="fas fa-magic"></i>
                    </div>
                    <h3 class="sport-name">Custom Sport</h3>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 40px;">
                <button class="btn" id="start-tournament-btn">
                    <i class="fas fa-arrow-right"></i> Start <span id="selected-sport-name">Cricket</span> Tournament Setup
                </button>
            </div>
        </section>
        
        <section id="tournament-setup" class="dashboard-section">
            <div class="setup-container">
                <div class="setup-step active" id="step1">
                    <div class="step-header">
                        <div class="step-number">1</div>
                        <h3 class="step-title" id="setup-title">Cricket Tournament Details</h3>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Tournament Name</label>
                        <input type="text" class="form-control" id="tournament-name" placeholder="e.g., Champions League T20" value="Champions League T20">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Number of Teams</label>
                        <input type="number" class="form-control form-control-sm" id="team-count" min="2" max="16" value="4">
                        <p class="form-hint" style="color: var(--text-muted); margin-top: 5px;">Enter number of teams (2-16)</p>
                    </div>
                    
                    <div class="sport-specific-controls cricket-controls active" id="cricket-controls">
                        <div class="form-group">
                            <label class="form-label">Overs per Innings</label>
                            <div class="custom-overs-input">
                                <select class="form-control form-control-sm" id="overs-count">
                                    <option value="custom">Custom Overs</option>
                                    <option value="2">2 Overs</option>
                                    <option value="3">3 Overs</option>
                                    <option value="5">5 Overs (Quick Match)</option>
                                    <option value="6">6 Overs</option>
                                    <option value="10">10 Overs</option>
                                    <option value="20" selected>20 Overs (T20)</option>
                                    <option value="50">50 Overs (ODI)</option>
                                </select>
                                <input type="number" class="form-control form-control-sm" id="custom-overs-input" min="1" max="100" placeholder="Enter overs" style="display: none;">
                            </div>
                            <p class="form-hint" style="color: var(--text-muted); margin-top: 5px;">Select from options or choose "Custom Overs" to enter any number</p>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Players per Team</label>
                            <input type="number" class="form-control form-control-sm" id="players-per-team" min="6" max="15" value="11">
                            <p class="form-hint" style="color: var(--text-muted); margin-top: 5px;">Enter players per team (6-15)</p>
                        </div>
                    </div>
                    
                    <div class="sport-specific-controls football-controls" id="football-controls">
                        <div class="form-group">
                            <label class="form-label">Match Duration (Minutes)</label>
                            <select class="form-control form-control-sm" id="football-duration">
                                <option value="30">30 mins (Friendly)</option>
                                <option value="45" selected>45 mins (Half)</option>
                                <option value="90">90 mins (Full Match)</option>
                                <option value="120">120 mins (Extra Time)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Players per Team</label>
                            <input type="number" class="form-control form-control-sm" id="football-players" min="7" max="11" value="11">
                            <p class="form-hint" style="color: var(--text-muted); margin-top: 5px;">Enter players per team (7-11)</p>
                        </div>
                    </div>
                    
                    <div class="sport-specific-controls custom-controls" id="custom-controls">
                        <div class="form-group">
                            <label class="form-label">Custom Sport Name</label>
                            <input type="text" class="form-control" id="custom-sport-name" placeholder="e.g., Ultimate Frisbee" value="Ultimate Frisbee">
                        </div>

                        <div class="form-group">
                            <label class="form-label">Players per Team</label>
                            <input type="number" class="form-control form-control-sm" id="custom-players-per-team" min="1" max="20" value="7">
                            <p class="form-hint" style="color: var(--text-muted); margin-top: 5px;">Enter players per team (1-20)</p>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Scoring Unit (e.g., Points, Goals, Sets)</label>
                            <input type="text" class="form-control form-control-sm" id="custom-scoring-unit" placeholder="Points" value="Points">
                        </div>

                         <div class="form-group">
                            <label class="form-label">Match Duration Unit (e.g., Time in mins, Sets, Rounds)</label>
                            <input type="text" class="form-control form-control-sm" id="custom-duration-unit" placeholder="Minutes" value="Minutes">
                        </div>
                    </div>
                    
                    <div class="navigation-buttons">
                        <button class="btn-outline" id="back-to-sport">
                            <i class="fas fa-arrow-left"></i> Back to Sport Selection
                        </button>
                        <button class="btn" id="next-to-teams">
                            Next: Create Teams <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <div class="setup-step" id="step2">
                    <div class="step-header">
                        <div class="step-number">2</div>
                        <h3 class="step-title">Create Teams & Players</h3>
                    </div>
                    
                    <div id="teams-container">
                        </div>
                    
                    <div class="navigation-buttons">
                        <button class="btn-outline" id="back-to-details">
                            <i class="fas fa-arrow-left"></i> Back to Tournament Details
                        </button>
                        <button class="btn" id="next-to-match-setup">
                            Next: Match Setup <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <div class="setup-step" id="step3">
                    <div class="step-header">
                        <div class="step-number">3</div>
                        <h3 class="step-title">Match Setup</h3>
                    </div>
                    
                    <p style="margin-bottom: 20px;">Set up the first match of your tournament</p>
                    
                    <div class="match-setup-container">
                        <div class="match-options">
                            <h4 style="margin-bottom: 15px;">Select Teams</h4>
                            <div class="teams-selection" id="teams-selection">
                                </div>
                            
                            <div style="margin-top: 30px;">
                                <h4 style="margin-bottom: 15px;" id="toss-title">Toss Winner & Decision</h4>
                                <div class="form-group">
                                    <label class="form-label" id="toss-winner-label">Toss Winner</label>
                                    <select class="form-control" id="toss-winner">
                                        </select>
                                </div>
                                
                                <div class="form-group" id="toss-decision-group">
                                    <label class="form-label">Toss Decision</label>
                                    <select class="form-control" id="toss-decision">
                                        <option value="bat">Bat First</option>
                                        <option value="bowl">Bowl First</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="match-options">
                            <h4 style="margin-bottom: 15px;">Match Preview</h4>
                            <div id="match-preview" style="padding: 20px; background-color: var(--secondary-dark); border-radius: var(--border-radius);">
                                <p style="text-align: center; margin-bottom: 15px;">Match details will appear here</p>
                                <div id="preview-teams" style="display: flex; justify-content: center; gap: 20px; margin-bottom: 20px;">
                                    <div style="text-align: center;">
                                        <div class="team-select-icon" id="preview-team1">T1</div>
                                        <div id="preview-team1-name" style="margin-top: 10px; font-weight: bold;">Team 1</div>
                                    </div>
                                    <div style="display: flex; align-items: center; font-weight: bold; color: var(--accent-green);">VS</div>
                                    <div style="text-align: center;">
                                        <div class="team-select-icon" id="preview-team2">T2</div>
                                        <div id="preview-team2-name" style="margin-top: 10px; font-weight: bold;">Team 2</div>
                                    </div>
                                </div>
                                <div id="preview-details">
                                    <p id="preview-format"><strong>Format:</strong> <span id="preview-format-value">20 overs per innings</span></p>
                                    <p id="preview-toss-line"><strong>Toss:</strong> <span id="preview-toss">Not decided yet</span></p>
                                </div>
                            </div>
                            
                            <div style="margin-top: 30px; text-align: center;">
                                <button class="btn" id="launch-tournament-btn">
                                    <i class="fas fa-rocket"></i> Launch Tournament & Start Match
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="navigation-buttons">
                        <button class="btn-outline" id="back-to-teams">
                            <i class="fas fa-arrow-left"></i> Back to Teams
                        </button>
                        <button class="btn-outline" id="modify-tournament">
                            <i class="fas fa-edit"></i> Modify Tournament
                        </button>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="live-scoring" class="dashboard-section">
            <!-- Premium Match Header - Google/IPL Style -->
            <div class="premium-match-header" id="premium-match-header">
                <div class="match-info-row">
                    <div class="tournament-name">
                        <i class="fas fa-trophy"></i>
                        <span id="tournament-display-name">Champions League T20</span>
                    </div>
                    <div class="match-status-badge">
                        <span class="live-pulse"></span>
                        <span id="match-status-text">LIVE</span>
                    </div>
                    <div class="match-venue">
                        <i class="fas fa-map-marker-alt"></i>
                        <span id="match-venue-text">Venue: Melbourne Cricket Ground</span>
                    </div>
                </div>
                
                <div class="teams-score-display">
                    <div class="team-score-card">
                        <div class="team-header-info">
                            <div class="team-logo-large" id="team1-logo-large" style="background: linear-gradient(135deg, #0047AB, #1E90FF);">T1</div>
                            <div>
                                <div class="team-name-large" id="team1-name-large">Team A</div>
                                <span id="team1-innings-status" class="team-innings-status">Batting</span>
                            </div>
                        </div>
                        <div class="score-display-large" id="team1-score-large">0/0</div>
                        <div class="score-details" id="team1-score-details">0.0 Overs</div>
                    </div>
                    
                    <div class="vs-separator">
                        <div class="vs-text">VS</div>
                    </div>
                    
                    <div class="team-score-card">
                        <div class="team-header-info">
                            <div class="team-logo-large" id="team2-logo-large" style="background: linear-gradient(135deg, #FF0000, #FF6B6B);">T2</div>
                            <div>
                                <div class="team-name-large" id="team2-name-large">Team B</div>
                                <span id="team2-innings-status" class="team-innings-status">Bowling</span>
                            </div>
                        </div>
                        <div class="score-display-large" id="team2-score-large">To Bat</div>
                        <div class="score-details" id="team2-score-details">Target: -</div>
                    </div>
                </div>
                
                <div class="match-stats-row">
                    <div class="match-stat">
                        <div class="stat-label">Current Run Rate</div>
                        <div class="stat-value highlight" id="current-run-rate">0.00</div>
                    </div>
                    <div class="match-stat">
                        <div class="stat-label">Required Run Rate</div>
                        <div class="stat-value" id="required-run-rate">-</div>
                    </div>
                    <div class="match-stat">
                        <div class="stat-label">Projected Score</div>
                        <div class="stat-value" id="projected-score">0</div>
                    </div>
                    <div class="match-stat required-run-rate">
                        <div class="stat-label">Runs Required</div>
                        <div class="stat-value highlight" id="runs-required">-</div>
                    </div>
                    <div class="match-stat">
                        <div class="stat-label">Balls Remaining</div>
                        <div class="stat-value" id="balls-remaining">120</div>
                    </div>
                </div>
            </div>
            
            <!-- Players Tracking Section -->
            <div class="players-tracking-section">
                <h3><i class="fas fa-users"></i> Player Performance Tracker</h3>
                
                <div class="players-tabs">
                    <div class="player-tab active" data-tab="batsmen">Batsmen</div>
                    <div class="player-tab" data-tab="bowlers">Bowlers</div>
                    <div class="player-tab" data-tab="fielders">Fielders</div>
                </div>
                
                <div class="players-content active" id="batsmen-content">
                    <div class="player-row header">
                        <div class="player-name">Batsman</div>
                        <div class="player-stat">Runs</div>
                        <div class="player-stat">Balls</div>
                        <div class="player-stat">4s</div>
                        <div class="player-stat">6s</div>
                        <div class="player-stat">SR</div>
                    </div>
                    <div id="batsmen-list">
                        <!-- Batsmen will be populated here -->
                    </div>
                </div>
                
                <div class="players-content" id="bowlers-content">
                    <div class="player-row header">
                        <div class="player-name">Bowler</div>
                        <div class="player-stat">Overs</div>
                        <div class="player-stat">Runs</div>
                        <div class="player-stat">Wickets</div>
                        <div class="player-stat">Maiden</div>
                        <div class="player-stat">Econ</div>
                    </div>
                    <div id="bowlers-list">
                        <!-- Bowlers will be populated here -->
                    </div>
                </div>
                
                <div class="players-content" id="fielders-content">
                    <div class="player-row header">
                        <div class="player-name">Fielder</div>
                        <div class="player-stat">Catches</div>
                        <div class="player-stat">Run Outs</div>
                        <div class="player-stat">Stumpings</div>
                        <div class="player-stat">Assists</div>
                        <div class="player-stat">Total</div>
                    </div>
                    <div id="fielders-list">
                        <!-- Fielders will be populated here -->
                    </div>
                </div>
            </div>
            
            <!-- Player Performance Highlights -->
            <div class="performance-highlights">
                <div class="highlights-title">
                    <i class="fas fa-star"></i>
                    <h3>Performance Highlights</h3>
                    <i class="fas fa-star"></i>
                </div>
                
                <div class="highlights-grid">
                    <div class="highlight-card">
                        <div class="highlight-icon">
                            <i class="fas fa-fire"></i>
                        </div>
                        <div class="highlight-player-name" id="top-scorer-name">-</div>
                        <div class="highlight-team" id="top-scorer-team">Top Run Scorer</div>
                        <div class="highlight-stats">
                            <div class="highlight-stat">
                                <div class="highlight-stat-value" id="top-scorer-runs">0</div>
                                <div class="highlight-stat-label">Runs</div>
                            </div>
                            <div class="highlight-stat">
                                <div class="highlight-stat-value" id="top-scorer-sr">0</div>
                                <div class="highlight-stat-label">Strike Rate</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="highlight-card">
                        <div class="highlight-icon">
                            <i class="fas fa-baseball-ball"></i>
                        </div>
                        <div class="highlight-player-name" id="top-wicket-taker-name">-</div>
                        <div class="highlight-team" id="top-wicket-taker-team">Best Bowler</div>
                        <div class="highlight-stats">
                            <div class="highlight-stat">
                                <div class="highlight-stat-value" id="top-wicket-taker-wickets">0</div>
                                <div class="highlight-stat-label">Wickets</div>
                            </div>
                            <div class="highlight-stat">
                                <div class="highlight-stat-value" id="top-wicket-taker-econ">0</div>
                                <div class="highlight-stat-label">Economy</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="highlight-card">
                        <div class="highlight-icon">
                            <i class="fas fa-gloves"></i>
                        </div>
                        <div class="highlight-player-name" id="best-fielder-name">-</div>
                        <div class="highlight-team" id="best-fielder-team">Best Fielder</div>
                        <div class="highlight-stats">
                            <div class="highlight-stat">
                                <div class="highlight-stat-value" id="best-fielder-catches">0</div>
                                <div class="highlight-stat-label">Catches</div>
                            </div>
                            <div class="highlight-stat">
                                <div class="highlight-stat-value" id="best-fielder-assists">0</div>
                                <div class="highlight-stat-label">Assists</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Premium Scorecard Section -->
            <div class="premium-scorecard" id="cricket-scorecard">
                <div class="scorecard-header">
                    <div class="scorecard-title">
                        <h3 id="batting-team-name">Team A</h3>
                        <span class="team-badge">Batting</span>
                    </div>
                    <div class="score-display-large">
                        <span id="current-score-display">0/0</span>
                    </div>
                </div>
                
                <div class="current-over-display">
                    <div class="current-over-title">
                        <i class="fas fa-baseball-ball"></i>
                        <span>Current Over</span>
                    </div>
                    <div class="balls-container" id="current-over-balls">
                        <!-- Current over balls will be displayed here -->
                    </div>
                </div>
                
                <div class="wickets-display" id="wickets-display">
                    <!-- Wickets will be displayed here -->
                </div>
                
                <div style="margin-top: 25px;">
                    <h4 style="margin-bottom: 15px;">Over-by-Over Breakdown</h4>
                    <div class="overs-breakdown" id="overs-breakdown">
                        <!-- Overs will be displayed here -->
                    </div>
                </div>
            </div>
            
            <!-- Premium Scoring Controls -->
            <div class="premium-scoring-controls">
                <div class="controls-title">
                    <i class="fas fa-sliders-h"></i>
                    <span>Cricket Scoring Controls</span>
                    <i class="fas fa-sliders-h"></i>
                </div>
                
                <div class="controls-grid">
                    <button class="control-btn-premium runs" data-runs="0">
                        <span class="btn-main">0</span>
                        <span class="btn-label">Dot Ball</span>
                    </button>
                    <button class="control-btn-premium runs" data-runs="1">
                        <span class="btn-main">1</span>
                        <span class="btn-label">Single</span>
                    </button>
                    <button class="control-btn-premium runs" data-runs="2">
                        <span class="btn-main">2</span>
                        <span class="btn-label">Double</span>
                    </button>
                    <button class="control-btn-premium runs" data-runs="3">
                        <span class="btn-main">3</span>
                        <span class="btn-label">Triple</span>
                    </button>
                    <button class="control-btn-premium runs runs-4" data-runs="4">
                        <span class="btn-main">4</span>
                        <span class="btn-label">Boundary</span>
                    </button>
                    <button class="control-btn-premium runs runs-6" data-runs="6">
                        <span class="btn-main">6</span>
                        <span class="btn-label">Maximum</span>
                    </button>
                    <button class="control-btn-premium extras" data-extra="wide">
                        <span class="btn-main">Wd</span>
                        <span class="btn-label">Wide (+1)</span>
                    </button>
                    <button class="control-btn-premium extras" data-extra="noball">
                        <span class="btn-main">Nb</span>
                        <span class="btn-label">No Ball (+1)</span>
                    </button>
                    <button class="control-btn-premium extras" data-extra="noball4">
                        <span class="btn-main">Nb+4</span>
                        <span class="btn-label">No Ball + 4</span>
                    </button>
                    <button class="control-btn-premium extras" data-extra="noball6">
                        <span class="btn-main">Nb+6</span>
                        <span class="btn-label">No Ball + 6</span>
                    </button>
                    <button class="control-btn-premium extras" data-extra="bye">
                        <span class="btn-main">B</span>
                        <span class="btn-label">Bye</span>
                    </button>
                    <button class="control-btn-premium extras" data-extra="legbye">
                        <span class="btn-main">Lb</span>
                        <span class="btn-label">Leg Bye</span>
                    </button>
                    <button class="control-btn-premium wicket" data-wicket="true">
                        <span class="btn-main">W</span>
                        <span class="btn-label">Wicket</span>
                    </button>
                    <button class="control-btn-premium" id="undo-btn">
                        <span class="btn-main">
                            <i class="fas fa-undo"></i>
                        </span>
                        <span class="btn-label">Undo</span>
                    </button>
                </div>
                
                <div class="live-scoring-actions">
                    <button class="btn-outline btn-small" id="swap-batsmen-btn">
                        <i class="fas fa-exchange-alt"></i> Swap Batsmen
                    </button>
                    <button class="btn-outline btn-small" id="change-bowler-btn">
                        <i class="fas fa-baseball-ball"></i> Change Bowler
                    </button>
                    <button class="btn-outline" id="view-stats-btn">
                        <i class="fas fa-chart-bar"></i> Detailed Stats
                    </button>
                    <button class="btn-outline btn-small" id="end-innings-btn">
                        <i class="fas fa-flag-checkered"></i> End Innings
                    </button>
                    <button class="btn" id="declare-winner-btn">
                        <i class="fas fa-trophy"></i> Declare Winner
                    </button>
                    <button class="btn-outline" id="back-to-setup">
                        <i class="fas fa-cog"></i> Modify Setup
                    </button>
                </div>
            </div>
        </section>
        
        <section id="winner-announcement" class="dashboard-section">
            <div class="winner-container">
                <div class="trophy-icon">
                    <i class="fas fa-trophy"></i>
                </div>
                
                <h2>MATCH RESULT</h2>
                
                <div class="winner-name" id="match-winner">Team A</div>
                
                <p style="font-size: 1.3rem; margin-bottom: 20px;" id="match-result-summary">Team A won by XX runs</p>
                
                <div style="background-color: var(--secondary-dark); padding: 20px; border-radius: var(--border-radius); margin: 25px 0;">
                    <div style="display: flex; justify-content: space-around; margin-bottom: 15px;">
                        <div style="text-align: center;">
                            <div id="result-team1-name" style="font-weight: bold; margin-bottom: 5px;">Team A</div>
                            <div id="result-team1-score" style="font-size: 1.5rem; color: var(--accent-green);">0/0 (20)</div>
                        </div>
                        <div style="display: flex; align-items: center; font-weight: bold; color: var(--accent-green);">VS</div>
                        <div style="text-align: center;">
                            <div id="result-team2-name" style="font-weight: bold; margin-bottom: 5px;">Team B</div>
                            <div id="result-team2-score" style="font-size: 1.5rem; color: var(--accent-green);">0/0 (20)</div>
                        </div>
                    </div>
                    <div id="result-details">
                        <p><strong>Man of the Match:</strong> <span id="man-of-match">-</span></p>
                        <p><strong>Best Bowler:</strong> <span id="best-bowler">-</span></p>
                        <p><strong>Best Batsman:</strong> <span id="best-batsman">-</span></p>
                    </div>
                </div>
                
                <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap;">
                    <button class="btn" id="new-match-btn">
                        <i class="fas fa-plus-circle"></i> Start New Match
                    </button>
                    <button class="btn-outline" id="back-to-dashboard-btn">
                        <i class="fas fa-home"></i> Back to Dashboard
                    </button>
                    <button class="btn-outline" id="view-tournament-stats-btn">
                        <i class="fas fa-chart-bar"></i> Tournament Stats
                    </button>
                </div>
            </div>
        </section>
    </main>
    
    <div class="stats-modal" id="statsModal">
        <div class="stats-content">
            <div class="stats-header">
                <h3>Detailed Match Statistics</h3>
                <button class="close-stats" id="closeStats">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="stats-content">
                </div>
        </div>
    </div>
    
    <footer>
        <div class="container">
            <p>ScoreMaster Pro &copy; 2023 | Multi-Sport Tournament Scoring Platform</p>
            <p>Design inspired by ESPN & Cricbuzz | Complete multi-sport tournament management system</p>
        </div>
    </footer>
    
    <script>
        // Tournament Data Model
        const tournamentData = {
            sport: 'cricket',
            name: 'Champions League T20',
            teams: [],
            sportSpecific: {
                oversPerInnings: 20,
                playersPerTeam: 11
            },
            currentMatch: null,
            matches: []
        };
        
        // Current Match State
        let currentMatchState = {
            sport: 'cricket',
            team1: null,
            team2: null,
            innings: 1,
            isMatchStarted: false,
            actionHistory: []
        };
        
        // Cricket Match State with Player Tracking
        let cricketMatchState = {
            battingTeam: null,
            bowlingTeam: null,
            currentOver: 0,
            ballsInOver: 0,
            totalRuns: 0,
            wickets: 0,
            extras: 0,
            overs: [],
            currentOverBalls: [],
            isFirstInningsComplete: false,
            target: 0,
            legalBallsThisOver: 0,
            
            // Player Tracking
            batsmen: [],
            bowlers: [],
            fielders: [],
            
            // Current players on strike
            striker: null,
            nonStriker: null,
            currentBowler: null,
            
            // Performance tracking
            playerStats: {}
        };
        
        // Custom Match State
        let customMatchState = {
            team1Score: 0,
            team2Score: 0,
            durationUnit: 'Minutes',
            currentDuration: 0,
            scoringUnit: 'Points',
            events: []
        };
        
        // Store previous step for navigation
        let previousSteps = [];
        let currentStep = 1;
        
        // Initialize the application
        function initApp() {
            // Set up event listeners
            setupEventListeners();
            
            // Initialize tournament with default values
            updateTournamentFromForm();
            
            // Generate initial teams if needed
            generateTeams();
            
            // Set up mobile menu toggle
            setupMobileMenu();
            
            // Set up navigation
            setupNavigation();
            
            // Set default team selection in match setup
            setupTeamSelectionEvents();
            
            setupCustomScoringControls();
            
            // Set up player tabs
            setupPlayerTabs();
            
            console.log("App initialized successfully!");
        }
        
        // Set up all event listeners
        function setupEventListeners() {
            console.log("Setting up event listeners...");
            
            // Sport selection
            const sportCards = document.querySelectorAll('.sport-card');
            sportCards.forEach(card => {
                card.addEventListener('click', function() {
                    sportCards.forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    tournamentData.sport = this.getAttribute('data-sport');
                    
                    // Update UI based on sport
                    updateSportUI();
                });
            });
            
            // Start tournament button
            document.getElementById('start-tournament-btn').addEventListener('click', function() {
                goToStep(2);
            });
            
            // Back to sport selection
            document.getElementById('back-to-sport').addEventListener('click', function() {
                goToStep(1);
            });
            
            // Navigation between setup steps
            document.getElementById('next-to-teams').addEventListener('click', function() {
                updateTournamentFromForm();
                generateTeams();
                goToStep(3);
            });
            
            document.getElementById('back-to-details').addEventListener('click', function() {
                goToStep(2);
            });
            
            document.getElementById('next-to-match-setup').addEventListener('click', function() {
                if (validateTeams()) {
                    setupMatchConfiguration();
                    goToStep(4);
                }
            });
            
            document.getElementById('back-to-teams').addEventListener('click', function() {
                goToStep(3);
            });
            
            // Modify tournament button
            document.getElementById('modify-tournament').addEventListener('click', function() {
                goToStep(2);
            });
            
            // Launch tournament
            document.getElementById('launch-tournament-btn').addEventListener('click', function() {
                if (setupMatch()) {
                    goToStep(5);
                    startMatch();
                }
            });
            
            // Back to setup from live scoring
            document.getElementById('back-to-setup').addEventListener('click', function() {
                if (confirm("Are you sure you want to modify the setup? Current match progress will be lost.")) {
                    goToStep(4);
                }
            });
            
            // Overs count selection change
            const oversCountSelect = document.getElementById('overs-count');
            const customOversInput = document.getElementById('custom-overs-input');
            
            if (oversCountSelect) {
                oversCountSelect.addEventListener('change', function() {
                    if (this.value === 'custom') {
                        customOversInput.style.display = 'block';
                        customOversInput.focus();
                    } else {
                        customOversInput.style.display = 'none';
                        tournamentData.sportSpecific.oversPerInnings = parseInt(this.value);
                    }
                });
            }
            
            // Custom overs input
            if (customOversInput) {
                customOversInput.addEventListener('input', function() {
                    const value = parseInt(this.value);
                    if (value > 0 && value <= 100) {
                        tournamentData.sportSpecific.oversPerInnings = value;
                    }
                });
            }
            
            // Cricket scoring controls
            setupCricketScoringControls();
            
            // End innings button
            document.getElementById('end-innings-btn').addEventListener('click', function() {
                if (tournamentData.sport === 'cricket') {
                    if (currentMatchState.innings === 1) {
                        endFirstInnings();
                    } else {
                        endMatch();
                    }
                }
            });
            
            // Swap batsmen button
            document.getElementById('swap-batsmen-btn').addEventListener('click', swapBatsmen);
            
            // Change bowler button
            document.getElementById('change-bowler-btn').addEventListener('click', changeBowler);
            
            // Declare winner button
            document.getElementById('declare-winner-btn').addEventListener('click', endMatch);
            
            // New match button
            document.getElementById('new-match-btn').addEventListener('click', function() {
                resetMatchState();
                goToStep(4);
            });
            
            // Back to dashboard
            document.getElementById('back-to-dashboard-btn').addEventListener('click', function() {
                goToStep(1);
            });
            
            // Toss selection change
            document.getElementById('toss-winner').addEventListener('change', updateMatchPreview);
            document.getElementById('toss-decision').addEventListener('change', updateMatchPreview);
            
            // Tournament form changes
            document.getElementById('team-count').addEventListener('change', updateTournamentFromForm);
            document.getElementById('tournament-name').addEventListener('input', updateTournamentFromForm);
            
            // Custom Sport changes to update form
            document.getElementById('custom-sport-name').addEventListener('input', updateTournamentFromForm);
            document.getElementById('custom-players-per-team').addEventListener('input', updateTournamentFromForm);
            document.getElementById('custom-scoring-unit').addEventListener('input', updateTournamentFromForm);
            document.getElementById('custom-duration-unit').addEventListener('input', updateTournamentFromForm);
            
            // Stats buttons
            document.getElementById('view-stats-btn').addEventListener('click', showStatsModal);
            document.getElementById('view-tournament-stats-btn').addEventListener('click', showTournamentStats);
            document.getElementById('closeStats').addEventListener('click', function() {
                document.getElementById('statsModal').classList.remove('active');
            });
            
            // Close modal when clicking outside
            document.getElementById('statsModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
            
            console.log("Event listeners setup complete!");
        }
        
        // Set up team selection clicks
        function setupTeamSelectionEvents() {
            document.getElementById('teams-selection').addEventListener('click', function(e) {
                const teamSelect = e.target.closest('.team-select');
                if (!teamSelect) return;

                const selectedTeams = document.querySelectorAll('.team-select.selected');
                const isSelected = teamSelect.classList.contains('selected');

                if (isSelected) {
                    teamSelect.classList.remove('selected');
                } else {
                    if (selectedTeams.length < 2) {
                        teamSelect.classList.add('selected');
                    } else {
                        alert('You can only select two teams for the match.');
                    }
                }
                
                updateMatchPreview();
                
                const currentSelected = document.querySelectorAll('.team-select.selected');
                const tossWinnerSelect = document.getElementById('toss-winner');
                tossWinnerSelect.innerHTML = '';
                
                if (currentSelected.length > 0) {
                    currentSelected.forEach(teamElement => {
                        const teamId = parseInt(teamElement.getAttribute('data-team-id'));
                        const team = tournamentData.teams.find(t => t.id === teamId);
                        
                        const option = document.createElement('option');
                        option.value = team.id;
                        option.textContent = team.name;
                        tossWinnerSelect.appendChild(option);
                    });
                    
                    updateMatchPreview();
                }
            });
        }
        
        // Set up cricket scoring controls
        function setupCricketScoringControls() {
            console.log("Setting up cricket scoring controls...");
            
            // Get all cricket control buttons except the undo button
            const cricketControls = document.querySelectorAll('.premium-scoring-controls .control-btn-premium');
            
            cricketControls.forEach(button => {
                if (button.id !== 'undo-btn') {
                    button.addEventListener('click', function() {
                        if (!currentMatchState.isMatchStarted || tournamentData.sport !== 'cricket') {
                            alert("Please start the match first or ensure sport is cricket!");
                            return;
                        }
                        
                        const runs = this.getAttribute('data-runs');
                        const wicket = this.getAttribute('data-wicket');
                        const extra = this.getAttribute('data-extra');
                        
                        // Store action for undo
                        const action = {
                            type: 'cricket',
                            timestamp: new Date().getTime(),
                            cricketState: JSON.parse(JSON.stringify(cricketMatchState)),
                            matchState: JSON.parse(JSON.stringify(currentMatchState))
                        };
                        
                        if (runs !== null) {
                            addCricketRun(parseInt(runs));
                        } else if (wicket !== null) {
                            addCricketWicket();
                        } else if (extra === 'noball4') {
                            addCricketExtra('noball', 4);
                        } else if (extra === 'noball6') {
                            addCricketExtra('noball', 6);
                        } else if (extra !== null) {
                            addCricketExtra(extra, extra === 'wide' || extra === 'noball' ? 1 : 0);
                        }
                        
                        // Update player stats
                        updatePlayerStatsAfterBall();
                        
                        // Add to history
                        currentMatchState.actionHistory.push(action);
                        updateCricketDisplay();
                        updatePlayerDisplays();
                        updatePerformanceHighlights();
                        
                        // Check if innings is complete
                        if (cricketMatchState.wickets >= 10 || 
                            (currentMatchState.innings === 1 && cricketMatchState.currentOver >= tournamentData.sportSpecific.oversPerInnings) ||
                            (currentMatchState.innings === 2 && cricketMatchState.totalRuns > cricketMatchState.target)) {
                            if (currentMatchState.innings === 1) {
                                endFirstInnings();
                            } else {
                                endMatch();
                            }
                        }
                    });
                }
            });
            
            // Fix the undo button event listener
            document.getElementById('undo-btn').addEventListener('click', function() {
                if (tournamentData.sport === 'cricket') {
                    undoLastCricketAction();
                }
            });
            
            console.log("Cricket scoring controls setup complete!");
        }

        // Set up custom scoring controls
        function setupCustomScoringControls() {
            const customControls = document.querySelectorAll('#custom-scoring-controls .control-btn');
            
            customControls.forEach(button => {
                button.addEventListener('click', function() {
                    if (!currentMatchState.isMatchStarted || tournamentData.sport !== 'custom') {
                        alert("Please start the match first!");
                        return;
                    }

                    const actionType = this.getAttribute('data-action');
                    const score = parseInt(this.getAttribute('data-score'));
                    const team = parseInt(this.getAttribute('data-team'));

                    const action = {
                        type: 'custom',
                        timestamp: new Date().getTime(),
                        customState: JSON.parse(JSON.stringify(customMatchState)),
                        matchState: JSON.parse(JSON.stringify(currentMatchState))
                    };

                    if (actionType.includes('score')) {
                        addCustomScore(team, score);
                    } else if (actionType.includes('penalty')) {
                        addCustomEvent(`Penalty awarded to Team ${team === 1 ? '2' : '1'}`, team === 1 ? 2 : 1);
                    } else if (actionType === 'undo-custom') {
                        undoLastCustomAction();
                    }
                    
                    if (actionType !== 'undo-custom') {
                        currentMatchState.actionHistory.push(action);
                    }
                    updateCustomDisplay();
                });
            });
        }
        
        // Set up player tabs
        function setupPlayerTabs() {
            const playerTabs = document.querySelectorAll('.player-tab');
            const playerContents = document.querySelectorAll('.players-content');
            
            playerTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    
                    // Update active tab
                    playerTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show corresponding content
                    playerContents.forEach(content => {
                        content.classList.remove('active');
                        if (content.id === `${tabName}-content`) {
                            content.classList.add('active');
                        }
                    });
                });
            });
        }
        
        // Set up mobile menu toggle
        function setupMobileMenu() {
            const mobileMenuToggle = document.getElementById('mobileMenuToggle');
            const mainNav = document.querySelector('.main-nav');
            
            if (mobileMenuToggle && mainNav) {
                mobileMenuToggle.addEventListener('click', function() {
                    mainNav.classList.toggle('hidden-on-mobile');
                });
                
                document.addEventListener('click', function(e) {
                    if (window.innerWidth <= 768 && 
                        !e.target.closest('.main-nav') && 
                        !e.target.closest('#mobileMenuToggle') &&
                        !mainNav.classList.contains('hidden-on-mobile')) {
                        mainNav.classList.add('hidden-on-mobile');
                    }
                });
                
                if (window.innerWidth > 768) {
                    mainNav.classList.remove('hidden-on-mobile');
                }
                
                window.addEventListener('resize', function() {
                    if (window.innerWidth > 768) {
                        mainNav.classList.remove('hidden-on-mobile');
                    }
                });
            }
        }
        
        // Set up navigation between sections
        function setupNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            
            navItems.forEach(item => {
                item.addEventListener('click', function() {
                    const sectionId = this.getAttribute('data-section');
                    
                    navItems.forEach(nav => nav.classList.remove('active'));
                    this.classList.add('active');
                    
                    showSection(sectionId);
                    
                    if (sectionId === 'sport-dashboard') {
                        goToStep(1);
                    } else if (sectionId === 'tournament-setup') {
                        goToStep(2);
                    } else if (sectionId === 'live-scoring') {
                        if (currentMatchState.isMatchStarted) {
                            goToStep(5);
                        } else {
                            alert("Please set up and start a match first!");
                            document.querySelector('.nav-item[data-section="tournament-setup"]').click();
                        }
                    } else if (sectionId === 'winner-announcement') {
                        showSection('winner-announcement');
                    }
                });
            });
        }
        
        // Update UI based on selected sport
        function updateSportUI() {
            const sportName = tournamentData.sport.charAt(0).toUpperCase() + tournamentData.sport.slice(1);
            
            document.getElementById('selected-sport-name').textContent = sportName;
            document.getElementById('setup-title').textContent = `${sportName} Tournament Details`;
            
            const sportSpecificControls = {
                cricket: document.getElementById('cricket-controls'),
                football: document.getElementById('football-controls'),
                custom: document.getElementById('custom-controls')
            };
            
            Object.values(sportSpecificControls).forEach(control => {
                if (control) control.classList.remove('active');
            });
            
            if (sportSpecificControls[tournamentData.sport]) {
                sportSpecificControls[tournamentData.sport].classList.add('active');
            }
            
            updateSportFormLabels();
        }
        
        // Update form labels based on sport
        function updateSportFormLabels() {
            const tossTitle = document.getElementById('toss-title');
            const tossWinnerLabel = document.getElementById('toss-winner-label');
            const tossDecisionGroup = document.getElementById('toss-decision-group');
            
            switch(tournamentData.sport) {
                case 'cricket':
                    tossTitle.textContent = 'Toss Winner & Decision';
                    tossWinnerLabel.textContent = 'Toss Winner';
                    tossDecisionGroup.style.display = 'block';
                    document.getElementById('toss-decision').innerHTML = `
                        <option value="bat">Bat First</option>
                        <option value="bowl">Bowl First</option>
                    `;
                    break;
                case 'football':
                    tossTitle.textContent = 'Coin Toss & Choice';
                    tossWinnerLabel.textContent = 'Coin Toss Winner';
                    tossDecisionGroup.style.display = 'block';
                    document.getElementById('toss-decision').innerHTML = `
                        <option value="kickoff">Choose to Kick Off</option>
                        <option value="side">Choose Side</option>
                    `;
                    break;
                case 'custom':
                    tossTitle.textContent = 'Starting Choice';
                    tossWinnerLabel.textContent = 'Choice Winner';
                    tossDecisionGroup.style.display = 'block';
                    document.getElementById('toss-decision').innerHTML = `
                        <option value="start">Choose to Start</option>
                        <option value="receive">Choose to Receive</option>
                        <option value="side">Choose Side</option>
                    `;
                    break;
            }
        }
        
        // Navigate between steps with history tracking
        function goToStep(stepNumber) {
            if (stepNumber !== currentStep) {
                previousSteps.push(currentStep);
                currentStep = stepNumber;
            }
            
            const progressWidth = ((stepNumber - 1) / 4) * 100;
            document.getElementById('step-progress').style.setProperty('--progress-width', `${progressWidth}%`);
            
            const stepIndicators = document.querySelectorAll('.step-indicator');
            stepIndicators.forEach(indicator => {
                const step = parseInt(indicator.getAttribute('data-step'));
                if (step <= stepNumber) {
                    indicator.classList.add('active');
                } else {
                    indicator.classList.remove('active');
                }
            });
            
            if (stepNumber === 1) {
                showSection('sport-dashboard');
            } else if (stepNumber >= 2 && stepNumber <= 4) {
                showSection('tournament-setup');
                
                document.querySelectorAll('.setup-step').forEach(step => {
                    step.classList.remove('active');
                });
                
                if (stepNumber === 2) {
                    document.getElementById('step1').classList.add('active');
                } else if (stepNumber === 3) {
                    document.getElementById('step2').classList.add('active');
                } else if (stepNumber === 4) {
                    document.getElementById('step3').classList.add('active');
                }
            } else if (stepNumber === 5) {
                showSection('live-scoring');
            }
            
            updateNavigation();
        }
        
        // Update navigation based on current state
        function updateNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.classList.remove('active');
            });
            
            if (currentStep === 1) {
                document.querySelector('.nav-item[data-section="sport-dashboard"]').classList.add('active');
            } else if (currentStep >= 2 && currentStep <= 4) {
                document.querySelector('.nav-item[data-section="tournament-setup"]').classList.add('active');
            } else if (currentStep === 5) {
                document.querySelector('.nav-item[data-section="live-scoring"]').classList.add('active');
            }
        }
        
        // Show a specific section
        function showSection(sectionId) {
            const dashboardSections = document.querySelectorAll('.dashboard-section');
            dashboardSections.forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
            
            const mainNav = document.querySelector('.main-nav');
            if (window.innerWidth <= 768 && mainNav) {
                mainNav.classList.add('hidden-on-mobile');
            }
            
            if (sectionId === 'sport-dashboard') {
                currentStep = 1;
            } else if (sectionId === 'tournament-setup') {
                currentStep = 2;
            } else if (sectionId === 'live-scoring') {
                currentStep = 5;
            }
            
            updateNavigation();
        }
        
        // Update tournament data from form
        function updateTournamentFromForm() {
            tournamentData.name = document.getElementById('tournament-name').value || 'Champions League T20';
            
            switch(tournamentData.sport) {
                case 'cricket':
                    const oversCountSelect = document.getElementById('overs-count');
                    const customOversInput = document.getElementById('custom-overs-input');
                    const playersPerTeam = document.getElementById('players-per-team');
                    
                    if (oversCountSelect.value === 'custom' && customOversInput.value) {
                        tournamentData.sportSpecific.oversPerInnings = parseInt(customOversInput.value) || 20;
                    } else if (oversCountSelect.value !== 'custom') {
                        tournamentData.sportSpecific.oversPerInnings = parseInt(oversCountSelect.value) || 20;
                    }
                    
                    tournamentData.sportSpecific.playersPerTeam = parseInt(playersPerTeam.value) || 11;
                    break;
                    
                case 'football':
                    tournamentData.sportSpecific.matchDuration = parseInt(document.getElementById('football-duration').value) || 90;
                    tournamentData.sportSpecific.playersPerTeam = parseInt(document.getElementById('football-players').value) || 11;
                    break;
                    
                case 'custom':
                    tournamentData.name = document.getElementById('custom-sport-name').value + " Tournament" || 'Custom Tournament';
                    tournamentData.sportSpecific.playersPerTeam = parseInt(document.getElementById('custom-players-per-team').value) || 7;
                    tournamentData.sportSpecific.scoringUnit = document.getElementById('custom-scoring-unit').value || 'Points';
                    tournamentData.sportSpecific.durationUnit = document.getElementById('custom-duration-unit').value || 'Minutes';
                    break;
            }
            
            document.getElementById('tournament-name-display').textContent = tournamentData.name;
        }
        
        // Generate teams based on form data
        function generateTeams() {
            const teamCount = parseInt(document.getElementById('team-count').value) || 4;
            const teamsContainer = document.getElementById('teams-container');
            teamsContainer.innerHTML = '';
            
            const teamNameSuggestions = getTeamNameSuggestions();
            const playersPerTeam = tournamentData.sportSpecific.playersPerTeam || 11;
            
            for (let i = 0; i < teamCount; i++) {
                const teamCard = document.createElement('div');
                teamCard.className = 'team-card';
                teamCard.innerHTML = `
                    <div class="team-header">
                        <input type="text" class="team-name-input" value="${teamNameSuggestions[i] || `${tournamentData.sport.charAt(0).toUpperCase()}${tournamentData.sport.slice(1)} Team ${i+1}`}" data-team-index="${i}">
                        <div style="color: var(--accent-green);">T${i+1}</div>
                    </div>
                    <ul class="player-list" id="players-team-${i}">
                        </ul>
                `;
                teamsContainer.appendChild(teamCard);
                
                const playersList = document.getElementById(`players-team-${i}`);
                for (let j = 0; j < playersPerTeam; j++) {
                    const playerItem = document.createElement('li');
                    playerItem.className = 'player-item';
                    playerItem.innerHTML = `
                        <input type="text" class="player-name-input" placeholder="Player ${j+1}" value="Player ${j+1}">
                        <span style="color: var(--text-muted); font-size: 0.9rem;">#${j+1}</span>
                    `;
                    playersList.appendChild(playerItem);
                }
            }
            
            updateTeamsFromUI();
        }
        
        // Get team name suggestions based on sport
        function getTeamNameSuggestions() {
            switch(tournamentData.sport) {
                case 'cricket':
                    return [
                        "Mumbai Indians", "Chennai Super Kings", "Royal Challengers", 
                        "Kolkata Knight Riders", "Delhi Capitals", "Rajasthan Royals",
                        "Sunrisers Hyderabad", "Punjab Kings", "Gujarat Titans",
                        "Lucknow Super Giants", "Bangalore Blasters", "Hyderabad Strikers"
                    ];
                case 'football':
                    return [
                        "Manchester United", "Real Madrid", "Barcelona", 
                        "Bayern Munich", "Paris Saint-Germain", "Liverpool",
                        "Juventus", "AC Milan", "Chelsea", "Arsenal",
                        "Manchester City", "Tottenham Hotspur"
                    ];
                case 'custom':
                    return [
                        "Dragons", "Sharks", "Aces", "Tigers", "Hawks", "Spikers"
                    ];
                default:
                    return [];
            }
        }
        
        // Update teams data from UI
        function updateTeamsFromUI() {
            tournamentData.teams = [];
            const teamInputs = document.querySelectorAll('.team-name-input');
            
            teamInputs.forEach((input, index) => {
                const team = {
                    id: index + 1,
                    name: input.value || `Team ${index + 1}`,
                    players: []
                };
                
                const playerInputs = document.querySelectorAll(`#players-team-${index} .player-name-input`);
                playerInputs.forEach((playerInput, playerIndex) => {
                    team.players.push({
                        id: playerIndex + 1,
                        name: playerInput.value || `Player ${playerIndex + 1}`
                    });
                });
                
                tournamentData.teams.push(team);
            });
        }
        
        // Validate teams have names
        function validateTeams() {
            updateTeamsFromUI();
            
            for (const team of tournamentData.teams) {
                if (!team.name.trim()) {
                    alert(`Please enter a name for ${team.name}`);
                    return false;
                }
                
                for (const player of team.players) {
                    if (!player.name.trim()) {
                        alert(`Please enter names for all players in ${team.name}`);
                        return false;
                    }
                }
            }
            
            return true;
        }
        
        // Set up match configuration UI
        function setupMatchConfiguration() {
            updateTeamsFromUI();
            
            const teamsSelection = document.getElementById('teams-selection');
            const tossWinnerSelect = document.getElementById('toss-winner');
            teamsSelection.innerHTML = '';
            tossWinnerSelect.innerHTML = '';
            
            tournamentData.teams.forEach((team, index) => {
                const teamSelect = document.createElement('div');
                teamSelect.className = 'team-select';
                teamSelect.setAttribute('data-team-id', team.id);
                teamSelect.innerHTML = `
                    <div class="team-select-icon">T${team.id}</div>
                    <div>
                        <div style="font-weight: bold;">${team.name}</div>
                        <div style="font-size: 0.9rem; color: var(--text-muted);">${team.players.length} players</div>
                    </div>
                `;
                
                teamsSelection.appendChild(teamSelect);
                
                const option = document.createElement('option');
                option.value = team.id;
                option.textContent = team.name;
                tossWinnerSelect.appendChild(option);
            });
            
            if (tournamentData.teams.length >= 2) {
                setTimeout(() => {
                    const teamSelects = document.querySelectorAll('.team-select');
                    if (teamSelects.length >= 2) {
                        teamSelects[0].classList.add('selected');
                        teamSelects[1].classList.add('selected');
                        tossWinnerSelect.innerHTML = '';
                        [...document.querySelectorAll('.team-select.selected')].forEach(teamElement => {
                             const teamId = parseInt(teamElement.getAttribute('data-team-id'));
                             const team = tournamentData.teams.find(t => t.id === teamId);
                             const option = document.createElement('option');
                             option.value = team.id;
                             option.textContent = team.name;
                             tossWinnerSelect.appendChild(option);
                        });
                        updateMatchPreview();
                    }
                }, 100);
            }
        }
        
        // Update match preview based on selections
        function updateMatchPreview() {
            const selectedTeams = document.querySelectorAll('.team-select.selected');
            
            if (selectedTeams.length !== 2) {
                document.getElementById('preview-team1').textContent = 'T?';
                document.getElementById('preview-team1-name').textContent = 'Team 1';
                document.getElementById('preview-team2').textContent = 'T?';
                document.getElementById('preview-team2-name').textContent = 'Team 2';
                document.getElementById('preview-toss').textContent = 'Select 2 teams and decide toss';
                return;
            }
            
            const team1Id = parseInt(selectedTeams[0].getAttribute('data-team-id'));
            const team2Id = parseInt(selectedTeams[1].getAttribute('data-team-id'));
            
            const team1 = tournamentData.teams.find(t => t.id === team1Id);
            const team2 = tournamentData.teams.find(t => t.id === team2Id);
            
            if (!team1 || !team2) return;
            
            document.getElementById('preview-team1').textContent = `T${team1.id}`;
            document.getElementById('preview-team1-name').textContent = team1.name;
            document.getElementById('preview-team2').textContent = `T${team2.id}`;
            document.getElementById('preview-team2-name').textContent = team2.name;
            
            const tossWinnerSelect = document.getElementById('toss-winner');
            const tossWinnerId = parseInt(tossWinnerSelect.value);
            const tossDecision = document.getElementById('toss-decision').value;
            const tossWinner = tournamentData.teams.find(t => t.id === tossWinnerId);
            
            if (tossWinner) {
                let tossText = '';
                
                switch(tournamentData.sport) {
                    case 'cricket':
                        tossText = `${tossWinner.name} won toss and chose to ${tossDecision === 'bat' ? 'bat first' : 'bowl first'}`;
                        break;
                    case 'football':
                        tossText = `${tossWinner.name} won coin toss and chose to ${tossDecision === 'kickoff' ? 'kick off' : 'choose side'}`;
                        break;
                    case 'custom':
                        let decisionText = '';
                        if (tossDecision === 'start') decisionText = `start the ${tournamentData.sportSpecific.durationUnit.toLowerCase()}`;
                        else if (tossDecision === 'receive') decisionText = 'receive';
                        else decisionText = 'choose side';
                        tossText = `${tossWinner.name} won the choice and chose to ${decisionText}`;
                        break;
                    default:
                        tossText = `${tossWinner.name} won toss`;
                }
                
                document.getElementById('preview-toss').textContent = tossText;
            } else {
                 document.getElementById('preview-toss').textContent = 'Select toss winner';
            }
            
            let formatText = '';
            switch(tournamentData.sport) {
                case 'cricket':
                    formatText = `${tournamentData.sportSpecific.oversPerInnings} overs per innings`;
                    break;
                case 'football':
                    formatText = `${tournamentData.sportSpecific.matchDuration} minute match`;
                    break;
                case 'custom':
                    formatText = `Scoring: ${tournamentData.sportSpecific.scoringUnit} | Duration: ${tournamentData.sportSpecific.durationUnit}`;
                    break;
            }
            
            document.getElementById('preview-format-value').textContent = formatText;
        }
        
        // Set up the match based on selections
        function setupMatch() {
            const selectedTeams = document.querySelectorAll('.team-select.selected');
            
            if (selectedTeams.length !== 2) {
                alert('Please select two teams for the match');
                return false;
            }
            
            const team1Id = parseInt(selectedTeams[0].getAttribute('data-team-id'));
            const team2Id = parseInt(selectedTeams[1].getAttribute('data-team-id'));
            
            const team1 = tournamentData.teams.find(t => t.id === team1Id);
            const team2 = tournamentData.teams.find(t => t.id === team2Id);
            
            if (!team1 || !team2) {
                alert('Selected teams not found');
                return false;
            }
            
            currentMatchState.team1 = team1;
            currentMatchState.team2 = team2;
            currentMatchState.innings = 1;
            currentMatchState.isMatchStarted = true;
            currentMatchState.actionHistory = [];
            
            switch(tournamentData.sport) {
                case 'cricket':
                    const tossWinnerId = parseInt(document.getElementById('toss-winner').value);
                    const tossDecision = document.getElementById('toss-decision').value;
                    
                    let battingTeam, bowlingTeam;
                    
                    if (tossDecision === 'bat') {
                        battingTeam = tournamentData.teams.find(t => t.id === tossWinnerId);
                        bowlingTeam = battingTeam.id === team1.id ? team2 : team1;
                    } else {
                        bowlingTeam = tournamentData.teams.find(t => t.id === tossWinnerId);
                        battingTeam = bowlingTeam.id === team1.id ? team2 : team1;
                    }
                    
                    cricketMatchState = {
                        battingTeam: battingTeam,
                        bowlingTeam: bowlingTeam,
                        currentOver: 0,
                        ballsInOver: 0,
                        totalRuns: 0,
                        wickets: 0,
                        extras: 0,
                        overs: [],
                        currentOverBalls: [],
                        isFirstInningsComplete: false,
                        target: 0,
                        legalBallsThisOver: 0,
                        
                        batsmen: [],
                        bowlers: [],
                        fielders: [],
                        
                        striker: null,
                        nonStriker: null,
                        currentBowler: null,
                        
                        playerStats: {}
                    };
                    
                    // Initialize player stats
                    initializePlayerStats();
                    break;
                case 'custom':
                     customMatchState = {
                        team1Score: 0,
                        team2Score: 0,
                        durationUnit: tournamentData.sportSpecific.durationUnit,
                        currentDuration: 0,
                        scoringUnit: tournamentData.sportSpecific.scoringUnit,
                        events: []
                    };
                    break;
            }
            
            return true;
        }
        
        // Initialize player stats
        function initializePlayerStats() {
            // Initialize batting team players as batsmen
            cricketMatchState.batsmen = cricketMatchState.battingTeam.players.map(player => ({
                id: player.id,
                name: player.name,
                teamId: cricketMatchState.battingTeam.id,
                runs: 0,
                balls: 0,
                fours: 0,
                sixes: 0,
                isOut: false,
                howOut: null,
                bowler: null,
                fielder: null,
                isOnStrike: false
            }));
            
            // Initialize bowling team players as bowlers
            cricketMatchState.bowlers = cricketMatchState.bowlingTeam.players.map(player => ({
                id: player.id,
                name: player.name,
                teamId: cricketMatchState.bowlingTeam.id,
                overs: 0,
                balls: 0,
                runs: 0,
                wickets: 0,
                maidens: 0,
                wides: 0,
                noBalls: 0,
                isBowling: false
            }));
            
            // Initialize fielders
            cricketMatchState.fielders = cricketMatchState.bowlingTeam.players.map(player => ({
                id: player.id,
                name: player.name,
                teamId: cricketMatchState.bowlingTeam.id,
                catches: 0,
                runOuts: 0,
                stumpings: 0,
                assists: 0
            }));
            
            // Set initial striker and non-striker
            if (cricketMatchState.batsmen.length >= 2) {
                cricketMatchState.striker = cricketMatchState.batsmen[0];
                cricketMatchState.nonStriker = cricketMatchState.batsmen[1];
                cricketMatchState.striker.isOnStrike = true;
            }
            
            // Set initial bowler
            if (cricketMatchState.bowlers.length > 0) {
                cricketMatchState.currentBowler = cricketMatchState.bowlers[0];
                cricketMatchState.currentBowler.isBowling = true;
            }
            
            // Initialize player stats object
            cricketMatchState.playerStats = {};
            
            // Add all players to stats
            [...cricketMatchState.battingTeam.players, ...cricketMatchState.bowlingTeam.players].forEach(player => {
                cricketMatchState.playerStats[`${player.id}-${player.name}`] = {
                    playerId: player.id,
                    name: player.name,
                    teamId: cricketMatchState.battingTeam.players.some(p => p.id === player.id) ? 
                        cricketMatchState.battingTeam.id : cricketMatchState.bowlingTeam.id,
                    runs: 0,
                    balls: 0,
                    fours: 0,
                    sixes: 0,
                    wickets: 0,
                    overs: 0,
                    maidens: 0,
                    catches: 0,
                    runOuts: 0,
                    stumpings: 0,
                    assists: 0
                };
            });
        }
        
        // Start the match
        function startMatch() {
            document.getElementById('tournament-display-name').textContent = tournamentData.name;
            document.getElementById('team1-name-large').textContent = currentMatchState.team1.name;
            document.getElementById('team2-name-large').textContent = currentMatchState.team2.name;
            
            document.getElementById('team1-logo-large').textContent = `T${currentMatchState.team1.id}`;
            document.getElementById('team2-logo-large').textContent = `T${currentMatchState.team2.id}`;
            
            showSportSpecificUI();
            
            switch(tournamentData.sport) {
                case 'cricket':
                    document.getElementById('batting-team-name').textContent = cricketMatchState.battingTeam.name;
                    initializeCricketDisplay();
                    updatePlayerDisplays();
                    updatePerformanceHighlights();
                    break;
                case 'custom':
                    updateCustomDisplay();
                    break;
            }
            
            updateActionHistory();
            showNotification(`${tournamentData.sport.charAt(0).toUpperCase() + tournamentData.sport.slice(1)} match started!`, 'success');
        }
        
        // Show sport-specific UI
        function showSportSpecificUI() {
            document.querySelectorAll('.sport-specific-controls').forEach(el => {
                el.style.display = 'none';
            });
            
            document.querySelectorAll('.scorecard-container').forEach(el => {
                el.style.display = 'none';
            });
            
            document.getElementById(`${tournamentData.sport}-scoring-controls`).style.display = 'block';
            document.getElementById(`${tournamentData.sport}-scorecard`).style.display = 'grid';
            
            const endInningsBtn = document.getElementById('end-innings-btn');
            if (endInningsBtn) {
                if (tournamentData.sport === 'cricket') {
                    endInningsBtn.style.display = 'inline-flex';
                } else {
                    endInningsBtn.style.display = 'none';
                }
            }
            
            if (tournamentData.sport === 'custom') {
                document.getElementById('custom-controls-title').textContent = `${tournamentData.sportSpecific.scoringUnit} Controls`;
                document.getElementById('custom-match-title').textContent = `${tournamentData.name} Scoreboard`;
                
                document.querySelectorAll('#custom-scoring-controls span').forEach(span => {
                    const isPlural = span.id.includes('s');
                    span.textContent = isPlural ? tournamentData.sportSpecific.scoringUnit + (tournamentData.sportSpecific.scoringUnit.endsWith('s') ? '' : 's') : tournamentData.sportSpecific.scoringUnit;
                });
            }
        }
        
        // CRICKET FUNCTIONS
        
        // Add runs in cricket
        function addCricketRun(runs) {
            cricketMatchState.totalRuns += runs;
            cricketMatchState.legalBallsThisOver++;
            
            cricketMatchState.currentOverBalls.push({ 
                type: 'run', 
                value: runs,
                timestamp: new Date().getTime()
            });
            
            cricketMatchState.ballsInOver = cricketMatchState.legalBallsThisOver;
            
            if (cricketMatchState.legalBallsThisOver >= 6) {
                cricketMatchState.overs.push([...cricketMatchState.currentOverBalls]);
                cricketMatchState.currentOver++;
                cricketMatchState.currentOverBalls = [];
                cricketMatchState.legalBallsThisOver = 0;
                cricketMatchState.ballsInOver = 0;
                
                // Swap batsmen at the end of over
                swapBatsmen();
            }
        }
        
        // Add wicket in cricket
        function addCricketWicket() {
            cricketMatchState.wickets += 1;
            cricketMatchState.legalBallsThisOver++;
            
            cricketMatchState.currentOverBalls.push({ 
                type: 'wicket', 
                value: 'W',
                timestamp: new Date().getTime()
            });
            
            cricketMatchState.ballsInOver = cricketMatchState.legalBallsThisOver;
            
            if (cricketMatchState.legalBallsThisOver >= 6) {
                cricketMatchState.overs.push([...cricketMatchState.currentOverBalls]);
                cricketMatchState.currentOver++;
                cricketMatchState.currentOverBalls = [];
                cricketMatchState.legalBallsThisOver = 0;
                cricketMatchState.ballsInOver = 0;
                
                swapBatsmen();
            }
            
            // Mark current striker as out
            if (cricketMatchState.striker) {
                const batsman = cricketMatchState.batsmen.find(b => b.id === cricketMatchState.striker.id);
                if (batsman) {
                    batsman.isOut = true;
                    batsman.howOut = 'b';
                    batsman.bowler = cricketMatchState.currentBowler ? cricketMatchState.currentBowler.name : null;
                }
                
                // Bring in new batsman
                const newBatsman = cricketMatchState.batsmen.find(b => !b.isOut && b.id !== cricketMatchState.nonStriker.id);
                if (newBatsman) {
                    cricketMatchState.striker = newBatsman;
                    newBatsman.isOnStrike = true;
                }
            }
        }
        
        // Add extra in cricket
        function addCricketExtra(extraType, extraRuns = 0) {
            let runs = 1 + extraRuns;
            let symbol = '';
            let isLegalBall = false;
            
            switch(extraType) {
                case 'wide':
                    symbol = 'Wd';
                    runs = 1;
                    break;
                case 'noball':
                    symbol = extraRuns > 0 ? `Nb+${extraRuns}` : 'Nb';
                    runs = 1 + extraRuns;
                    break;
                case 'bye':
                    symbol = 'B';
                    runs = extraRuns;
                    isLegalBall = true;
                    break;
                case 'legbye':
                    symbol = 'Lb';
                    runs = extraRuns;
                    isLegalBall = true;
                    break;
            }
            
            cricketMatchState.extras += runs;
            cricketMatchState.totalRuns += runs;
            
            if (isLegalBall || extraType === 'bye' || extraType === 'legbye') {
                cricketMatchState.legalBallsThisOver++;
            }
            
            cricketMatchState.currentOverBalls.push({ 
                type: 'extra', 
                value: symbol,
                runs: runs,
                timestamp: new Date().getTime()
            });
            
            if (isLegalBall) {
                cricketMatchState.ballsInOver = cricketMatchState.legalBallsThisOver;
                
                if (cricketMatchState.legalBallsThisOver >= 6) {
                    cricketMatchState.overs.push([...cricketMatchState.currentOverBalls]);
                    cricketMatchState.currentOver++;
                    cricketMatchState.currentOverBalls = [];
                    cricketMatchState.legalBallsThisOver = 0;
                    cricketMatchState.ballsInOver = 0;
                    
                    swapBatsmen();
                }
            }
        }
        
        // Update player stats after each ball
        function updatePlayerStatsAfterBall() {
            // Update striker's stats if it was a run
            const lastBall = cricketMatchState.currentOverBalls[cricketMatchState.currentOverBalls.length - 1];
            
            if (lastBall && cricketMatchState.striker) {
                const batsman = cricketMatchState.batsmen.find(b => b.id === cricketMatchState.striker.id);
                const playerStatKey = `${cricketMatchState.striker.id}-${cricketMatchState.striker.name}`;
                
                if (batsman && cricketMatchState.playerStats[playerStatKey]) {
                    if (lastBall.type === 'run') {
                        batsman.runs += lastBall.value;
                        cricketMatchState.playerStats[playerStatKey].runs += lastBall.value;
                        batsman.balls++;
                        cricketMatchState.playerStats[playerStatKey].balls++;
                        
                        if (lastBall.value === 4) {
                            batsman.fours++;
                            cricketMatchState.playerStats[playerStatKey].fours++;
                        } else if (lastBall.value === 6) {
                            batsman.sixes++;
                            cricketMatchState.playerStats[playerStatKey].sixes++;
                        }
                        
                        // Swap batsmen for odd runs
                        if (lastBall.value % 2 !== 0) {
                            swapBatsmen();
                        }
                    } else if (lastBall.type === 'wicket') {
                        // Wicket already handled in addCricketWicket
                    }
                }
                
                // Update bowler's stats
                if (cricketMatchState.currentBowler) {
                    const bowlerStatKey = `${cricketMatchState.currentBowler.id}-${cricketMatchState.currentBowler.name}`;
                    
                    if (cricketMatchState.playerStats[bowlerStatKey]) {
                        // Update balls bowled
                        if (lastBall.type !== 'wide' && lastBall.type !== 'noball') {
                            cricketMatchState.currentBowler.balls++;
                            cricketMatchState.playerStats[bowlerStatKey].balls++;
                            
                            // Update overs if 6 balls completed
                            if (cricketMatchState.currentBowler.balls % 6 === 0) {
                                cricketMatchState.currentBowler.overs++;
                                cricketMatchState.playerStats[bowlerStatKey].overs++;
                            }
                        }
                        
                        // Update runs conceded
                        if (lastBall.type === 'run' || lastBall.type === 'extra') {
                            cricketMatchState.currentBowler.runs += lastBall.runs || lastBall.value || 0;
                            cricketMatchState.playerStats[bowlerStatKey].runs += lastBall.runs || lastBall.value || 0;
                        }
                        
                        // Update wickets
                        if (lastBall.type === 'wicket') {
                            cricketMatchState.currentBowler.wickets++;
                            cricketMatchState.playerStats[bowlerStatKey].wickets++;
                        }
                        
                        // Update extras
                        if (lastBall.type === 'wide') {
                            cricketMatchState.currentBowler.wides++;
                        } else if (lastBall.type === 'noball') {
                            cricketMatchState.currentBowler.noBalls++;
                        }
                    }
                }
            }
        }
        
        // Swap batsmen
        function swapBatsmen() {
            if (cricketMatchState.striker && cricketMatchState.nonStriker) {
                const temp = cricketMatchState.striker;
                cricketMatchState.striker = cricketMatchState.nonStriker;
                cricketMatchState.nonStriker = temp;
                
                cricketMatchState.striker.isOnStrike = true;
                cricketMatchState.nonStriker.isOnStrike = false;
                
                showNotification(`Batsmen swapped: ${cricketMatchState.striker.name} is now on strike`, 'info');
            }
        }
        
        // Change bowler
        function changeBowler() {
            if (!cricketMatchState.bowlers || cricketMatchState.bowlers.length < 2) {
                alert("Not enough bowlers available");
                return;
            }
            
            // Find next available bowler
            const currentIndex = cricketMatchState.bowlers.findIndex(b => b.id === cricketMatchState.currentBowler.id);
            let nextIndex = (currentIndex + 1) % cricketMatchState.bowlers.length;
            
            // Skip bowlers who are already out (if any logic needed)
            cricketMatchState.currentBowler.isBowling = false;
            cricketMatchState.currentBowler = cricketMatchState.bowlers[nextIndex];
            cricketMatchState.currentBowler.isBowling = true;
            
            showNotification(`Bowler changed: ${cricketMatchState.currentBowler.name} is now bowling`, 'info');
            updatePlayerDisplays();
        }
        
        // Undo last cricket action
        function undoLastCricketAction() {
            if (currentMatchState.actionHistory.length === 0) {
                showNotification('No actions to undo', 'warning');
                return;
            }
            
            const lastAction = currentMatchState.actionHistory.pop();
            
            if (lastAction.type === 'cricket') {
                cricketMatchState = lastAction.cricketState;
                currentMatchState.isMatchStarted = lastAction.matchState.isMatchStarted;
                currentMatchState.innings = lastAction.matchState.innings;
                currentMatchState.actionHistory = lastAction.matchState.actionHistory; 
                
                if (!cricketMatchState.battingTeam && currentMatchState.team1) {
                    cricketMatchState.battingTeam = currentMatchState.team1;
                    cricketMatchState.bowlingTeam = currentMatchState.team2;
                }
                
                updateCricketDisplay();
                updatePlayerDisplays();
                updatePerformanceHighlights();
                
                showNotification('Undid last action', 'success');
            } else {
                showNotification('Cannot undo this action', 'warning');
            }
        }
        
        // Update cricket display
        function updateCricketDisplay() {
            const score = `${cricketMatchState.totalRuns}/${cricketMatchState.wickets}`;
            const overDisplay = cricketMatchState.currentOver + 
                (cricketMatchState.ballsInOver > 0 ? `.${cricketMatchState.ballsInOver}` : '');
            
            // Update premium header
            const team1IsBatting = cricketMatchState.battingTeam.id === currentMatchState.team1.id;
            
            document.getElementById('team1-score-large').textContent = team1IsBatting ? score : 'To Bat';
            document.getElementById('team2-score-large').textContent = !team1IsBatting ? score : 'To Bat';
            
            document.getElementById('team1-innings-status').textContent = team1IsBatting ? 'Batting' : 'Bowling';
            document.getElementById('team2-innings-status').textContent = !team1IsBatting ? 'Batting' : 'Bowling';
            
            document.getElementById('team1-score-details').textContent = team1IsBatting ? `${overDisplay} Overs` : 'Target: -';
            document.getElementById('team2-score-details').textContent = !team1IsBatting ? `${overDisplay} Overs` : 'Target: -';
            
            if (currentMatchState.innings === 2) {
                document.getElementById('team2-score-details').textContent = `Target: ${cricketMatchState.target}`;
            }
            
            // Update scorecard
            document.getElementById('current-score-display').textContent = score;
            document.getElementById('batting-team-name').textContent = cricketMatchState.battingTeam.name;
            
            // Calculate match stats
            const totalBalls = tournamentData.sportSpecific.oversPerInnings * 6;
            const ballsBowled = cricketMatchState.currentOver * 6 + cricketMatchState.legalBallsThisOver;
            const ballsRemaining = Math.max(0, totalBalls - ballsBowled);
            
            const oversBowled = cricketMatchState.currentOver + (cricketMatchState.ballsInOver / 6);
            const runRate = oversBowled > 0 ? (cricketMatchState.totalRuns / oversBowled).toFixed(2) : '0.00';
            
            document.getElementById('current-run-rate').textContent = runRate;
            document.getElementById('balls-remaining').textContent = ballsRemaining;
            
            const projectedScore = oversBowled > 0 ? 
                Math.round((cricketMatchState.totalRuns / oversBowled) * tournamentData.sportSpecific.oversPerInnings) : 0;
            document.getElementById('projected-score').textContent = projectedScore;
            
            if (currentMatchState.innings === 2) {
                const remainingRuns = cricketMatchState.target - cricketMatchState.totalRuns;
                const requiredRate = ballsRemaining > 0 ? (remainingRuns / (ballsRemaining / 6)).toFixed(2) : '0.00';
                
                document.getElementById('required-run-rate').textContent = requiredRate;
                document.getElementById('runs-required').textContent = remainingRuns > 0 ? remainingRuns : 'Match Won';
            } else {
                document.getElementById('required-run-rate').textContent = '-';
                document.getElementById('runs-required').textContent = '-';
            }
            
            updateWicketsDisplay();
            updateOversDisplay();
            updateCurrentOverBalls();
        }
        
        // Initialize cricket display
        function initializeCricketDisplay() {
            updateWicketsDisplay();
            
            const oversBreakdown = document.getElementById('overs-breakdown');
            oversBreakdown.innerHTML = '';
            
            for (let i = 0; i < tournamentData.sportSpecific.oversPerInnings; i++) {
                const overCard = document.createElement('div');
                overCard.className = 'over-card';
                overCard.id = `over-${i+1}`;
                overCard.innerHTML = `
                    <div class="over-number">${i+1}</div>
                    <div class="over-runs">0</div>
                `;
                oversBreakdown.appendChild(overCard);
            }
            
            updateCricketDisplay();
        }
        
        // Update wickets display
        function updateWicketsDisplay() {
            const wicketsDisplay = document.getElementById('wickets-display');
            wicketsDisplay.innerHTML = '';
            
            for (let i = 0; i < 10; i++) {
                const wicketIndicator = document.createElement('div');
                wicketIndicator.className = `wicket-indicator ${i < cricketMatchState.wickets ? 'taken' : 'remaining'}`;
                wicketIndicator.textContent = i < cricketMatchState.wickets ? 'W' : i + 1;
                wicketsDisplay.appendChild(wicketIndicator);
            }
        }
        
        // Update overs display
        function updateOversDisplay() {
            cricketMatchState.overs.forEach((over, index) => {
                const overCard = document.getElementById(`over-${index + 1}`);
                if (overCard) {
                    const overRuns = over.reduce((sum, ball) => {
                        if (ball.type === 'run') return sum + ball.value;
                        if (ball.type === 'extra') return sum + (ball.runs || 0);
                        return sum;
                    }, 0);
                    
                    overCard.querySelector('.over-runs').textContent = overRuns;
                    
                    if (index === cricketMatchState.currentOver) {
                        overCard.classList.add('current');
                    } else {
                        overCard.classList.remove('current');
                    }
                }
            });
        }
        
        // Update current over balls
        function updateCurrentOverBalls() {
            const currentOverBallsContainer = document.getElementById('current-over-balls');
            currentOverBallsContainer.innerHTML = '';
            
            cricketMatchState.currentOverBalls.forEach((ball, index) => {
                const ballElement = document.createElement('div');
                ballElement.className = `ball ${ball.type === 'run' ? `run-${ball.value}` : ball.type} ${ball.type === 'extra' ? ball.value.toLowerCase() : ''}`;
                
                let displayText = '';
                if (ball.type === 'run') {
                    displayText = ball.value;
                } else if (ball.type === 'wicket') {
                    displayText = 'W';
                } else if (ball.type === 'extra') {
                    displayText = ball.value;
                }
                
                ballElement.textContent = displayText;
                ballElement.title = `Ball ${index + 1}: ${displayText}`;
                currentOverBallsContainer.appendChild(ballElement);
            });
            
            // Add placeholder balls for remaining balls in the over
            const remainingBalls = 6 - cricketMatchState.currentOverBalls.length;
            for (let i = 0; i < remainingBalls; i++) {
                const ballElement = document.createElement('div');
                ballElement.className = 'ball dot';
                ballElement.textContent = '';
                ballElement.title = `Ball ${cricketMatchState.currentOverBalls.length + i + 1}: Not yet bowled`;
                currentOverBallsContainer.appendChild(ballElement);
            }
        }
        
        // Update player displays
        function updatePlayerDisplays() {
            // Update batsmen list
            const batsmenList = document.getElementById('batsmen-list');
            batsmenList.innerHTML = '';
            
            cricketMatchState.batsmen.forEach(batsman => {
                const strikeRate = batsman.balls > 0 ? ((batsman.runs / batsman.balls) * 100).toFixed(2) : '0.00';
                
                const playerRow = document.createElement('div');
                playerRow.className = 'player-row';
                playerRow.innerHTML = `
                    <div class="player-name">
                        ${batsman.isOnStrike ? '<span class="player-status not-out"></span>' : 
                          batsman.isOut ? '<span class="player-status out"></span>' : 
                          '<span class="player-status"></span>'}
                        ${batsman.name} ${batsman.isOnStrike ? '(S)' : ''}
                    </div>
                    <div class="player-stat">${batsman.runs}</div>
                    <div class="player-stat">${batsman.balls}</div>
                    <div class="player-stat">${batsman.fours}</div>
                    <div class="player-stat">${batsman.sixes}</div>
                    <div class="player-stat">${strikeRate}</div>
                `;
                batsmenList.appendChild(playerRow);
            });
            
            // Update bowlers list
            const bowlersList = document.getElementById('bowlers-list');
            bowlersList.innerHTML = '';
            
            cricketMatchState.bowlers.forEach(bowler => {
                const overs = Math.floor(bowler.balls / 6) + (bowler.balls % 6) / 10;
                const economy = overs > 0 ? (bowler.runs / overs).toFixed(2) : '0.00';
                
                const playerRow = document.createElement('div');
                playerRow.className = 'player-row';
                playerRow.innerHTML = `
                    <div class="player-name">
                        ${bowler.isBowling ? '<span class="player-status not-out"></span>' : ''}
                        ${bowler.name} ${bowler.isBowling ? '(B)' : ''}
                    </div>
                    <div class="player-stat">${overs.toFixed(1)}</div>
                    <div class="player-stat">${bowler.runs}</div>
                    <div class="player-stat">${bowler.wickets}</div>
                    <div class="player-stat">${bowler.maidens}</div>
                    <div class="player-stat">${economy}</div>
                `;
                bowlersList.appendChild(playerRow);
            });
            
            // Update fielders list
            const fieldersList = document.getElementById('fielders-list');
            fieldersList.innerHTML = '';
            
            cricketMatchState.fielders.forEach(fielder => {
                const total = fielder.catches + fielder.runOuts + fielder.stumpings + fielder.assists;
                
                const playerRow = document.createElement('div');
                playerRow.className = 'player-row';
                playerRow.innerHTML = `
                    <div class="player-name">${fielder.name}</div>
                    <div class="player-stat">${fielder.catches}</div>
                    <div class="player-stat">${fielder.runOuts}</div>
                    <div class="player-stat">${fielder.stumpings}</div>
                    <div class="player-stat">${fielder.assists}</div>
                    <div class="player-stat">${total}</div>
                `;
                fieldersList.appendChild(playerRow);
            });
        }
        
        // Update performance highlights
        function updatePerformanceHighlights() {
            // Find top scorer
            let topScorer = null;
            let topRuns = -1;
            
            Object.values(cricketMatchState.playerStats).forEach(player => {
                if (player.runs > topRuns) {
                    topRuns = player.runs;
                    topScorer = player;
                }
            });
            
            if (topScorer) {
                const team = tournamentData.teams.find(t => t.id === topScorer.teamId);
                document.getElementById('top-scorer-name').textContent = topScorer.name;
                document.getElementById('top-scorer-team').textContent = team ? team.name : 'Unknown Team';
                document.getElementById('top-scorer-runs').textContent = topScorer.runs;
                
                const strikeRate = topScorer.balls > 0 ? ((topScorer.runs / topScorer.balls) * 100).toFixed(2) : '0.00';
                document.getElementById('top-scorer-sr').textContent = strikeRate;
            }
            
            // Find top wicket taker
            let topWicketTaker = null;
            let topWickets = -1;
            
            Object.values(cricketMatchState.playerStats).forEach(player => {
                if (player.wickets > topWickets) {
                    topWickets = player.wickets;
                    topWicketTaker = player;
                }
            });
            
            if (topWicketTaker) {
                const team = tournamentData.teams.find(t => t.id === topWicketTaker.teamId);
                document.getElementById('top-wicket-taker-name').textContent = topWicketTaker.name;
                document.getElementById('top-wicket-taker-team').textContent = team ? team.name : 'Unknown Team';
                document.getElementById('top-wicket-taker-wickets').textContent = topWicketTaker.wickets;
                
                const economy = topWicketTaker.overs > 0 ? (topWicketTaker.runs / topWicketTaker.overs).toFixed(2) : '0.00';
                document.getElementById('top-wicket-taker-econ').textContent = economy;
            }
            
            // Find best fielder
            let bestFielder = null;
            let topFieldingPoints = -1;
            
            Object.values(cricketMatchState.playerStats).forEach(player => {
                const fieldingPoints = player.catches * 2 + player.runOuts * 3 + player.stumpings * 3 + player.assists;
                if (fieldingPoints > topFieldingPoints) {
                    topFieldingPoints = fieldingPoints;
                    bestFielder = player;
                }
            });
            
            if (bestFielder) {
                const team = tournamentData.teams.find(t => t.id === bestFielder.teamId);
                document.getElementById('best-fielder-name').textContent = bestFielder.name;
                document.getElementById('best-fielder-team').textContent = team ? team.name : 'Unknown Team';
                document.getElementById('best-fielder-catches').textContent = bestFielder.catches;
                document.getElementById('best-fielder-assists').textContent = bestFielder.assists;
            }
        }
        
        // End first innings in cricket
        function endFirstInnings() {
            cricketMatchState.isFirstInningsComplete = true;
            cricketMatchState.target = cricketMatchState.totalRuns + 1;
            
            const firstInningsTeamId = cricketMatchState.battingTeam.id;
            const finalScore = {
                runs: cricketMatchState.totalRuns,
                wickets: cricketMatchState.wickets,
                overs: cricketMatchState.currentOver + (cricketMatchState.ballsInOver / 6)
            };
            
            const temp = cricketMatchState.battingTeam;
            cricketMatchState.battingTeam = cricketMatchState.bowlingTeam;
            cricketMatchState.bowlingTeam = temp;
            
            currentMatchState.innings = 2;
            cricketMatchState.currentOver = 0;
            cricketMatchState.ballsInOver = 0;
            cricketMatchState.totalRuns = 0;
            cricketMatchState.wickets = 0;
            cricketMatchState.extras = 0;
            cricketMatchState.overs = [];
            cricketMatchState.currentOverBalls = [];
            cricketMatchState.legalBallsThisOver = 0;
            currentMatchState.actionHistory = [];
            
            // Reset player stats for new innings
            initializePlayerStats();
            
            document.getElementById('match-status-text').textContent = '2ND INNINGS';
            updateCricketDisplay();
            updatePlayerDisplays();
            updatePerformanceHighlights();
            
            showNotification(`First innings complete! ${cricketMatchState.bowlingTeam.name} needs ${cricketMatchState.target} runs to win.`, 'success');
        }

        // CUSTOM SPORT FUNCTIONS
        
        function addCustomScore(team, score) {
            if (team === 1) {
                customMatchState.team1Score += score;
            } else {
                customMatchState.team2Score += score;
            }
            addCustomEvent(`${score} ${tournamentData.sportSpecific.scoringUnit} added to ${currentMatchState[`team${team}`].name}`, team);
        }

        function addCustomEvent(description, team = 0) {
            customMatchState.events.unshift({
                desc: description,
                team: team,
                timestamp: new Date().getTime()
            });
        }

        function undoLastCustomAction() {
            if (currentMatchState.actionHistory.length === 0) {
                showNotification('No actions to undo', 'warning');
                return;
            }

            const lastAction = currentMatchState.actionHistory.pop();
            
            if (lastAction.type === 'custom') {
                customMatchState = lastAction.customState;
                currentMatchState.actionHistory = lastAction.matchState.actionHistory; 
                updateCustomDisplay();
                showNotification('Undid last action', 'success');
            } else {
                showNotification('Cannot undo this action', 'warning');
            }
        }
        
        function updateCustomDisplay() {
            document.getElementById('custom-team1-name').textContent = currentMatchState.team1.name;
            document.getElementById('custom-team2-name').textContent = currentMatchState.team2.name;
            document.getElementById('custom-team1-score').textContent = customMatchState.team1Score;
            document.getElementById('custom-team2-score').textContent = customMatchState.team2Score;
            document.getElementById('custom-duration-display').textContent = `Duration: ${customMatchState.currentDuration} ${customMatchState.durationUnit}`;
        }

        // COMMON FUNCTIONS
        
        // Update action history
        function updateActionHistory() {
            // Removed as per requirement
        }
        
        // Show notification
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.textContent = message;
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.padding = '15px 20px';
            notification.style.backgroundColor = type === 'success' ? '#00c853' : 
                                               type === 'warning' ? '#ff9800' : 
                                               type === 'danger' ? '#f44336' : '#00ff8b';
            notification.style.color = 'white';
            notification.style.borderRadius = '8px';
            notification.style.zIndex = '1000';
            notification.style.boxShadow = '0 8px 24px rgba(0, 0, 0, 0.3)';
            notification.style.animation = 'fadeIn 0.3s ease';
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                const fadeOut = notification.animate([
                    { opacity: 1 },
                    { opacity: 0 }
                ], {
                    duration: 300,
                    easing: 'ease-out'
                });
                
                fadeOut.onfinish = () => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                };
            }, 3000);
        }
        
        // End match and declare winner
        function endMatch() {
            let winner = null, resultSummary;
            
            switch(tournamentData.sport) {
                case 'cricket':
                    const score1 = currentMatchState.team1Score || {runs: 0, wickets: 0};
                    const score2 = currentMatchState.team2Score || {runs: 0, wickets: 0};
                    
                    const lastTeamId = cricketMatchState.battingTeam.id;
                    const finalScoreLast = {
                        runs: cricketMatchState.totalRuns,
                        wickets: cricketMatchState.wickets,
                        overs: cricketMatchState.currentOver + (cricketMatchState.ballsInOver / 6)
                    };
                    
                    if (currentMatchState.team1.id === lastTeamId) {
                        currentMatchState.team1Score = finalScoreLast;
                    } else {
                        currentMatchState.team2Score = finalScoreLast;
                    }

                    const s1 = currentMatchState.team1Score;
                    const s2 = currentMatchState.team2Score;
                    
                    if (s1.runs > s2.runs) {
                        winner = currentMatchState.team1;
                        if (currentMatchState.innings === 1) {
                             resultSummary = `${winner.name} won by declaration`;
                        } else if (currentMatchState.team1.id === lastTeamId) {
                             resultSummary = `${winner.name} won by ${10 - s1.wickets} wickets`;
                        } else {
                             resultSummary = `${winner.name} won by ${s1.runs - s2.runs} runs`;
                        }
                    } else if (s2.runs > s1.runs) {
                        winner = currentMatchState.team2;
                        if (currentMatchState.innings === 1) {
                            resultSummary = `${winner.name} won by declaration`;
                        } else if (currentMatchState.team2.id === lastTeamId) {
                             resultSummary = `${winner.name} won by ${10 - s2.wickets} wickets`;
                        } else {
                             resultSummary = `${winner.name} won by ${s2.runs - s1.runs} runs`;
                        }
                    } else {
                        resultSummary = "Match Tied";
                        winner = null;
                    }
                    
                    // Set man of the match based on performance highlights
                    const topScorerName = document.getElementById('top-scorer-name').textContent;
                    const topWicketTakerName = document.getElementById('top-wicket-taker-name').textContent;
                    
                    document.getElementById('man-of-match').textContent = topScorerName !== '-' ? topScorerName : 
                        topWicketTakerName !== '-' ? topWicketTakerName : 'To be decided';
                    document.getElementById('best-bowler').textContent = topWicketTakerName;
                    document.getElementById('best-batsman').textContent = topScorerName;
                    
                    break;
                
                case 'custom':
                    if (customMatchState.team1Score > customMatchState.team2Score) {
                        winner = currentMatchState.team1;
                        resultSummary = `${winner.name} won by ${customMatchState.team1Score - customMatchState.team2Score} ${tournamentData.sportSpecific.scoringUnit}`;
                    } else if (customMatchState.team2Score > customMatchState.team1Score) {
                         winner = currentMatchState.team2;
                        resultSummary = `${winner.name} won by ${customMatchState.team2Score - customMatchState.team1Score} ${tournamentData.sportSpecific.scoringUnit}`;
                    } else {
                        resultSummary = "Match Tied";
                        winner = null;
                    }
                    
                    currentMatchState.team1Score = {runs: customMatchState.team1Score, wickets: 0, overs: 0};
                    currentMatchState.team2Score = {runs: customMatchState.team2Score, wickets: 0, overs: 0};
                    break;

                default:
                    winner = currentMatchState.team1;
                    resultSummary = `${winner.name} won the match`;
            }
            
            if (winner) {
                document.getElementById('match-winner').textContent = winner.name;
            } else {
                document.getElementById('match-winner').textContent = 'DRAW';
            }
            
            document.getElementById('match-result-summary').textContent = resultSummary;
            
            const s1 = currentMatchState.team1Score || {runs: 0, wickets: 0, overs: 0};
            const s2 = currentMatchState.team2Score || {runs: 0, wickets: 0, overs: 0};
            
            document.getElementById('result-team1-name').textContent = currentMatchState.team1.name;
            document.getElementById('result-team2-name').textContent = currentMatchState.team2.name;
            
            if (tournamentData.sport === 'cricket') {
                document.getElementById('result-team1-score').textContent = `${s1.runs}/${s1.wickets} (${s1.overs.toFixed(1)} Ov)`;
                document.getElementById('result-team2-score').textContent = `${s2.runs}/${s2.wickets} (${s2.overs.toFixed(1)} Ov)`;
            } else if (tournamentData.sport === 'custom') {
                 const unit = tournamentData.sportSpecific.scoringUnit;
                 document.getElementById('result-team1-score').textContent = `${s1.runs} ${unit}`;
                 document.getElementById('result-team2-score').textContent = `${s2.runs} ${unit}`;
            } else {
                 document.getElementById('result-team1-score').textContent = `Score: ${s1.runs}`;
                 document.getElementById('result-team2-score').textContent = `Score: ${s2.runs}`;
            }

            showSection('winner-announcement');
            document.querySelector('.nav-item[data-section="winner-announcement"]').classList.add('active');
        }
        
        // Show stats modal
        function showStatsModal() {
            const statsContent = document.getElementById('stats-content');
            let statsHTML = '';
            
            switch(tournamentData.sport) {
                case 'cricket':
                    const totalBalls = cricketMatchState.currentOver * 6 + cricketMatchState.legalBallsThisOver;
                    const oversBowled = cricketMatchState.currentOver + (cricketMatchState.ballsInOver / 6);
                    const runRate = oversBowled > 0 ? (cricketMatchState.totalRuns / oversBowled).toFixed(2) : '0.00';
                    const boundaryRuns = cricketMatchState.overs.flat().concat(cricketMatchState.currentOverBalls)
                        .filter(ball => ball.type === 'run' && (ball.value === 4 || ball.value === 6))
                        .reduce((sum, ball) => sum + ball.value, 0);
                    const boundaryCount = cricketMatchState.overs.flat().concat(cricketMatchState.currentOverBalls)
                        .filter(ball => ball.type === 'run' && (ball.value === 4 || ball.value === 6)).length;
                    
                    statsHTML = `
                        <h4>Detailed Match Statistics</h4>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-label">Total Runs</div>
                                <div class="stat-value">${cricketMatchState.totalRuns}</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Wickets</div>
                                <div class="stat-value">${cricketMatchState.wickets}</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Extras</div>
                                <div class="stat-value">${cricketMatchState.extras}</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Run Rate</div>
                                <div class="stat-value">${runRate}</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Overs</div>
                                <div class="stat-value">${oversBowled.toFixed(1)}</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Balls</div>
                                <div class="stat-value">${totalBalls}</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Boundaries (4s/6s)</div>
                                <div class="stat-value">${boundaryCount}</div>
                                <div class="stat-label">${boundaryRuns} runs from boundaries</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Target</div>
                                <div class="stat-value">${cricketMatchState.target > 0 ? cricketMatchState.target : 'N/A'}</div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 30px;">
                            <h4>Player Statistics</h4>
                            <div style="overflow-x: auto;">
                                <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
                                    <thead>
                                        <tr style="background-color: rgba(0, 255, 139, 0.1);">
                                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--accent-green);">Player</th>
                                            <th style="padding: 10px; text-align: center; border-bottom: 2px solid var(--accent-green);">Runs</th>
                                            <th style="padding: 10px; text-align: center; border-bottom: 2px solid var(--accent-green);">Balls</th>
                                            <th style="padding: 10px; text-align: center; border-bottom: 2px solid var(--accent-green);">4s</th>
                                            <th style="padding: 10px; text-align: center; border-bottom: 2px solid var(--accent-green);">6s</th>
                                            <th style="padding: 10px; text-align: center; border-bottom: 2px solid var(--accent-green);">Wickets</th>
                                            <th style="padding: 10px; text-align: center; border-bottom: 2px solid var(--accent-green);">Catches</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${Object.values(cricketMatchState.playerStats).map(player => `
                                            <tr style="border-bottom: 1px solid var(--border-color);">
                                                <td style="padding: 10px;">${player.name}</td>
                                                <td style="padding: 10px; text-align: center;">${player.runs}</td>
                                                <td style="padding: 10px; text-align: center;">${player.balls}</td>
                                                <td style="padding: 10px; text-align: center;">${player.fours}</td>
                                                <td style="padding: 10px; text-align: center;">${player.sixes}</td>
                                                <td style="padding: 10px; text-align: center;">${player.wickets}</td>
                                                <td style="padding: 10px; text-align: center;">${player.catches}</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    `;
                    break;
                case 'custom':
                    statsHTML = `
                        <h4>${tournamentData.name} Statistics</h4>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-label">${currentMatchState.team1.name} ${tournamentData.sportSpecific.scoringUnit}</div>
                                <div class="stat-value">${customMatchState.team1Score}</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">${currentMatchState.team2.name} ${tournamentData.sportSpecific.scoringUnit}</div>
                                <div class="stat-value">${customMatchState.team2Score}</div>
                            </div>
                             <div class="stat-card">
                                <div class="stat-label">Duration Unit</div>
                                <div class="stat-value">${customMatchState.durationUnit}</div>
                            </div>
                        </div>
                    `;
                    break;
                 default:
                    statsHTML = `<p>No detailed statistics are available for ${tournamentData.sport} yet.</p>`;
            }
            
            document.getElementById('statsModal').classList.add('active');
            document.getElementById('stats-content').innerHTML = statsHTML;
        }
        
        // Show tournament stats
        function showTournamentStats() {
            const statsContent = document.getElementById('stats-content');
            
            statsContent.innerHTML = `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Tournament</div>
                        <div class="stat-value">${tournamentData.name}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Sport</div>
                        <div class="stat-value">${tournamentData.sport.charAt(0).toUpperCase() + tournamentData.sport.slice(1)}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Total Teams</div>
                        <div class="stat-value">${tournamentData.teams.length}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Players per Team</div>
                        <div class="stat-value">${tournamentData.sportSpecific.playersPerTeam || 'N/A'}</div>
                    </div>
                </div>
                
                <div style="margin-top: 30px;">
                    <h4>Teams</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
                        ${tournamentData.teams.map(team => `
                            <div style="background-color: #141a2a; padding: 15px; border-radius: 8px;">
                                <div style="font-weight: bold; color: #00ff8b;">${team.name}</div>
                                <div style="font-size: 0.9rem; color: #b0b7cb; margin-top: 5px;">${team.players.length} players</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            document.getElementById('statsModal').classList.add('active');
        }
        
        // Reset match state for a new match
        function resetMatchState() {
            currentMatchState = {
                sport: tournamentData.sport,
                team1: null,
                team2: null,
                innings: 1,
                isMatchStarted: false,
                actionHistory: [],
                team1Score: null,
                team2Score: null
            };
            
            cricketMatchState = {
                battingTeam: null,
                bowlingTeam: null,
                currentOver: 0,
                ballsInOver: 0,
                totalRuns: 0,
                wickets: 0,
                extras: 0,
                overs: [],
                currentOverBalls: [],
                isFirstInningsComplete: false,
                target: 0,
                legalBallsThisOver: 0,
                
                batsmen: [],
                bowlers: [],
                fielders: [],
                
                striker: null,
                nonStriker: null,
                currentBowler: null,
                
                playerStats: {}
            };
            
            customMatchState = {
                team1Score: 0,
                team2Score: 0,
                durationUnit: 'Minutes',
                currentDuration: 0,
                scoringUnit: 'Points',
                events: []
            };
            
            setupMatchConfiguration();
        }
        
        // Initialize the app when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log("DOM loaded, initializing app...");
            initApp();
        });
    </script>
</body>
            </html>
