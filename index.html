<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CricketScore Pro | Professional Scoring</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-dark: #0F1419;
            --secondary-dark: #1A2029;
            --card-dark: #212934;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B7C3;
            --text-muted: #6C7486;
            --accent-green: #2ECC71;
            --accent-blue: #3498DB;
            --accent-red: #E74C3C;
            --accent-yellow: #F1C40F;
            --accent-purple: #9B59B6;
            --border-color: #2D3748;
            --transition: all 0.2s ease;
            --border-radius: 6px;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--primary-dark);
            color: var(--text-primary);
            line-height: 1.5;
            overflow-x: hidden;
            font-size: 15px;
        }
        
        h1, h2, h3, h4, h5 {
            font-weight: 600;
            letter-spacing: -0.01em;
        }
        
        /* Header */
        .app-header {
            background-color: var(--secondary-dark);
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.4rem;
            font-weight: 700;
        }
        
        .logo-icon {
            color: var(--accent-green);
        }
        
        .match-info {
            text-align: center;
        }
        
        .match-tournament {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }
        
        .match-teams {
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .match-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: var(--accent-green);
            font-weight: 500;
        }
        
        .live-indicator {
            width: 8px;
            height: 8px;
            background-color: var(--accent-red);
            border-radius: 50%;
            animation: subtlePulse 2s infinite;
        }
        
        @keyframes subtlePulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        /* Main Container */
        .app-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Sport Selection */
        .sport-selection {
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            padding: 24px;
            margin-bottom: 24px;
            border: 1px solid var(--border-color);
            text-align: center;
        }
        
        .sport-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-top: 20px;
        }
        
        .sport-card {
            background-color: var(--card-dark);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 20px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
        }
        
        .sport-card:hover {
            background-color: rgba(255, 255, 255, 0.05);
            border-color: var(--accent-green);
        }
        
        .sport-card.selected {
            border-color: var(--accent-green);
            background-color: rgba(46, 204, 113, 0.1);
        }
        
        .sport-icon {
            font-size: 2.5rem;
            color: var(--accent-green);
        }
        
        .sport-name {
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        /* Setup Section */
        .setup-section {
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            padding: 24px;
            margin-bottom: 24px;
            border: 1px solid var(--border-color);
        }
        
        .setup-form {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        
        .form-group {
            margin-bottom: 16px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-secondary);
        }
        
        .form-control {
            width: 100%;
            background-color: var(--card-dark);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 12px 16px;
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            font-size: 0.95rem;
            transition: var(--transition);
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--accent-green);
        }
        
        /* Teams Setup */
        .teams-section {
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            padding: 24px;
            margin-bottom: 24px;
            border: 1px solid var(--border-color);
        }
        
        .teams-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        
        .team-card {
            background-color: var(--card-dark);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 20px;
        }
        
        .team-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .team-name-input {
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 1.2rem;
            font-weight: 600;
            width: 100%;
        }
        
        .team-name-input:focus {
            outline: none;
            border-bottom: 2px solid var(--accent-green);
        }
        
        .player-list {
            list-style: none;
        }
        
        .player-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.05);
        }
        
        .player-item:last-child {
            border-bottom: none;
        }
        
        .player-input {
            background: transparent;
            border: none;
            color: var(--text-primary);
            width: 70%;
            padding: 4px;
        }
        
        .player-input:focus {
            outline: none;
            border-bottom: 1px solid var(--accent-green);
        }
        
        /* Score Summary - Side by Side */
        .score-summary {
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            padding: 24px;
            margin-bottom: 24px;
            border: 1px solid var(--border-color);
            opacity: 0;
            animation: fadeIn 0.3s ease forwards;
            animation-delay: 0.1s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .teams-side-by-side {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .team-score-card {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 20px;
            border: 1px solid var(--border-color);
            transition: var(--transition);
        }
        
        .team-score-card.batting {
            border-color: var(--accent-green);
            background-color: rgba(46, 204, 113, 0.05);
        }
        
        .team-name {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .team-score {
            display: flex;
            align-items: baseline;
            gap: 8px;
            margin-bottom: 4px;
        }
        
        .runs {
            font-size: 3.5rem;
            font-weight: 700;
            line-height: 1;
        }
        
        .wickets {
            font-size: 2rem;
            color: var(--accent-red);
            font-weight: 700;
        }
        
        .overs {
            font-size: 1.5rem;
            color: var(--text-secondary);
            font-weight: 600;
        }
        
        .run-rate {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-top: 4px;
        }
        
        .target-info {
            padding-top: 16px;
            border-top: 1px solid var(--border-color);
            text-align: center;
            font-size: 1.1rem;
            color: var(--accent-green);
            font-weight: 500;
        }
        
        /* Match Details */
        .match-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }
        
        .detail-card {
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            padding: 20px;
            border: 1px solid var(--border-color);
            opacity: 0;
            animation: fadeIn 0.3s ease forwards;
        }
        
        .detail-card:nth-child(1) { animation-delay: 0.2s; }
        .detail-card:nth-child(2) { animation-delay: 0.3s; }
        .detail-card:nth-child(3) { animation-delay: 0.4s; }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .card-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Batters */
        .batter {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: var(--transition);
        }
        
        .batter:hover {
            background-color: rgba(255, 255, 255, 0.02);
        }
        
        .batter-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .strike-indicator {
            width: 6px;
            height: 6px;
            background-color: var(--accent-green);
            border-radius: 50%;
        }
        
        .batter-name {
            font-weight: 500;
        }
        
        .batter-stats {
            text-align: right;
        }
        
        .batter-runs {
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .batter-details {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        /* Bowlers */
        .bowler {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .bowler-name {
            font-weight: 500;
        }
        
        .bowler-stats {
            text-align: right;
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .bowler-economy {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        /* Over Progress */
        .over-container {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 12px;
        }
        
        .ball {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.85rem;
            transition: var(--transition);
        }
        
        .ball:hover {
            transform: scale(1.05);
        }
        
        .ball-dot {
            background-color: rgba(255, 255, 255, 0.08);
            color: var(--text-muted);
        }
        
        .ball-run {
            background-color: rgba(46, 204, 113, 0.15);
            color: var(--accent-green);
            border: 1px solid rgba(46, 204, 113, 0.3);
        }
        
        .ball-four {
            background-color: rgba(52, 152, 219, 0.15);
            color: var(--accent-blue);
            border: 1px solid rgba(52, 152, 219, 0.3);
        }
        
        .ball-six {
            background-color: rgba(241, 196, 15, 0.15);
            color: var(--accent-yellow);
            border: 1px solid rgba(241, 196, 15, 0.3);
        }
        
        .ball-wicket {
            background-color: rgba(231, 76, 60, 0.15);
            color: var(--accent-red);
            border: 1px solid rgba(231, 76, 60, 0.3);
        }
        
        .ball-wide, .ball-noball {
            background-color: rgba(155, 89, 182, 0.15);
            color: var(--accent-purple);
            border: 1px solid rgba(155, 89, 182, 0.3);
        }
        
        .over-info {
            display: flex;
            justify-content: space-between;
            margin-top: 16px;
            padding-top: 12px;
            border-top: 1px solid var(--border-color);
        }
        
        /* Single/Double Batter Mode */
        .batter-mode-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
            margin-bottom: 20px;
        }
        
        .toggle-label {
            font-weight: 500;
            color: var(--text-secondary);
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 26px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--border-color);
            transition: var(--transition);
            border-radius: 34px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 4px;
            bottom: 4px;
            background-color: var(--text-primary);
            transition: var(--transition);
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: var(--accent-green);
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(24px);
        }
        
        /* Scoring Controls */
        .scoring-section {
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            padding: 24px;
            border: 1px solid var(--border-color);
            margin-bottom: 24px;
            opacity: 0;
            animation: fadeIn 0.3s ease forwards;
            animation-delay: 0.5s;
        }
        
        .scoring-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .runs-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .run-btn {
            background-color: var(--card-dark);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 16px 10px;
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
        }
        
        .run-btn:hover {
            background-color: rgba(255, 255, 255, 0.05);
            transform: translateY(-2px);
        }
        
        .run-btn.run-0 {
            color: var(--text-secondary);
        }
        
        .run-btn.run-1, .run-btn.run-2, .run-btn.run-3 {
            color: var(--accent-green);
            border-color: rgba(46, 204, 113, 0.3);
        }
        
        .run-btn.run-4 {
            color: var(--accent-blue);
            border-color: rgba(52, 152, 219, 0.3);
        }
        
        .run-btn.run-6 {
            color: var(--accent-yellow);
            border-color: rgba(241, 196, 15, 0.3);
        }
        
        .wicket-btn {
            background-color: rgba(231, 76, 60, 0.1);
            color: var(--accent-red);
            border: 1px solid rgba(231, 76, 60, 0.3);
        }
        
        .extras-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .extra-btn {
            background-color: var(--card-dark);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 12px 6px;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
        }
        
        .extra-btn:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }
        
        .extra-btn.wide {
            color: var(--accent-purple);
            border-color: rgba(155, 89, 182, 0.3);
        }
        
        .extra-btn.noball {
            color: #E67E22;
            border-color: rgba(230, 126, 34, 0.3);
        }
        
        .action-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .action-btn {
            background-color: transparent;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 10px 16px;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .action-btn:hover {
            background-color: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
        }
        
        .action-btn.primary {
            background-color: var(--accent-green);
            color: var(--primary-dark);
            border-color: var(--accent-green);
            font-weight: 600;
        }
        
        .action-btn.primary:hover {
            background-color: #27ae60;
        }
        
        /* Navigation */
        .nav-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 24px;
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            padding: 16px;
            border: 1px solid var(--border-color);
        }
        
        .step-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: var(--transition);
            padding: 8px 12px;
            border-radius: var(--border-radius);
            flex: 1;
            text-align: center;
        }
        
        .step-item:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }
        
        .step-item.active {
            color: var(--accent-green);
        }
        
        .step-number {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            background-color: var(--card-dark);
            border: 2px solid var(--border-color);
            transition: var(--transition);
        }
        
        .step-item.active .step-number {
            background-color: var(--accent-green);
            color: var(--primary-dark);
            border-color: var(--accent-green);
        }
        
        .step-label {
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--text-secondary);
        }
        
        .step-item.active .step-label {
            color: var(--accent-green);
        }
        
        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            padding: 30px;
            max-width: 500px;
            width: 100%;
            border: 1px solid var(--border-color);
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .modal-title {
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 4px;
        }
        
        .modal-close:hover {
            color: var(--text-primary);
        }
        
        .player-list-modal {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 16px;
        }
        
        .player-item-modal {
            padding: 12px;
            margin-bottom: 8px;
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .player-item-modal:hover {
            background-color: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
        }
        
        .player-item-modal.selected {
            background-color: rgba(46, 204, 113, 0.1);
            border: 1px solid var(--accent-green);
        }
        
        .player-info-modal {
            font-weight: 500;
        }
        
        .player-stats-modal {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        /* Scorecard Modal */
        .scorecard-modal {
            max-width: 800px;
        }
        
        .scorecard-teams {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 24px;
        }
        
        .scorecard-team {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 20px;
            border: 1px solid var(--border-color);
        }
        
        .scorecard-team-name {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
            color: var(--accent-green);
        }
        
        .scorecard-section {
            margin-bottom: 20px;
        }
        
        .scorecard-section-title {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .scorecard-player-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.05);
        }
        
        .scorecard-player-item:last-child {
            border-bottom: none;
        }
        
        .player-name-scorecard {
            font-weight: 500;
        }
        
        .player-stats-scorecard {
            text-align: right;
            font-size: 0.95rem;
        }
        
        /* Footer */
        .app-footer {
            padding: 20px;
            text-align: center;
            color: var(--text-muted);
            font-size: 0.85rem;
            border-top: 1px solid var(--border-color);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .app-container {
                padding: 16px;
            }
            
            .score-summary {
                padding: 20px;
            }
            
            .runs {
                font-size: 3rem;
            }
            
            .match-details {
                grid-template-columns: 1fr;
            }
            
            .runs-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .extras-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .app-header {
                flex-direction: column;
                gap: 12px;
                align-items: flex-start;
            }
            
            .match-info {
                text-align: left;
                width: 100%;
            }
            
            .teams-side-by-side {
                grid-template-columns: 1fr;
            }
            
            .sport-grid {
                grid-template-columns: 1fr;
            }
            
            .teams-grid {
                grid-template-columns: 1fr;
            }
            
            .setup-form {
                grid-template-columns: 1fr;
            }
            
            .nav-steps {
                flex-wrap: wrap;
            }
            
            .step-item {
                flex: 0 0 50%;
                margin-bottom: 12px;
            }
            
            .scorecard-teams {
                grid-template-columns: 1fr;
            }
        }
        
        /* Notification */
        .notification {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background-color: var(--secondary-dark);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 16px 20px;
            max-width: 320px;
            box-shadow: var(--shadow);
            opacity: 0;
            transform: translateY(10px);
            transition: var(--transition);
            z-index: 100;
        }
        
        .notification.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .notification-content {
            font-size: 0.95rem;
        }
        
        .notification-close {
            position: absolute;
            top: 12px;
            right: 12px;
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 1rem;
        }
        
        /* Utility Classes */
        .text-green {
            color: var(--accent-green);
        }
        
        .text-blue {
            color: var(--accent-blue);
        }
        
        .text-red {
            color: var(--accent-red);
        }
        
        .text-yellow {
            color: var(--accent-yellow);
        }
        
        .text-muted {
            color: var(--text-muted);
        }
        
        .mb-1 { margin-bottom: 8px; }
        .mb-2 { margin-bottom: 16px; }
        .mb-3 { margin-bottom: 24px; }
        
        .mt-1 { margin-top: 8px; }
        .mt-2 { margin-top: 16px; }
        .mt-3 { margin-top: 24px; }
        
        .d-none { display: none; }
        .d-block { display: block; }
        
        .text-center { text-align: center; }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="app-header">
        <div class="logo">
            <i class="fas fa-cricket logo-icon"></i>
            <span>CricketScore Pro</span>
        </div>
        
        <div class="match-info">
            <div class="match-tournament" id="tournament-name">Indian Premier League 2023</div>
            <div class="match-teams" id="match-teams">Mumbai Indians vs Chennai Super Kings</div>
            <div class="match-status">
                <span class="live-indicator"></span>
                <span id="match-status-text">LIVE • 2nd Innings</span>
            </div>
        </div>
        
        <div class="match-time">
            <div class="match-status" id="overs-count">17.3 Overs</div>
        </div>
    </header>
    
    <!-- Navigation Steps -->
    <div class="app-container">
        <div class="nav-steps">
            <div class="step-item active" data-step="1">
                <div class="step-number">1</div>
                <div class="step-label">Select Sport</div>
            </div>
            <div class="step-item" data-step="2">
                <div class="step-number">2</div>
                <div class="step-label">Tournament Setup</div>
            </div>
            <div class="step-item" data-step="3">
                <div class="step-number">3</div>
                <div class="step-label">Create Teams</div>
            </div>
            <div class="step-item" data-step="4">
                <div class="step-number">4</div>
                <div class="step-label">Match Setup</div>
            </div>
            <div class="step-item" data-step="5">
                <div class="step-number">5</div>
                <div class="step-label">Live Scoring</div>
            </div>
        </div>
        
        <!-- Step 1: Sport Selection -->
        <section class="sport-selection d-block" id="step-1">
            <div class="sport-grid">
                <div class="sport-card selected" data-sport="cricket">
                    <i class="fas fa-baseball-ball sport-icon"></i>
                    <div class="sport-name">Cricket</div>
                </div>
                
                <div class="sport-card" data-sport="football">
                    <i class="fas fa-futbol sport-icon"></i>
                    <div class="sport-name">Football</div>
                </div>
                
                <div class="sport-card" data-sport="custom">
                    <i class="fas fa-plus sport-icon"></i>
                    <div class="sport-name">Custom Sport</div>
                </div>
            </div>
            
            <div class="text-center mt-3">
                <button class="action-btn primary" id="next-to-setup">
                    Next <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </section>
        
        <!-- Step 2: Tournament Setup -->
        <section class="setup-section d-none" id="step-2">
            <div class="setup-form">
                <div class="form-group">
                    <label class="form-label">Tournament Name</label>
                    <input type="text" class="form-control" id="tournament-name-input" value="Indian Premier League 2023">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Number of Teams</label>
                    <input type="number" class="form-control" id="team-count" min="2" max="16" value="4">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Overs per Innings</label>
                    <select class="form-control" id="overs-per-innings">
                        <option value="5">5 Overs (Quick Match)</option>
                        <option value="10">10 Overs</option>
                        <option value="20" selected>20 Overs (T20)</option>
                        <option value="50">50 Overs (ODI)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Players per Team</label>
                    <input type="number" class="form-control" id="players-per-team" min="6" max="15" value="11">
                </div>
            </div>
            
            <div class="action-buttons mt-3">
                <button class="action-btn" id="back-to-sport">
                    <i class="fas fa-arrow-left"></i> Back
                </button>
                <button class="action-btn primary" id="next-to-teams">
                    Next <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </section>
        
        <!-- Step 3: Create Teams -->
        <section class="teams-section d-none" id="step-3">
            <div class="teams-grid" id="teams-container">
                <!-- Teams will be generated here -->
            </div>
            
            <div class="action-buttons mt-3">
                <button class="action-btn" id="back-to-setup">
                    <i class="fas fa-arrow-left"></i> Back
                </button>
                <button class="action-btn primary" id="next-to-match">
                    Next <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </section>
        
        <!-- Step 4: Match Setup -->
        <section class="setup-section d-none" id="step-4">
            <div class="form-group mb-3">
                <label class="form-label">Select Teams for Match</label>
                <div class="teams-selection" id="teams-selection">
                    <!-- Teams will be populated here -->
                </div>
            </div>
            
            <div class="form-group mb-3">
                <label class="form-label">Toss Winner</label>
                <select class="form-control" id="toss-winner">
                    <option value="">Select team</option>
                </select>
            </div>
            
            <div class="form-group mb-3">
                <label class="form-label">Toss Decision</label>
                <select class="form-control" id="toss-decision">
                    <option value="bat">Bat First</option>
                    <option value="bowl">Bowl First</option>
                </select>
            </div>
            
            <div class="action-buttons mt-3">
                <button class="action-btn" id="back-to-teams">
                    <i class="fas fa-arrow-left"></i> Back
                </button>
                <button class="action-btn primary" id="start-match">
                    <i class="fas fa-play"></i> Start Match
                </button>
                <button class="action-btn" id="modify-setup">
                    <i class="fas fa-edit"></i> Modify Setup
                </button>
            </div>
        </section>
        
        <!-- Step 5: Live Scoring -->
        <section class="d-none" id="step-5">
            <!-- Score Summary - Side by Side -->
            <div class="score-summary">
                <div class="teams-side-by-side">
                    <div class="team-score-card batting" id="batting-team-card">
                        <div class="team-name" id="batting-team-name">Mumbai Indians</div>
                        <div class="team-score">
                            <div class="runs" id="batting-team-runs">145</div>
                            <div class="wickets" id="batting-team-wickets">/3</div>
                            <div class="overs" id="batting-team-overs">(17.3)</div>
                        </div>
                        <div class="run-rate" id="batting-run-rate">Run Rate: 8.42</div>
                    </div>
                    
                    <div class="team-score-card" id="bowling-team-card">
                        <div class="team-name" id="bowling-team-name">Chennai Super Kings</div>
                        <div class="team-score">
                            <div class="runs" id="bowling-team-runs">186</div>
                            <div class="wickets" id="bowling-team-wickets">/5</div>
                            <div class="overs" id="bowling-team-overs">(20.0)</div>
                        </div>
                        <div class="run-rate" id="bowling-run-rate">Run Rate: 9.30</div>
                    </div>
                </div>
                
                <div class="target-info" id="target-info">
                    Need 42 runs in 15 balls • Target: 187
                </div>
            </div>
            
            <!-- Single/Double Batter Mode Toggle -->
            <div class="batter-mode-toggle">
                <div class="toggle-label">Batter Mode</div>
                <label class="toggle-switch">
                    <input type="checkbox" id="single-batter-toggle">
                    <span class="toggle-slider"></span>
                </label>
                <div class="toggle-label">Single Batter</div>
            </div>
            
            <!-- Match Details -->
            <div class="match-details">
                <!-- Batters -->
                <div class="detail-card">
                    <div class="card-header">
                        <div class="card-title">Batters</div>
                        <div class="text-muted">R • B • 4s • 6s</div>
                    </div>
                    
                    <div class="batter" id="striker-batter">
                        <div class="batter-info">
                            <div class="strike-indicator"></div>
                            <div>
                                <div class="batter-name">Rohit Sharma</div>
                                <div class="text-muted" style="font-size: 0.85rem;">Captain</div>
                            </div>
                        </div>
                        <div class="batter-stats">
                            <div class="batter-runs">78</div>
                            <div class="batter-details">45 • 8 • 3</div>
                        </div>
                    </div>
                    
                    <div class="batter" id="non-striker-batter">
                        <div class="batter-info">
                            <div class="strike-indicator" style="background-color: transparent;"></div>
                            <div>
                                <div class="batter-name">Suryakumar Yadav</div>
                                <div class="text-muted" style="font-size: 0.85rem;"></div>
                            </div>
                        </div>
                        <div class="batter-stats">
                            <div class="batter-runs">32</div>
                            <div class="batter-details">28 • 4 • 1</div>
                        </div>
                    </div>
                </div>
                
                <!-- Bowlers -->
                <div class="detail-card">
                    <div class="card-header">
                        <div class="card-title">Bowlers</div>
                        <div class="text-muted">O • R • W</div>
                    </div>
                    
                    <div class="bowler" id="current-bowler">
                        <div class="bowler-name">Deepak Chahar</div>
                        <div class="bowler-stats">
                            <div>3.0 - 24 - 2</div>
                            <div class="bowler-economy">Econ: 8.00</div>
                        </div>
                    </div>
                    
                    <div class="bowler" id="previous-bowler">
                        <div class="bowler-name">Ravindra Jadeja</div>
                        <div class="bowler-stats">
                            <div>4.0 - 32 - 0</div>
                            <div class="bowler-economy">Econ: 8.00</div>
                        </div>
                    </div>
                </div>
                
                <!-- Current Over -->
                <div class="detail-card">
                    <div class="card-header">
                        <div class="card-title">Current Over</div>
                        <div class="text-muted" id="current-over-number">17.3</div>
                    </div>
                    
                    <div class="over-container" id="current-over-balls">
                        <div class="ball ball-run">1</div>
                        <div class="ball ball-dot">•</div>
                        <div class="ball ball-four">4</div>
                        <div class="ball ball-run">2</div>
                        <div class="ball ball-wicket">W</div>
                        <div class="ball ball-dot">•</div>
                    </div>
                    
                    <div class="over-info">
                        <div class="text-muted" id="this-over-runs">This Over: 7 runs</div>
                        <div class="text-muted" id="total-extras">Extras: 8</div>
                    </div>
                </div>
            </div>
            
            <!-- Scoring Controls -->
            <div class="scoring-section">
                <div class="scoring-title">Score This Ball</div>
                
                <!-- Runs -->
                <div class="runs-grid">
                    <button class="run-btn run-0" data-runs="0">0</button>
                    <button class="run-btn run-1" data-runs="1">1</button>
                    <button class="run-btn run-2" data-runs="2">2</button>
                    <button class="run-btn run-3" data-runs="3">3</button>
                    <button class="run-btn run-4" data-runs="4">4</button>
                    <button class="run-btn run-6" data-runs="6">6</button>
                    <button class="run-btn wicket-btn" data-wicket="true">W</button>
                    <button class="run-btn" id="undo-btn">
                        <i class="fas fa-undo"></i>
                    </button>
                </div>
                
                <!-- Extras -->
                <div class="extras-grid">
                    <button class="extra-btn wide" data-extra="wide">Wide</button>
                    <button class="extra-btn noball" data-extra="noball">No Ball</button>
                    <button class="extra-btn" data-extra="bye">Bye</button>
                    <button class="extra-btn" data-extra="legbye">Leg Bye</button>
                    <button class="extra-btn" data-extra="noball4">Nb + 4</button>
                </div>
                
                <!-- Action Buttons -->
                <div class="action-buttons">
                    <button class="action-btn" id="swap-batters-btn">
                        <i class="fas fa-random"></i> Swap Batters
                    </button>
                    <button class="action-btn" id="new-batsman-btn">
                        <i class="fas fa-user-plus"></i> New Batter
                    </button>
                    <button class="action-btn" id="change-bowler-btn">
                        <i class="fas fa-baseball-ball"></i> Change Bowler
                    </button>
                    <button class="action-btn" id="view-scorecard-btn">
                        <i class="fas fa-list-ol"></i> View Scorecard
                    </button>
                    <button class="action-btn primary" id="end-innings-btn">
                        <i class="fas fa-flag-checkered"></i> End Innings
                    </button>
                </div>
            </div>
        </section>
    </div>
    
    <!-- Footer -->
    <footer class="app-footer">
        <div class="container">
            <p>CricketScore Pro © 2023 | Professional Cricket Scoring</p>
            <p class="mt-1">Designed for clarity and professional scoring experience</p>
        </div>
    </footer>
    
    <!-- Player Selection Modal -->
    <div class="modal" id="player-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="player-modal-title">Select Player</div>
                <button class="modal-close" id="close-player-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="player-modal-description">Select a player from the list below:</div>
            
            <div class="player-list-modal" id="player-list-modal">
                <!-- Player list will be populated here -->
            </div>
            
            <div class="action-buttons mt-3">
                <button class="action-btn" id="cancel-player-selection">Cancel</button>
                <button class="action-btn primary" id="confirm-player-selection">Select</button>
            </div>
        </div>
    </div>
    
    <!-- Bowler Change Modal -->
    <div class="modal" id="bowler-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Change Bowler</div>
                <button class="modal-close" id="close-bowler-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div>Select a bowler for the next over:</div>
            
            <div class="player-list-modal" id="bowler-list-modal">
                <!-- Bowler list will be populated here -->
            </div>
            
            <div class="action-buttons mt-3">
                <button class="action-btn" id="cancel-bowler-selection">Cancel</button>
                <button class="action-btn primary" id="confirm-bowler-selection">Select Bowler</button>
            </div>
        </div>
    </div>
    
    <!-- Scorecard Modal -->
    <div class="modal" id="scorecard-modal">
        <div class="modal-content scorecard-modal">
            <div class="modal-header">
                <div class="modal-title">Match Scorecard</div>
                <button class="modal-close" id="close-scorecard-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="scorecard-teams" id="scorecard-teams">
                <!-- Scorecards will be populated here -->
            </div>
            
            <div class="action-buttons mt-3">
                <button class="action-btn" id="close-scorecard">Close</button>
                <button class="action-btn primary" id="print-scorecard">
                    <i class="fas fa-print"></i> Print
                </button>
            </div>
        </div>
    </div>
    
    <!-- Notification -->
    <div class="notification" id="notification">
        <button class="notification-close" id="close-notification">
            <i class="fas fa-times"></i>
        </button>
        <div class="notification-content" id="notification-content">
            Ball scored successfully
        </div>
    </div>
    
    <script>
        // Application State
        const appState = {
            currentStep: 1,
            selectedSport: 'cricket',
            tournament: {
                name: 'Indian Premier League 2023',
                oversPerInnings: 20,
                playersPerTeam: 11,
                teamCount: 4
            },
            teams: [],
            match: {
                team1: null,
                team2: null,
                tossWinner: null,
                tossDecision: 'bat',
                innings: 1,
                isStarted: false,
                singleBatterMode: false
            },
            cricket: {
                battingTeam: null,
                bowlingTeam: null,
                totalRuns: 145,
                wickets: 3,
                overs: 17,
                balls: 3,
                extras: 8,
                target: 187,
                currentOver: [1, 0, 4, 2, 'W', 0],
                striker: {
                    name: 'Rohit Sharma',
                    runs: 78,
                    balls: 45,
                    fours: 8,
                    sixes: 3,
                    isOut: false
                },
                nonStriker: {
                    name: 'Suryakumar Yadav',
                    runs: 32,
                    balls: 28,
                    fours: 4,
                    sixes: 1,
                    isOut: false
                },
                currentBowler: {
                    name: 'Deepak Chahar',
                    overs: 3,
                    runs: 24,
                    wickets: 2,
                    balls: 0,
                    maidens: 0
                },
                previousBowler: {
                    name: 'Ravindra Jadeja',
                    overs: 4,
                    runs: 32,
                    wickets: 0,
                    balls: 0,
                    maidens: 0
                },
                playerStats: {},
                actionHistory: []
            }
        };
        
        // Initialize the app
        function initApp() {
            setupEventListeners();
            generateDemoTeams();
            updateUI();
            updateStepNavigation();
        }
        
        // Set up event listeners
        function setupEventListeners() {
            // Step navigation
            document.querySelectorAll('.step-item').forEach(step => {
                step.addEventListener('click', function() {
                    const stepNumber = parseInt(this.getAttribute('data-step'));
                    goToStep(stepNumber);
                });
            });
            
            // Sport selection
            document.querySelectorAll('.sport-card').forEach(card => {
                card.addEventListener('click', function() {
                    document.querySelectorAll('.sport-card').forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    appState.selectedSport = this.getAttribute('data-sport');
                });
            });
            
            // Navigation buttons
            document.getElementById('next-to-setup').addEventListener('click', () => goToStep(2));
            document.getElementById('back-to-sport').addEventListener('click', () => goToStep(1));
            document.getElementById('next-to-teams').addEventListener('click', () => {
                updateTournamentFromForm();
                generateTeams();
                goToStep(3);
            });
            document.getElementById('back-to-setup').addEventListener('click', () => goToStep(2));
            document.getElementById('next-to-match').addEventListener('click', () => {
                if (validateTeams()) {
                    setupMatchSelection();
                    goToStep(4);
                }
            });
            document.getElementById('back-to-teams').addEventListener('click', () => goToStep(3));
            document.getElementById('start-match').addEventListener('click', startMatch);
            document.getElementById('modify-setup').addEventListener('click', () => goToStep(2));
            
            // Tournament form changes
            document.getElementById('tournament-name-input').addEventListener('input', updateTournamentFromForm);
            document.getElementById('team-count').addEventListener('change', updateTournamentFromForm);
            document.getElementById('overs-per-innings').addEventListener('change', updateTournamentFromForm);
            document.getElementById('players-per-team').addEventListener('change', updateTournamentFromForm);
            
            // Single batter toggle
            document.getElementById('single-batter-toggle').addEventListener('change', function() {
                appState.match.singleBatterMode = this.checked;
                showNotification(this.checked ? 
                    'Single batter mode enabled' : 
                    'Double batter mode enabled');
            });
            
            // Scoring controls
            document.querySelectorAll('.run-btn[data-runs]').forEach(button => {
                button.addEventListener('click', function() {
                    const runs = parseInt(this.getAttribute('data-runs'));
                    addRuns(runs);
                });
            });
            
            document.querySelector('.wicket-btn').addEventListener('click', addWicket);
            
            document.querySelectorAll('.extra-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const extra = this.getAttribute('data-extra');
                    addExtra(extra);
                });
            });
            
            // Action buttons in live scoring
            document.getElementById('swap-batters-btn').addEventListener('click', swapBatters);
            document.getElementById('new-batsman-btn').addEventListener('click', () => openPlayerSelection('newBatsman'));
            document.getElementById('change-bowler-btn').addEventListener('click', () => openBowlerSelection());
            document.getElementById('view-scorecard-btn').addEventListener('click', showScorecard);
            document.getElementById('end-innings-btn').addEventListener('click', endInnings);
            document.getElementById('undo-btn').addEventListener('click', undoLastAction);
            
            // Modal buttons
            document.getElementById('close-player-modal').addEventListener('click', () => {
                document.getElementById('player-modal').classList.remove('active');
            });
            
            document.getElementById('cancel-player-selection').addEventListener('click', () => {
                document.getElementById('player-modal').classList.remove('active');
            });
            
            document.getElementById('confirm-player-selection').addEventListener('click', confirmPlayerSelection);
            
            document.getElementById('close-bowler-modal').addEventListener('click', () => {
                document.getElementById('bowler-modal').classList.remove('active');
            });
            
            document.getElementById('cancel-bowler-selection').addEventListener('click', () => {
                document.getElementById('bowler-modal').classList.remove('active');
            });
            
            document.getElementById('confirm-bowler-selection').addEventListener('click', confirmBowlerSelection);
            
            document.getElementById('close-scorecard-modal').addEventListener('click', () => {
                document.getElementById('scorecard-modal').classList.remove('active');
            });
            
            document.getElementById('close-scorecard').addEventListener('click', () => {
                document.getElementById('scorecard-modal').classList.remove('active');
            });
            
            document.getElementById('print-scorecard').addEventListener('click', printScorecard);
            
            // Notification
            document.getElementById('close-notification').addEventListener('click', hideNotification);
        }
        
        // Go to specific step
        function goToStep(stepNumber) {
            appState.currentStep = stepNumber;
            
            // Hide all steps
            document.querySelectorAll('[id^="step-"]').forEach(step => {
                step.classList.add('d-none');
            });
            
            // Show current step
            document.getElementById(`step-${stepNumber}`).classList.remove('d-none');
            
            // Update step navigation
            updateStepNavigation();
            
            // Update UI based on step
            if (stepNumber === 5 && appState.match.isStarted) {
                updateLiveScoringUI();
            }
        }
        
        // Update step navigation
        function updateStepNavigation() {
            document.querySelectorAll('.step-item').forEach(step => {
                const stepNumber = parseInt(step.getAttribute('data-step'));
                step.classList.remove('active');
                
                if (stepNumber <= appState.currentStep) {
                    step.classList.add('active');
                }
            });
        }
        
        // Update tournament data from form
        function updateTournamentFromForm() {
            appState.tournament.name = document.getElementById('tournament-name-input').value;
            appState.tournament.teamCount = parseInt(document.getElementById('team-count').value) || 4;
            appState.tournament.oversPerInnings = parseInt(document.getElementById('overs-per-innings').value) || 20;
            appState.tournament.playersPerTeam = parseInt(document.getElementById('players-per-team').value) || 11;
            
            // Update header
            document.getElementById('tournament-name').textContent = appState.tournament.name;
        }
        
        // Generate teams
        function generateTeams() {
            const teamsContainer = document.getElementById('teams-container');
            teamsContainer.innerHTML = '';
            
            const teamNames = getTeamNames();
            
            for (let i = 0; i < appState.tournament.teamCount; i++) {
                const teamCard = document.createElement('div');
                teamCard.className = 'team-card';
                teamCard.innerHTML = `
                    <div class="team-header">
                        <input type="text" class="team-name-input" value="${teamNames[i] || `Team ${i+1}`}" data-team-index="${i}">
                        <div class="text-muted">T${i+1}</div>
                    </div>
                    <ul class="player-list" id="players-team-${i}">
                        <!-- Players will be generated here -->
                    </ul>
                `;
                teamsContainer.appendChild(teamCard);
                
                const playersList = document.getElementById(`players-team-${i}`);
                for (let j = 0; j < appState.tournament.playersPerTeam; j++) {
                    const playerItem = document.createElement('li');
                    playerItem.className = 'player-item';
                    playerItem.innerHTML = `
                        <input type="text" class="player-input" placeholder="Player ${j+1}" value="Player ${j+1}">
                        <span class="text-muted">#${j+1}</span>
                    `;
                    playersList.appendChild(playerItem);
                }
            }
            
            updateTeamsFromUI();
        }
        
        // Generate demo teams for initial load
        function generateDemoTeams() {
            appState.teams = [
                {
                    id: 1,
                    name: 'Mumbai Indians',
                    players: [
                        { id: 1, name: 'Rohit Sharma', role: 'Batsman' },
                        { id: 2, name: 'Suryakumar Yadav', role: 'Batsman' },
                        { id: 3, name: 'Ishan Kishan', role: 'Batsman' },
                        { id: 4, name: 'Tilak Varma', role: 'Batsman' },
                        { id: 5, name: 'Tim David', role: 'All-rounder' },
                        { id: 6, name: 'Hardik Pandya', role: 'All-rounder' },
                        { id: 7, name: 'Jasprit Bumrah', role: 'Bowler' },
                        { id: 8, name: 'Jofra Archer', role: 'Bowler' },
                        { id: 9, name: 'Piyush Chawla', role: 'Bowler' },
                        { id: 10, name: 'Jason Behrendorff', role: 'Bowler' },
                        { id: 11, name: 'Kumar Kartikeya', role: 'Bowler' }
                    ]
                },
                {
                    id: 2,
                    name: 'Chennai Super Kings',
                    players: [
                        { id: 12, name: 'MS Dhoni', role: 'Batsman' },
                        { id: 13, name: 'Ruturaj Gaikwad', role: 'Batsman' },
                        { id: 14, name: 'Devon Conway', role: 'Batsman' },
                        { id: 15, name: 'Ajinkya Rahane', role: 'Batsman' },
                        { id: 16, name: 'Shivam Dube', role: 'All-rounder' },
                        { id: 17, name: 'Ravindra Jadeja', role: 'All-rounder' },
                        { id: 18, name: 'Moeen Ali', role: 'All-rounder' },
                        { id: 19, name: 'Deepak Chahar', role: 'Bowler' },
                        { id: 20, name: 'Matheesha Pathirana', role: 'Bowler' },
                        { id: 21, name: 'Maheesh Theekshana', role: 'Bowler' },
                        { id: 22, name: 'Tushar Deshpande', role: 'Bowler' }
                    ]
                },
                {
                    id: 3,
                    name: 'Royal Challengers Bangalore',
                    players: Array.from({length: 11}, (_, i) => ({ 
                        id: 23 + i, 
                        name: `Player ${i+1}`, 
                        role: 'Player' 
                    }))
                },
                {
                    id: 4,
                    name: 'Kolkata Knight Riders',
                    players: Array.from({length: 11}, (_, i) => ({ 
                        id: 34 + i, 
                        name: `Player ${i+1}`, 
                        role: 'Player' 
                    }))
                }
            ];
        }
        
        // Get team name suggestions
        function getTeamNames() {
            if (appState.selectedSport === 'cricket') {
                return [
                    "Mumbai Indians", "Chennai Super Kings", "Royal Challengers", 
                    "Kolkata Knight Riders", "Delhi Capitals", "Rajasthan Royals",
                    "Sunrisers Hyderabad", "Punjab Kings", "Gujarat Titans",
                    "Lucknow Super Giants"
                ];
            } else if (appState.selectedSport === 'football') {
                return [
                    "Real Madrid", "Barcelona", "Manchester United", 
                    "Liverpool", "Bayern Munich", "Paris Saint-Germain",
                    "Juventus", "AC Milan", "Chelsea", "Arsenal"
                ];
            } else {
                return [
                    "Team Alpha", "Team Beta", "Team Gamma", "Team Delta",
                    "Team Echo", "Team Foxtrot", "Team Golf", "Team Hotel"
                ];
            }
        }
        
        // Update teams from UI
        function updateTeamsFromUI() {
            appState.teams = [];
            const teamInputs = document.querySelectorAll('.team-name-input');
            
            teamInputs.forEach((input, index) => {
                const team = {
                    id: index + 1,
                    name: input.value || `Team ${index + 1}`,
                    players: []
                };
                
                const playerInputs = document.querySelectorAll(`#players-team-${index} .player-input`);
                playerInputs.forEach((playerInput, playerIndex) => {
                    team.players.push({
                        id: playerIndex + 1,
                        name: playerInput.value || `Player ${playerIndex + 1}`,
                        role: 'Player'
                    });
                });
                
                appState.teams.push(team);
            });
        }
        
        // Validate teams
        function validateTeams() {
            updateTeamsFromUI();
            
            for (const team of appState.teams) {
                if (!team.name.trim()) {
                    showNotification(`Please enter a name for ${team.name}`, "error");
                    return false;
                }
                
                for (const player of team.players) {
                    if (!player.name.trim()) {
                        showNotification(`Please enter names for all players in ${team.name}`, "error");
                        return false;
                    }
                }
            }
            
            return true;
        }
        
        // Setup match selection
        function setupMatchSelection() {
            const teamsSelection = document.getElementById('teams-selection');
            const tossWinnerSelect = document.getElementById('toss-winner');
            
            teamsSelection.innerHTML = '';
            tossWinnerSelect.innerHTML = '<option value="">Select team</option>';
            
            appState.teams.forEach(team => {
                // Add to teams selection display
                const teamDiv = document.createElement('div');
                teamDiv.className = 'team-score-card mb-2';
                teamDiv.innerHTML = `
                    <div class="team-name">${team.name}</div>
                    <div class="text-muted">${team.players.length} players</div>
                `;
                teamDiv.dataset.teamId = team.id;
                teamsSelection.appendChild(teamDiv);
                
                // Add to toss winner select
                const option = document.createElement('option');
                option.value = team.id;
                option.textContent = team.name;
                tossWinnerSelect.appendChild(option);
            });
            
            // Auto-select first two teams
            const teamCards = document.querySelectorAll('.team-score-card');
            if (teamCards.length >= 2) {
                teamCards[0].classList.add('batting');
                teamCards[1].classList.add('batting');
                
                appState.match.team1 = appState.teams[0];
                appState.match.team2 = appState.teams[1];
            }
        }
        
        // Start match
        function startMatch() {
            const tossWinnerId = document.getElementById('toss-winner').value;
            const tossDecision = document.getElementById('toss-decision').value;
            
            if (!tossWinnerId) {
                showNotification("Please select toss winner", "error");
                return;
            }
            
            if (!appState.match.team1 || !appState.match.team2) {
                showNotification("Please select two teams", "error");
                return;
            }
            
            appState.match.tossWinner = appState.teams.find(t => t.id == tossWinnerId);
            appState.match.tossDecision = tossDecision;
            appState.match.isStarted = true;
            
            // Setup cricket match
            if (appState.selectedSport === 'cricket') {
                setupCricketMatch();
            }
            
            // Update UI
            updateUI();
            
            // Go to live scoring
            goToStep(5);
            
            showNotification("Match started successfully!", "success");
        }
        
        // Setup cricket match
        function setupCricketMatch() {
            let battingTeam, bowlingTeam;
            
            if (appState.match.tossDecision === 'bat') {
                battingTeam = appState.match.tossWinner;
                bowlingTeam = battingTeam.id === appState.match.team1.id ? 
                    appState.match.team2 : appState.match.team1;
            } else {
                bowlingTeam = appState.match.tossWinner;
                battingTeam = bowlingTeam.id === appState.match.team1.id ? 
                    appState.match.team2 : appState.match.team1;
            }
            
            appState.cricket.battingTeam = battingTeam;
            appState.cricket.bowlingTeam = bowlingTeam;
            
            // Initialize player stats
            appState.cricket.playerStats = {};
            
            // Initialize batting team players
            battingTeam.players.forEach(player => {
                appState.cricket.playerStats[player.id] = {
                    playerId: player.id,
                    name: player.name,
                    teamId: battingTeam.id,
                    runs: 0,
                    balls: 0,
                    fours: 0,
                    sixes: 0,
                    isOut: false,
                    howOut: null,
                    bowler: null
                };
            });
            
            // Initialize bowling team players
            bowlingTeam.players.forEach(player => {
                appState.cricket.playerStats[player.id] = {
                    ...appState.cricket.playerStats[player.id],
                    playerId: player.id,
                    name: player.name,
                    teamId: bowlingTeam.id,
                    overs: 0,
                    ballsBowled: 0,
                    runsConceded: 0,
                    wickets: 0,
                    maidens: 0,
                    wides: 0,
                    noBalls: 0
                };
            });
            
            // Set initial striker and non-striker
            if (battingTeam.players.length >= 2) {
                appState.cricket.striker = {
                    ...battingTeam.players[0],
                    runs: 78,
                    balls: 45,
                    fours: 8,
                    sixes: 3,
                    isOut: false
                };
                
                appState.cricket.nonStriker = {
                    ...battingTeam.players[1],
                    runs: 32,
                    balls: 28,
                    fours: 4,
                    sixes: 1,
                    isOut: false
                };
            }
            
            // Set initial bowlers
            if (bowlingTeam.players.length >= 2) {
                appState.cricket.currentBowler = {
                    name: bowlingTeam.players[0].name,
                    overs: 3,
                    runs: 24,
                    wickets: 2,
                    balls: 0,
                    maidens: 0
                };
                
                appState.cricket.previousBowler = {
                    name: bowlingTeam.players[1].name,
                    overs: 4,
                    runs: 32,
                    wickets: 0,
                    balls: 0,
                    maidens: 0
                };
            }
        }
        
        // Update UI
        function updateUI() {
            // Update tournament name
            document.getElementById('tournament-name').textContent = appState.tournament.name;
            
            // Update match teams
            if (appState.match.team1 && appState.match.team2) {
                document.getElementById('match-teams').textContent = 
                    `${appState.match.team1.name} vs ${appState.match.team2.name}`;
            }
            
            // Update live scoring UI if match started
            if (appState.match.isStarted && appState.currentStep === 5) {
                updateLiveScoringUI();
            }
        }
        
        // Update live scoring UI
        function updateLiveScoringUI() {
            if (appState.selectedSport !== 'cricket') return;
            
            // Update batting team card
            document.getElementById('batting-team-name').textContent = 
                appState.cricket.battingTeam?.name || 'Batting Team';
            document.getElementById('batting-team-runs').textContent = appState.cricket.totalRuns;
            document.getElementById('batting-team-wickets').textContent = `/${appState.cricket.wickets}`;
            document.getElementById('batting-team-overs').textContent = 
                `(${appState.cricket.overs}.${appState.cricket.balls})`;
            
            // Calculate and update run rate
            const totalBalls = appState.cricket.overs * 6 + appState.cricket.balls;
            const runRate = totalBalls > 0 ? 
                (appState.cricket.totalRuns / (totalBalls / 6)).toFixed(2) : "0.00";
            document.getElementById('batting-run-rate').textContent = `Run Rate: ${runRate}`;
            
            // Update bowling team card
            document.getElementById('bowling-team-name').textContent = 
                appState.cricket.bowlingTeam?.name || 'Bowling Team';
            
            // For second innings, show first innings score
            if (appState.match.innings === 2) {
                document.getElementById('bowling-team-runs').textContent = appState.cricket.target - 1;
                document.getElementById('bowling-team-wickets').textContent = '/10';
                document.getElementById('bowling-team-overs').textContent = 
                    `(${appState.tournament.oversPerInnings}.0)`;
                
                const bowlingRunRate = appState.tournament.oversPerInnings > 0 ? 
                    ((appState.cricket.target - 1) / appState.tournament.oversPerInnings).toFixed(2) : "0.00";
                document.getElementById('bowling-run-rate').textContent = `Run Rate: ${bowlingRunRate}`;
            }
            
            // Update target info
            if (appState.match.innings === 2) {
                const runsNeeded = appState.cricket.target - appState.cricket.totalRuns;
                const ballsRemaining = (appState.tournament.oversPerInnings * 6) - totalBalls;
                document.getElementById('target-info').textContent = 
                    `Need ${runsNeeded} runs in ${ballsRemaining} balls • Target: ${appState.cricket.target}`;
            } else {
                document.getElementById('target-info').textContent = 
                    `1st Innings • ${appState.tournament.oversPerInnings} overs match`;
            }
            
            // Update batter stats
            document.querySelector('#striker-batter .batter-name').textContent = 
                appState.cricket.striker.name;
            document.querySelector('#striker-batter .batter-runs').textContent = 
                appState.cricket.striker.runs;
            document.querySelector('#striker-batter .batter-details').textContent = 
                `${appState.cricket.striker.balls} • ${appState.cricket.striker.fours} • ${appState.cricket.striker.sixes}`;
            
            document.querySelector('#non-striker-batter .batter-name').textContent = 
                appState.cricket.nonStriker.name;
            document.querySelector('#non-striker-batter .batter-runs').textContent = 
                appState.cricket.nonStriker.runs;
            document.querySelector('#non-striker-batter .batter-details').textContent = 
                `${appState.cricket.nonStriker.balls} • ${appState.cricket.nonStriker.fours} • ${appState.cricket.nonStriker.sixes}`;
            
            // Update bowler stats
            document.querySelector('#current-bowler .bowler-name').textContent = 
                appState.cricket.currentBowler.name;
            document.querySelector('#current-bowler .bowler-stats').innerHTML = `
                <div>${appState.cricket.currentBowler.overs}.${appState.cricket.currentBowler.balls} - ${appState.cricket.currentBowler.runs} - ${appState.cricket.currentBowler.wickets}</div>
                <div class="bowler-economy">Econ: ${calculateEconomy(appState.cricket.currentBowler)}</div>
            `;
            
            document.querySelector('#previous-bowler .bowler-name').textContent = 
                appState.cricket.previousBowler.name;
            document.querySelector('#previous-bowler .bowler-stats').innerHTML = `
                <div>${appState.cricket.previousBowler.overs}.${appState.cricket.previousBowler.balls} - ${appState.cricket.previousBowler.runs} - ${appState.cricket.previousBowler.wickets}</div>
                <div class="bowler-economy">Econ: ${calculateEconomy(appState.cricket.previousBowler)}</div>
            `;
            
            // Update over display
            updateOverDisplay();
            
            // Update match status
            document.getElementById('match-status-text').textContent = 
                `LIVE • ${appState.match.innings === 1 ? '1st' : '2nd'} Innings`;
            document.getElementById('overs-count').textContent = 
                `${appState.cricket.overs}.${appState.cricket.balls} Overs`;
            
            // Update current over number
            document.getElementById('current-over-number').textContent = 
                `${appState.cricket.overs}.${appState.cricket.balls}`;
            
            // Update this over runs
            const overRuns = appState.cricket.currentOver.reduce((sum, ball) => {
                if (typeof ball === 'number') return sum + ball;
                if (ball === 'Wd' || ball === 'Nb') return sum + 1;
                return sum;
            }, 0);
            document.getElementById('this-over-runs').textContent = `This Over: ${overRuns} runs`;
            
            // Update extras
            document.getElementById('total-extras').textContent = `Extras: ${appState.cricket.extras}`;
        }
        
        // Calculate bowler economy
        function calculateEconomy(bowler) {
            const totalBalls = bowler.overs * 6 + bowler.balls;
            const overs = totalBalls / 6;
            return overs > 0 ? (bowler.runs / overs).toFixed(2) : "0.00";
        }
        
        // Update over display
        function updateOverDisplay() {
            const overContainer = document.getElementById('current-over-balls');
            overContainer.innerHTML = '';
            
            appState.cricket.currentOver.forEach((ball, index) => {
                const ballElement = document.createElement('div');
                
                let ballClass = 'ball ';
                let displayText = '';
                
                if (typeof ball === 'number') {
                    if (ball === 0) {
                        ballClass += 'ball-dot';
                        displayText = '•';
                    } else {
                        ballClass += 'ball-run';
                        displayText = ball;
                        
                        if (ball === 4) {
                            ballClass = 'ball ball-four';
                        } else if (ball === 6) {
                            ballClass = 'ball ball-six';
                        }
                    }
                } else if (ball === 'W') {
                    ballClass += 'ball-wicket';
                    displayText = 'W';
                } else if (ball === 'Wd') {
                    ballClass += 'ball-wide';
                    displayText = 'Wd';
                } else if (ball === 'Nb') {
                    ballClass += 'ball-noball';
                    displayText = 'Nb';
                } else if (ball === 'B') {
                    ballClass += 'ball-dot';
                    displayText = 'B';
                } else if (ball === 'Lb') {
                    ballClass += 'ball-dot';
                    displayText = 'Lb';
                } else if (ball && ball.includes('Nb+')) {
                    ballClass += 'ball-noball';
                    displayText = ball;
                }
                
                ballElement.className = ballClass;
                ballElement.textContent = displayText;
                overContainer.appendChild(ballElement);
            });
            
            // Add remaining balls in over
            const remainingBalls = 6 - appState.cricket.currentOver.length;
            for (let i = 0; i < remainingBalls; i++) {
                const ballElement = document.createElement('div');
                ballElement.className = 'ball ball-dot';
                ballElement.textContent = '•';
                overContainer.appendChild(ballElement);
            }
        }
        
        // Add runs to score
        function addRuns(runs) {
            // Store action for undo
            const action = {
                type: 'runs',
                runs: runs,
                cricketState: JSON.parse(JSON.stringify(appState.cricket)),
                matchState: JSON.parse(JSON.stringify(appState.match))
            };
            
            // Update match total
            appState.cricket.totalRuns += runs;
            
            // Update striker stats
            appState.cricket.striker.runs += runs;
            appState.cricket.striker.balls += 1;
            
            if (runs === 4) appState.cricket.striker.fours += 1;
            if (runs === 6) appState.cricket.striker.sixes += 1;
            
            // Update bowler stats
            appState.cricket.currentBowler.runs += runs;
            appState.cricket.currentBowler.balls += 1;
            
            if (appState.cricket.currentBowler.balls >= 6) {
                appState.cricket.currentBowler.overs += 1;
                appState.cricket.currentBowler.balls = 0;
                
                // Check for maiden over
                const lastOverRuns = appState.cricket.currentOver.reduce((sum, ball) => {
                    if (typeof ball === 'number') return sum + ball;
                    return sum;
                }, 0);
                
                if (lastOverRuns === 0) {
                    appState.cricket.currentBowler.maidens += 1;
                }
                
                // Ask for next bowler
                setTimeout(() => {
                    openBowlerSelection();
                }, 500);
            }
            
            // Update over
            appState.cricket.currentOver.push(runs);
            
            // Update balls
            appState.cricket.balls += 1;
            if (appState.cricket.balls >= 6) {
                appState.cricket.overs += 1;
                appState.cricket.balls = 0;
                appState.cricket.currentOver = [];
                
                // Swap batters at the end of over (if not single batter mode)
                if (!appState.match.singleBatterMode) {
                    swapBatters();
                }
            }
            
            // Swap batters for odd runs (if not single batter mode)
            if (runs % 2 !== 0 && !appState.match.singleBatterMode) {
                swapBatters();
            }
            
            // Add to history
            appState.cricket.actionHistory.push(action);
            
            // Update UI
            updateLiveScoringUI();
            
            // Show notification
            showNotification(`${runs} run${runs !== 1 ? 's' : ''} scored`, "success");
            
            // Check if match is complete
            checkMatchStatus();
        }
        
        // Add wicket
        function addWicket() {
            // Store action for undo
            const action = {
                type: 'wicket',
                cricketState: JSON.parse(JSON.stringify(appState.cricket)),
                matchState: JSON.parse(JSON.stringify(appState.match))
            };
            
            // Update match state
            appState.cricket.wickets += 1;
            appState.cricket.striker.isOut = true;
            
            // Update bowler stats
            appState.cricket.currentBowler.wickets += 1;
            appState.cricket.currentBowler.balls += 1;
            
            if (appState.cricket.currentBowler.balls >= 6) {
                appState.cricket.currentBowler.overs += 1;
                appState.cricket.currentBowler.balls = 0;
                
                // Ask for next bowler
                setTimeout(() => {
                    openBowlerSelection();
                }, 500);
            }
            
            // Update over
            appState.cricket.currentOver.push('W');
            
            // Update balls
            appState.cricket.balls += 1;
            if (appState.cricket.balls >= 6) {
                appState.cricket.overs += 1;
                appState.cricket.balls = 0;
                appState.cricket.currentOver = [];
            }
            
            // Add to history
            appState.cricket.actionHistory.push(action);
            
            // Update UI
            updateLiveScoringUI();
            
            // Show notification
            showNotification("Wicket! New batsman needed", "warning");
            
            // Open player selection for new batsman
            setTimeout(() => {
                openPlayerSelection('newBatsman');
            }, 800);
            
            // Check if innings is complete
            if (appState.cricket.wickets >= 10) {
                setTimeout(() => {
                    endInnings();
                }, 1000);
            }
        }
        
        // Add extra
        function addExtra(extra) {
            // Store action for undo
            const action = {
                type: 'extra',
                extra: extra,
                cricketState: JSON.parse(JSON.stringify(appState.cricket)),
                matchState: JSON.parse(JSON.stringify(appState.match))
            };
            
            let runs = 1;
            let symbol = 'Wd';
            
            switch(extra) {
                case 'wide':
                    runs = 1;
                    symbol = 'Wd';
                    break;
                case 'noball':
                    runs = 1;
                    symbol = 'Nb';
                    break;
                case 'noball4':
                    runs = 5;
                    symbol = 'Nb+4';
                    break;
                case 'bye':
                    runs = 1;
                    symbol = 'B';
                    break;
                case 'legbye':
                    runs = 1;
                    symbol = 'Lb';
                    break;
            }
            
            // Update match total
            appState.cricket.totalRuns += runs;
            appState.cricket.extras += runs;
            
            // Update over
            appState.cricket.currentOver.push(symbol);
            
            // For bye and leg bye, count as a ball
            if (extra === 'bye' || extra === 'legbye') {
                appState.cricket.balls += 1;
                if (appState.cricket.balls >= 6) {
                    appState.cricket.overs += 1;
                    appState.cricket.balls = 0;
                    appState.cricket.currentOver = [];
                    
                    // Swap batters at the end of over (if not single batter mode)
                    if (!appState.match.singleBatterMode) {
                        swapBatters();
                    }
                    
                    // Ask for next bowler
                    setTimeout(() => {
                        openBowlerSelection();
                    }, 500);
                }
            }
            
            // Add to history
            appState.cricket.actionHistory.push(action);
            
            // Update UI
            updateLiveScoringUI();
            
            // Show notification
            showNotification(`${extra} - ${runs} run${runs !== 1 ? 's' : ''}`, "info");
            
            // Check if match is complete
            checkMatchStatus();
        }
        
        // Swap batters
        function swapBatters() {
            if (appState.match.singleBatterMode) {
                showNotification('Cannot swap batters in single batter mode', "warning");
                return;
            }
            
            const temp = appState.cricket.striker;
            appState.cricket.striker = appState.cricket.nonStriker;
            appState.cricket.nonStriker = temp;
            
            updateLiveScoringUI();
            showNotification("Batters swapped", "info");
        }
        
        // Open player selection modal
        function openPlayerSelection(type) {
            const modal = document.getElementById('player-modal');
            const title = document.getElementById('player-modal-title');
            const description = document.getElementById('player-modal-description');
            const playerList = document.getElementById('player-list-modal');
            
            let players = [];
            let titleText = '';
            let descriptionText = '';
            
            switch(type) {
                case 'newBatsman':
                    titleText = 'Select New Batsman';
                    descriptionText = 'Select a batsman to replace the dismissed player:';
                    players = appState.cricket.battingTeam.players.filter(p => 
                        p.id !== appState.cricket.striker.id && 
                        p.id !== appState.cricket.nonStriker.id
                    );
                    break;
                    
                case 'striker':
                    titleText = 'Select New Striker';
                    descriptionText = 'Select a batsman to be the new striker:';
                    players = appState.cricket.battingTeam.players.filter(p => 
                        p.id !== appState.cricket.nonStriker.id
                    );
                    break;
                    
                case 'nonStriker':
                    titleText = 'Select New Non-Striker';
                    descriptionText = 'Select a batsman to be the new non-striker:';
                    players = appState.cricket.battingTeam.players.filter(p => 
                        p.id !== appState.cricket.striker.id
                    );
                    break;
            }
            
            if (players.length === 0) {
                showNotification('No available players for this position', "warning");
                return;
            }
            
            title.textContent = titleText;
            description.textContent = descriptionText;
            
            playerList.innerHTML = '';
            players.forEach(player => {
                const playerStat = appState.cricket.playerStats[player.id];
                const playerItem = document.createElement('div');
                playerItem.className = 'player-item-modal';
                playerItem.dataset.playerId = player.id;
                
                let statsText = '';
                if (playerStat) {
                    statsText = `${playerStat.runs} runs, ${playerStat.balls} balls`;
                }
                
                playerItem.innerHTML = `
                    <div class="player-info-modal">${player.name}</div>
                    <div class="player-stats-modal">${statsText}</div>
                `;
                
                playerItem.addEventListener('click', function() {
                    document.querySelectorAll('.player-item-modal').forEach(item => {
                        item.classList.remove('selected');
                    });
                    this.classList.add('selected');
                });
                
                playerList.appendChild(playerItem);
            });
            
            // Select first player by default
            if (players.length > 0) {
                const firstItem = playerList.querySelector('.player-item-modal');
                if (firstItem) {
                    firstItem.classList.add('selected');
                }
            }
            
            // Store selection type
            modal.dataset.selectionType = type;
            modal.classList.add('active');
        }
        
        // Confirm player selection
        function confirmPlayerSelection() {
            const modal = document.getElementById('player-modal');
            const selectedPlayerItem = document.querySelector('.player-item-modal.selected');
            
            if (!selectedPlayerItem) {
                showNotification('Please select a player', "warning");
                return;
            }
            
            const playerId = parseInt(selectedPlayerItem.dataset.playerId);
            const player = appState.cricket.battingTeam.players.find(p => p.id === playerId);
            const selectionType = modal.dataset.selectionType;
            
            if (!player) {
                showNotification('Player not found', "error");
                return;
            }
            
            switch(selectionType) {
                case 'newBatsman':
                    // Set as striker
                    appState.cricket.striker = {
                        ...player,
                        runs: 0,
                        balls: 0,
                        fours: 0,
                        sixes: 0,
                        isOut: false
                    };
                    break;
                    
                case 'striker':
                    appState.cricket.striker = {
                        ...appState.cricket.striker,
                        ...player
                    };
                    break;
                    
                case 'nonStriker':
                    appState.cricket.nonStriker = {
                        ...appState.cricket.nonStriker,
                        ...player
                    };
                    break;
            }
            
            modal.classList.remove('active');
            updateLiveScoringUI();
            showNotification(`Player ${player.name} selected`, "success");
        }
        
        // Open bowler selection modal
        function openBowlerSelection() {
            const modal = document.getElementById('bowler-modal');
            const bowlerList = document.getElementById('bowler-list-modal');
            
            const bowlers = appState.cricket.bowlingTeam.players.filter(p => 
                p.name !== appState.cricket.currentBowler.name
            );
            
            if (bowlers.length === 0) {
                showNotification('No other bowlers available', "warning");
                return;
            }
            
            bowlerList.innerHTML = '';
            bowlers.forEach(player => {
                const playerStat = appState.cricket.playerStats[player.id];
                const playerItem = document.createElement('div');
                playerItem.className = 'player-item-modal';
                playerItem.dataset.playerId = player.id;
                
                let statsText = '';
                if (playerStat && playerStat.ballsBowled > 0) {
                    const overs = Math.floor(playerStat.ballsBowled / 6) + (playerStat.ballsBowled % 6) / 10;
                    const economy = overs > 0 ? (playerStat.runsConceded / overs).toFixed(2) : "0.00";
                    statsText = `${overs.toFixed(1)} - ${playerStat.runsConceded} - ${playerStat.wickets} (${economy})`;
                } else {
                    statsText = 'Not bowled yet';
                }
                
                playerItem.innerHTML = `
                    <div class="player-info-modal">${player.name}</div>
                    <div class="player-stats-modal">${statsText}</div>
                `;
                
                playerItem.addEventListener('click', function() {
                    document.querySelectorAll('.player-item-modal').forEach(item => {
                        item.classList.remove('selected');
                    });
                    this.classList.add('selected');
                });
                
                bowlerList.appendChild(playerItem);
            });
            
            // Select first player by default
            if (bowlers.length > 0) {
                const firstItem = bowlerList.querySelector('.player-item-modal');
                if (firstItem) {
                    firstItem.classList.add('selected');
                }
            }
            
            modal.classList.add('active');
        }
        
        // Confirm bowler selection
        function confirmBowlerSelection() {
            const modal = document.getElementById('bowler-modal');
            const selectedPlayerItem = document.querySelector('.player-item-modal.selected');
            
            if (!selectedPlayerItem) {
                showNotification('Please select a bowler', "warning");
                return;
            }
            
            const playerId = parseInt(selectedPlayerItem.dataset.playerId);
            const player = appState.cricket.bowlingTeam.players.find(p => p.id === playerId);
            
            if (!player) {
                showNotification('Player not found', "error");
                return;
            }
            
            // Move current bowler to previous bowler
            appState.cricket.previousBowler = { ...appState.cricket.currentBowler };
            
            // Set new bowler
            const playerStat = appState.cricket.playerStats[player.id];
            appState.cricket.currentBowler = {
                name: player.name,
                overs: playerStat ? Math.floor(playerStat.ballsBowled / 6) : 0,
                runs: playerStat ? playerStat.runsConceded : 0,
                wickets: playerStat ? playerStat.wickets : 0,
                balls: playerStat ? playerStat.ballsBowled % 6 : 0,
                maidens: playerStat ? playerStat.maidens : 0
            };
            
            modal.classList.remove('active');
            updateLiveScoringUI();
            showNotification(`${player.name} is now bowling`, "success");
        }
        
        // Show scorecard
        function showScorecard() {
            const modal = document.getElementById('scorecard-modal');
            const scorecardTeams = document.getElementById('scorecard-teams');
            
            scorecardTeams.innerHTML = '';
            
            // Team 1 scorecard
            if (appState.match.team1) {
                const team1Card = document.createElement('div');
                team1Card.className = 'scorecard-team';
                
                let team1HTML = `
                    <div class="scorecard-team-name">${appState.match.team1.name}</div>
                    <div class="scorecard-section">
                        <div class="scorecard-section-title">Batting</div>
                `;
                
                // Add batting stats for team 1
                Object.values(appState.cricket.playerStats).forEach(player => {
                    if (player.teamId === appState.match.team1.id && (player.runs > 0 || player.balls > 0)) {
                        team1HTML += `
                            <div class="scorecard-player-item">
                                <div class="player-name-scorecard">${player.name}</div>
                                <div class="player-stats-scorecard">
                                    ${player.runs} (${player.balls}) ${player.fours > 0 ? `${player.fours}x4 ` : ''}${player.sixes > 0 ? `${player.sixes}x6` : ''}
                                </div>
                            </div>
                        `;
                    }
                });
                
                team1HTML += `</div><div class="scorecard-section">
                    <div class="scorecard-section-title">Bowling</div>
                `;
                
                // Add bowling stats for team 1
                Object.values(appState.cricket.playerStats).forEach(player => {
                    if (player.teamId === appState.match.team1.id && player.ballsBowled > 0) {
                        const overs = Math.floor(player.ballsBowled / 6) + (player.ballsBowled % 6) / 10;
                        team1HTML += `
                            <div class="scorecard-player-item">
                                <div class="player-name-scorecard">${player.name}</div>
                                <div class="player-stats-scorecard">
                                    ${player.wickets}/${player.runsConceded} (${overs.toFixed(1)})
                                </div>
                            </div>
                        `;
                    }
                });
                
                team1HTML += '</div>';
                team1Card.innerHTML = team1HTML;
                scorecardTeams.appendChild(team1Card);
            }
            
            // Team 2 scorecard
            if (appState.match.team2) {
                const team2Card = document.createElement('div');
                team2Card.className = 'scorecard-team';
                
                let team2HTML = `
                    <div class="scorecard-team-name">${appState.match.team2.name}</div>
                    <div class="scorecard-section">
                        <div class="scorecard-section-title">Batting</div>
                `;
                
                // Add batting stats for team 2
                Object.values(appState.cricket.playerStats).forEach(player => {
                    if (player.teamId === appState.match.team2.id && (player.runs > 0 || player.balls > 0)) {
                        team2HTML += `
                            <div class="scorecard-player-item">
                                <div class="player-name-scorecard">${player.name}</div>
                                <div class="player-stats-scorecard">
                                    ${player.runs} (${player.balls}) ${player.fours > 0 ? `${player.fours}x4 ` : ''}${player.sixes > 0 ? `${player.sixes}x6` : ''}
                                </div>
                            </div>
                        `;
                    }
                });
                
                team2HTML += `</div><div class="scorecard-section">
                    <div class="scorecard-section-title">Bowling</div>
                `;
                
                // Add bowling stats for team 2
                Object.values(appState.cricket.playerStats).forEach(player => {
                    if (player.teamId === appState.match.team2.id && player.ballsBowled > 0) {
                        const overs = Math.floor(player.ballsBowled / 6) + (player.ballsBowled % 6) / 10;
                        team2HTML += `
                            <div class="scorecard-player-item">
                                <div class="player-name-scorecard">${player.name}</div>
                                <div class="player-stats-scorecard">
                                    ${player.wickets}/${player.runsConceded} (${overs.toFixed(1)})
                                </div>
                            </div>
                        `;
                    }
                });
                
                team2HTML += '</div>';
                team2Card.innerHTML = team2HTML;
                scorecardTeams.appendChild(team2Card);
            }
            
            modal.classList.add('active');
        }
        
        // Print scorecard
        function printScorecard() {
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>Scorecard - ${appState.tournament.name}</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 20px; }
                        h1 { color: #333; margin-bottom: 20px; }
                        .scorecard { margin-bottom: 30px; }
                        .team-name { font-weight: bold; font-size: 18px; margin-bottom: 10px; border-bottom: 2px solid #333; padding-bottom: 5px; }
                        .player-row { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px solid #eee; }
                        .player-name { font-weight: bold; }
                        .section-title { font-weight: bold; margin-top: 15px; margin-bottom: 8px; color: #555; }
                    </style>
                </head>
                <body>
                    <h1>${appState.tournament.name} - Scorecard</h1>
                    <div class="scorecard">
                        ${document.getElementById('scorecard-teams').innerHTML}
                    </div>
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }
        
        // End innings
        function endInnings() {
            if (appState.match.innings === 1) {
                // Set target for second innings
                appState.cricket.target = appState.cricket.totalRuns + 1;
                appState.match.innings = 2;
                
                // Swap teams
                const temp = appState.cricket.battingTeam;
                appState.cricket.battingTeam = appState.cricket.bowlingTeam;
                appState.cricket.bowlingTeam = temp;
                
                // Reset scores for second innings
                appState.cricket.totalRuns = 0;
                appState.cricket.wickets = 0;
                appState.cricket.overs = 0;
                appState.cricket.balls = 0;
                appState.cricket.extras = 0;
                appState.cricket.currentOver = [];
                
                // Reset striker and non-striker
                if (appState.cricket.battingTeam.players.length >= 2) {
                    appState.cricket.striker = {
                        ...appState.cricket.battingTeam.players[0],
                        runs: 0,
                        balls: 0,
                        fours: 0,
                        sixes: 0,
                        isOut: false
                    };
                    
                    appState.cricket.nonStriker = {
                        ...appState.cricket.battingTeam.players[1],
                        runs: 0,
                        balls: 0,
                        fours: 0,
                        sixes: 0,
                        isOut: false
                    };
                }
                
                updateLiveScoringUI();
                showNotification("First innings complete! Second innings started.", "success");
            } else {
                // Match complete
                let winner = null;
                let result = '';
                
                if (appState.cricket.totalRuns >= appState.cricket.target) {
                    winner = appState.cricket.battingTeam;
                    const wicketsLeft = 10 - appState.cricket.wickets;
                    result = `${winner.name} won by ${wicketsLeft} wickets`;
                } else {
                    winner = appState.cricket.bowlingTeam;
                    const runsDiff = appState.cricket.target - appState.cricket.totalRuns - 1;
                    result = `${winner.name} won by ${runsDiff} runs`;
                }
                
                showNotification(`Match complete! ${result}`, "success");
                
                // Show final scorecard
                setTimeout(() => {
                    showScorecard();
                }, 1000);
            }
        }
        
        // Undo last action
        function undoLastAction() {
            if (appState.cricket.actionHistory.length === 0) {
                showNotification("No actions to undo", "warning");
                return;
            }
            
            const lastAction = appState.cricket.actionHistory.pop();
            appState.cricket = lastAction.cricketState;
            appState.match = lastAction.matchState;
            
            updateLiveScoringUI();
            showNotification("Undid last action", "info");
        }
        
        // Check match status
        function checkMatchStatus() {
            // Check if innings is complete
            if (appState.cricket.wickets >= 10 || 
                (appState.match.innings === 1 && 
                 appState.cricket.overs >= appState.tournament.oversPerInnings) ||
                (appState.match.innings === 2 && 
                 appState.cricket.totalRuns >= appState.cricket.target)) {
                
                if (appState.match.innings === 1) {
                    setTimeout(() => {
                        endInnings();
                    }, 1000);
                } else {
                    setTimeout(() => {
                        endInnings();
                    }, 1000);
                }
            }
        }
        
        // Show notification
        function showNotification(message, type = "info") {
            const notification = document.getElementById('notification');
            const content = document.getElementById('notification-content');
            
            content.textContent = message;
            
            // Set color based on type
            if (type === "success") {
                notification.style.borderColor = "var(--accent-green)";
            } else if (type === "warning") {
                notification.style.borderColor = "var(--accent-yellow)";
            } else if (type === "error") {
                notification.style.borderColor = "var(--accent-red)";
            } else {
                notification.style.borderColor = "var(--border-color)";
            }
            
            notification.classList.add('show');
            
            // Auto-hide after 3 seconds
            setTimeout(() => {
                hideNotification();
            }, 3000);
        }
        
        // Hide notification
        function hideNotification() {
            document.getElementById('notification').classList.remove('show');
        }
        
        // Initialize the app when the page loads
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
    </html>
